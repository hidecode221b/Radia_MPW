(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    205927,       3791]
NotebookOptionsPosition[    197326,       3610]
NotebookOutlinePosition[    198510,       3654]
CellTagsIndexPosition[    198467,       3651]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 " ",
 StyleBox["Example # 3 : Generic Hybrid Undulator/Wiggler (no side magnet, M \
misalignment, rtg, for)",
  FontSize->24]
}], "Title",
 Evaluatable->False,
 CellChangeTimes->{{3.8522690276706476`*^9, 3.852269055214794*^9}, {
   3.901068508732941*^9, 3.9010685179091578`*^9}, {3.901068707550649*^9, 
   3.9010687164057674`*^9}, 3.9010691793251657`*^9, {3.9015781296685805`*^9, 
   3.9015781315625725`*^9}, {3.9018531324445996`*^9, 3.9018531332592044`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"80f95f21-688f-466a-be74-1c788a5280bc"],

Cell["Version 0.7", "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.3999131561401253`*^9, 3.3999131562026253`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"2cf92360-50b0-457e-9c90-a3c2cc5e2c8a"],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"61178415-e883-4c84-ac7e-e8b13f3d9ce8"],

Cell[TextData[{
 StyleBox["This example creates and solves a simple ",
  Evaluatable->False,
  AspectRatioFixed->True],
 StyleBox["multipole wiggler",
  Evaluatable->False,
  AspectRatioFixed->True,
  FontColor->RGBColor[1, 0, 0]],
 StyleBox[" made with rectangular blocks. It is important to execute each \
section in the order of presentation. If not, errors may be reported. Any \
section can be edited and executed several times. To see the change in the \
peak field induced by the variation of the magnet size, edit the \
corresponding parameter in the section entitled \"Create the Geometry\", \
execute this section and re-execute the section \"Solve\". The section \
\"Optimizing Parameters\" provides an example of manual optimization of the \
pole dimensions.",
  Evaluatable->False,
  AspectRatioFixed->True],
 "\n",
 StyleBox["To obtain acceptable precision on the magnetic field, it is \
essential to increase the segmentation. This is done at the expense of memory \
and CPU time. The segmentation in this example has been set to",
  Evaluatable->False,
  AspectRatioFixed->True],
 " np={2,2,5} for the pole and nm={1,3,1} for the magnet. ",
 StyleBox["This corresponds to an absolute error in the peak field of the \
undulator/wiggler of the order of 1%. The user himself should experience \
consequences of   increasing np and nm and see how CPU time and memory \
increase, and how the value of the peak field approaches a limit which is the \
value looked for. To do so, edit the nm or np values in the \"Create the \
Geometry\" section, and re-execute both the \"Create the Geometry\" and \
\"Solve\" sections. Using segmentation which is too large segmentation may \
result in a memory allocation failure. To recover from such situation, the \
section \"Load and Initialize Radia\" should be re-executed. Memory \
allocation failure can be avoided (to some extent) by giving more memory to \
the Radia.exe process (Macintosh). \nIt is a fact that iron pieces need much \
more segmentation than the magnets since the magnetization there is very \
sensitive to the external field.",
  Evaluatable->False,
  AspectRatioFixed->True],
 "\n",
 StyleBox["One can also compute the Field Integral produced by such an \
undulator/wiggler, forces on the magnets and poles, etc. One can build a \
wedge pole undulator by using polyhedrons or extruded polygons instead of \
rectangular blocks... To learn more, read the Radia documentation, make tests \
and develop experience.",
  Evaluatable->False,
  AspectRatioFixed->True]
}], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8513921441309104`*^9, 3.8513922102984095`*^9}, {
  3.8513935551117973`*^9, 3.851393555580782*^9}, {3.8520021545058613`*^9, 
  3.8520022204435062`*^9}, {3.8520023807343063`*^9, 3.8520023832834373`*^9}, {
  3.8520024660891976`*^9, 3.8520024674644113`*^9}, {3.933108080083481*^9, 
  3.933108085840271*^9}, {3.9331081323412*^9, 3.933108135017185*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"717b5375-299b-4a73-b1c4-5b4c657d9166"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load and Initialize Radia", "Section",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"dcd0e42c-1b7c-44b2-ace2-3d9a57a69efb"],

Cell["\<\
The following instruction loads the Radia package and returns the Radia \
version number. This notebook requires the Radia version 4.097 or later. \
\>", "Text",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"55364a9b-41af-4208-be09-cf8c70609193"],

Cell[TextData[{
 "<<",
 StyleBox["Radia",
  FontColor->RGBColor[1, 0, 0]],
 "`;\n(* if Vector field plot is required *)\n<<",
 StyleBox["VectorFieldPlots",
  FontColor->RGBColor[1, 0, 0]],
 "`;"
}], "Input",
 CellChangeTimes->{{3.849758400450985*^9, 3.8497584006409974`*^9}, {
  3.852002529443336*^9, 3.8520025846595936`*^9}, {3.9285375062000628`*^9, 
  3.928537507836915*^9}},
 AspectRatioFixed->True,
 CellLabel->"In[1]:=",ExpressionUUID->"0a81d872-9815-47a6-a8ca-b399b670058c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define Magnetic Material ", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.3999127515151253`*^9, 3.3999127519057503`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"252e519d-81eb-497c-88b0-81b5bad93f75"],

Cell[TextData[{
 StyleBox["The following instructions define a material by means of the \
Magnetization M (in Tesla) vs H (in Amp/m) dependence entered point by point. \
The resulting M(H) curve is plotted for verification. Note that the material \
is defined by calling the function \"",
  Evaluatable->False,
  AspectRatioFixed->True],
 "radMatSatIso",
 StyleBox["\" with the input parameter \"ma\" which contains the values of H \
and M both expressed in Tesla. The conversion between Amp/m and Tesla is done \
by multiplying H by \"",
  Evaluatable->False,
  AspectRatioFixed->True],
 "4*Pi*10^(-7)",
 StyleBox["\" when creating \"ma\". ",
  Evaluatable->False,
  AspectRatioFixed->True]
}], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.851393613332869*^9, 
  3.8513936281796865`*^9}},ExpressionUUID->"e6a5c227-0ba1-40b6-9f43-\
47dbab68bcd6"],

Cell[TextData[{
 "H = {0.8, 1.5, 2.2, 3.6, 5, 6.8, 9.8, 18, 28, 37.5, 42, 55, 71.5, 80, 85, \
88, 92, 100, 120, 150, 200, 300, 400, 600, 800, 1000, 2000, 4000, 6000, \
10000, 25000, 40000};\n\nM = {0.000998995, 0.00199812, 0.00299724, \
0.00499548,0.00699372, 0.00999145, 0.0149877, 0.0299774, 0.0499648, \
0.0799529, 0.0999472, 0.199931, 0.49991, 0.799899, 0.999893, 1.09989, \
1.19988, 1.29987, 1.41985, 1.49981, 1.59975, 1.72962, 1.7995, 1.89925, \
1.96899, 1.99874,  2.09749, 2.19497, 2.24246, 2.27743, 2.28958, 2.28973};\n\n\
ma =  N[Table[{H[[i]]*4*Pi*10^(-7), M[[i]]}, {i, 1, Length[H]}]];\n\n",
 StyleBox["RadPlotOptions",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nListPlot[ma,\nJoined->True,\nAxesLabel->{\"H [Tesla]\",\"Mag \
[Tesla]\"}]\n\nListPlot[ma,\nJoined->True,\nPlotRange->{{0,0.001},{0,2.2}},\n\
AxesLabel->{\"H [Tesla]\",\"Mag [Tesla]\"}]\n\nmp=",
 StyleBox["radMatSatIso",
  FontColor->RGBColor[1, 0, 0]],
 "[ma];"
}], "Input",
 CellChangeTimes->{{3.6700863622205486`*^9, 3.6700863679301586`*^9}, {
   3.6700864088334303`*^9, 3.670086412078236*^9}, {3.8495772906656523`*^9, 
   3.8495773035543327`*^9}, 3.849577391661707*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"dc1242ef-4d98-4bd0-ab04-28bea0ccd1bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Functions for ",
 StyleBox["odd",
  FontColor->RGBColor[0, 0, 1]],
 " numbers of pole ",
 StyleBox["(you can choose either ",
  FontColor->RGBColor[1, 0.5, 0.5]],
 StyleBox["odd",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" or ",
  FontColor->RGBColor[1, 0.5, 0.5]],
 StyleBox["even",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox[" poles)",
  FontColor->RGBColor[1, 0.5, 0.5]]
}], "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.8517441074228277`*^9, 3.85174414307524*^9}, {
   3.852269488190855*^9, 3.8522694891287975`*^9}, {3.853540441097062*^9, 
   3.8535404602810397`*^9}, 3.853541270546728*^9, {3.8535432063182297`*^9, 
   3.853543224154854*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"6448deeb-d2ba-43c7-8b1b-7a7791494f61"],

Cell[TextData[StyleBox["The following function builds an array of rectangular \
permanent magnets with their mirror symmetric counterparts, distributes the \
colors, magnetic materials and sets the segmentation. The function is very \
generic and can be used to build almost any hybrid wiggler (without \
optimizing the design of terminations).",
 Evaluatable->False,
 AspectRatioFixed->True]], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8520029100751266`*^9, 3.852002911070096*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"e745422a-8ea8-4e90-9e99-c52555fec598"],

Cell[TextData[{
 "wig[]:=Module[{},\n\n(* A model for odd numbers in main poles *)\n(* array \
for up and down in z *)\nFor[array=1,array>=-1,array-=2,(\n\n",
 StyleBox["(* First Principal Pole p *)\n",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["If[sd==0,sx=0, sx=RandomVariate[NormalDistribution[0,sdsx]]];\n\
If[sd==0,sz=1, sz=RandomVariate[NormalDistribution[1,sdsz]]];",
  FontColor->GrayLevel[0]],
 "\np1={{sx+sp[[1]],0,array*(sz*sp[[3]]+gapoffset)},{lp[[1]]-2*chp[[1]],lp[[2]\
]-2*chp[[2]]}};\n\
p2={{sx+sp[[1]],0,array*(chp[[3]]+sz*sp[[3]]+gapoffset)},{lp[[1]],lp[[2]]}};\n\
p3={{sx+sp[[1]],0,array*(lp[[3]]+sz*sp[[3]]+gapoffset)},{lp[[1]],lp[[2]]}};\n\
pole0=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{p1,p2,p3},zer];\nnpd={np[[2]],np[[2]],np[[1]]};\n\
fullMag[pole0,npd,cp,mp];\n\n(* side for positive and negative in y *)\n\
For[side=1,side>=-1,side-=2,(\ny=lp[[2]]/2;\n\nFor[i=1,i<=NumPer,i++,(\n",
 StyleBox["(* Random generator 1p *)",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["\nr=RandomVariate[NormalDistribution[1,sdr]];\n\
theta=RandomVariate[NormalDistribution[0,sdt]]*Pi/180;\n\
phi=RandomReal[]*2*Pi;\nIf[sd==0,ms={0,1,0},ms={Sin[theta]*Cos[phi], \
Cos[theta], Sin[theta]*Sin[phi]}];\nIf[sd==0,mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt], mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt*r]];\nIf[sd==0,sx=0, \
sx=RandomVariate[NormalDistribution[0,sdsx]]];\nIf[sd==0,sy=1, \
sy=RandomVariate[NormalDistribution[1,sdsy]]];\nIf[sd==0,sz=1, \
sz=RandomVariate[NormalDistribution[1,sdsz]]];\n(*Print[\"Random radians \
a\",i,\" (\",r,\", \",theta,\", \",phi,\"), cartesian (\",ms[[1]],\", \
\",ms[[2]],\", \",ms[[3]],\"), norm (\",Sqrt[ms[[1]]^2+ms[[2]]^2+ms[[3]]],\")\
\"];*)\n",
  FontColor->GrayLevel[0]],
 StyleBox["(* Periodic Magnet 1p *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ninitm={ms[[1]],side*array*ms[[2]]*(Mod[i,2]-Mod[i+1,2]),ms[[3]]};\n\
y+=sy*sp[[2]];\n\
z1={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(sz*sp[[3]])},{lm[[1]]-2*chmk,lm[[2]]\
/2}};\nz2={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(chmk+sz*sp[[3]])},{lm[[1]],\
lm[[2]]/2}};\n\
z3={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(lm[[3]]+sz*sp[[3]])},{lm[[1]],lm[[2]\
]/2}};\nmagnetP1=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{z1,z2,z3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magnetP1,nmd,cm,mm];\ny+=lm[[2]]/4;\n\n",
 StyleBox["(* Random generator 2p *)",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["\nr=RandomVariate[NormalDistribution[1,sdr]];\n\
theta=RandomVariate[NormalDistribution[0,sdt]]*Pi/180;\n\
phi=RandomReal[]*2*Pi;\nIf[sd==0,ms={0,1,0},ms={Sin[theta]*Cos[phi], \
Cos[theta], Sin[theta]*Sin[phi]}];\nIf[sd==0,mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt], mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt*r]];\nIf[sd==0,sx=0, \
sx=RandomVariate[NormalDistribution[0,sdsx]]];\nIf[sd==0,sy=1, \
sy=RandomVariate[NormalDistribution[1,sdsy]]];\nIf[sd==0,sz=1, \
sz=RandomVariate[NormalDistribution[1,sdsz]]];\n(*Print[\"Random radians \
b\",i,\" (\",r,\", \",theta,\", \",phi,\"), cartesian (\",ms[[1]],\", \
\",ms[[2]],\", \",ms[[3]],\"), norm (\",Sqrt[ms[[1]]^2+ms[[2]]^2+ms[[3]]],\")\
\"];*)",
  FontColor->GrayLevel[0]],
 "\n",
 StyleBox["(* Periodic Magnet 2p *)\n",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["initm={ms[[1]],side*array*ms[[2]]*(Mod[i,2]-Mod[i+1,2]),ms[[3]]};",
  FontColor->GrayLevel[0]],
 "\ny+=lm[[2]]/4+sy*sp[[2]];\n\
z1={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(sz*sp[[3]])},{lm[[1]]-2*chmk,lm[[2]]\
/2}};\nz2={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(chmk+sz*sp[[3]])},{lm[[1]],\
lm[[2]]/2}};\n\
z3={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(lm[[3]]+sz*sp[[3]])},{lm[[1]],lm[[2]\
]/2}};\nmagnetP2=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{z1,z2,z3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magnetP2,nmd,cm,mm];\ny+=lm[[2]]/4;\n\n",
 StyleBox["(* Periodic Pole p *)\n",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["If[sd==0,sx=0, sx=RandomVariate[NormalDistribution[0,sdsx]]];\n\
If[sd==0,sy=1, sy=RandomVariate[NormalDistribution[1,sdsy]]];\nIf[sd==0,sz=1, \
sz=RandomVariate[NormalDistribution[1,sdsz]]];",
  FontColor->GrayLevel[0]],
 "\ny+=(lm[[2]]/2+lp[[2]])/2+sy*sp[[2]];\n\
p1={{sx+sp[[1]],side*(y),array*(sz*sp[[3]]+gapoffset)},{lp[[1]]-2*chp[[1]],lp[\
[2]]-2*chp[[2]]}};\n\
p2={{sx+sp[[1]],side*(y),array*(chp[[3]]+sz*sp[[3]]+gapoffset)},{lp[[1]],lp[[\
2]]}};\np3={{sx+sp[[1]],side*(y),array*(lp[[3]]+sz*sp[[3]]+gapoffset)},{lp[[1]\
],lp[[2]]}};\npoleP=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{p1,p2,p3},zer];\nnpd={np[[2]],np[[2]],np[[1]]};\n\
fullMag[poleP,npd,cp,mp];\ny+=lp[[2]]/2;\n\nIf[i==1,magnet1=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{magnetP1,magnetP2}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet1,{magnetP1,magnetP2}]];\nIf[i==1,pole1=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{poleP}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[pole1,{poleP}]];\n(*",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{poleP,mangetP1,magnetP2}];*)\n)];\n\n",
 StyleBox["(* Random generator 3p *)",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["\nr=RandomVariate[NormalDistribution[1,sdr]];\n\
theta=RandomVariate[NormalDistribution[0,sdt]]*Pi/180;\n\
phi=RandomReal[]*2*Pi;\nIf[sd==0,ms={0,1,0},ms={Sin[theta]*Cos[phi], \
Cos[theta], Sin[theta]*Sin[phi]}];\nIf[sd==0,mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt], mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt*r]];\n",
  FontColor->GrayLevel[0]],
 StyleBox["If[sd==0,sx=0, sx=RandomVariate[NormalDistribution[0,sdsx]]];\n\
If[sd==0,sy=1, sy=RandomVariate[NormalDistribution[1,sdsy]]];\nIf[sd==0,sz=1, \
sz=RandomVariate[NormalDistribution[1,sdsz]]];",
  FontColor->GrayLevel[0]],
 StyleBox["\n(*Print[\"Random radians before end1 (\",r,\", \",theta,\", \
\",phi,\"), cartesian (\",ms[[1]],\", \",ms[[2]],\", \",ms[[3]],\"), norm \
(\",Sqrt[ms[[1]]^2+ms[[2]]^2+ms[[3]]],\")\"];*)",
  FontColor->GrayLevel[0]],
 "\n",
 StyleBox["(* Magnet before End pole p *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ninitm={ms[[1]],",
 StyleBox["side*array*",
  FontColor->GrayLevel[0]],
 "ms[[2]]*(Mod[NumPer+1,2]-Mod[NumPer,2]),ms[[3]]};\ny+=sy*sp[[2]];\n\
z1={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(sz*sp[[3]])},{lm[[1]]-2*chmk,lm[[2]]\
/2}};\nz2={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(chmk+sz*sp[[3]])},{lm[[1]],\
lm[[2]]/2}};\n\
z3={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(lm[[3]]+sz*sp[[3]])},{lm[[1]],lm[[2]\
]/2}};\nmagnet2a=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{z1,z2,z3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magnet2a,nmd,cm,mm];\n\n",
 StyleBox["(* Random generator 4p *)",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["\nr=RandomVariate[NormalDistribution[1,sdr]];\n\
theta=RandomVariate[NormalDistribution[0,sdt]]*Pi/180;\n\
phi=RandomReal[]*2*Pi;\nIf[sd==0,ms={0,1,0},ms={Sin[theta]*Cos[phi], \
Cos[theta], Sin[theta]*Sin[phi]}];\nIf[sd==0,mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt], mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt*r]];\n",
  FontColor->GrayLevel[0]],
 StyleBox["If[sd==0,sx=0, sx=RandomVariate[NormalDistribution[0,sdsx]]];\n\
If[sd==0,sy=1, sy=RandomVariate[NormalDistribution[1,sdsy]]];\nIf[sd==0,sz=1, \
sz=RandomVariate[NormalDistribution[1,sdsz]]];",
  FontColor->GrayLevel[0]],
 StyleBox["\n(*Print[\"Random radians before end2 (\",r,\", \",theta,\", \
\",phi,\"), cartesian (\",ms[[1]],\", \",ms[[2]],\", \",ms[[3]],\"), norm \
(\",Sqrt[ms[[1]]^2+ms[[2]]^2+ms[[3]]],\")\"];*)",
  FontColor->GrayLevel[0]],
 "\n",
 StyleBox["(* Magnet before End pole p *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ninitm={ms[[1]],",
 StyleBox["side*array*",
  FontColor->GrayLevel[0]],
 "ms[[2]]*(Mod[NumPer+1,2]-Mod[NumPer,2]),ms[[3]]};\ny+=lm[[2]]/2+sy*sp[[2]];\
\nz1={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(sz*sp[[3]])},{lm[[1]]-2*chmk,lm[[\
2]]/2}};\n\
z2={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(chmk+sz*sp[[3]])},{lm[[1]],lm[[2]]/\
2}};\nz3={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(lm[[3]]+sz*sp[[3]])},{lm[[1]],\
lm[[2]]/2}};\nmagnet2b=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{z1,z2,z3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magnet2b,nmd,cm,mm];\nmagnet2=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{magnet2a,magnet2b}];\n\n",
 StyleBox["(* End pole p *)\n",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["If[sd==0,sx=0, sx=RandomVariate[NormalDistribution[0,sdsx]]];\n\
If[sd==0,sy=1, sy=RandomVariate[NormalDistribution[1,sdsy]]];\nIf[sd==0,sz=1, \
sz=RandomVariate[NormalDistribution[1,sdsz]]];",
  FontColor->GrayLevel[0]],
 "\ny+=(lm[[2]]+lep[[2]])/2+sy*sp[[2]]+dpm[[1]];\n\
p1={{sx+sp[[1]],side*(y),array*(sz*sp[[3]]+gapoffset)},{lep[[1]]-2*chp[[1]],\
lep[[2]]-2*chp[[2]]}};\n\
p2={{sx+sp[[1]],side*(y),array*(chp[[3]]+sz*sp[[3]]+gapoffset)},{lep[[1]],lep[\
[2]]}};\np3={{sx+sp[[1]],side*(y),array*(lep[[3]]+sz*sp[[3]]+gapoffset)},{lep[\
[1]],lep[[2]]}};\npole2=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{p1,p2,p3},zer];\nnpd={np[[2]],np[[2]],np[[1]]};\n\
fullMag[pole2,npd,cp,mp];\n\n",
 StyleBox["(* Random generator 5p *)",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["\nr=RandomVariate[NormalDistribution[1,sdr]];\n\
theta=RandomVariate[NormalDistribution[0,sdt]]*Pi/180;\n\
phi=RandomReal[]*2*Pi;\nIf[sd==0,ms={0,1,0},ms={Sin[theta]*Cos[phi], \
Cos[theta], Sin[theta]*Sin[phi]}];\nIf[sd==0,mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt], mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt*r]];\n",
  FontColor->GrayLevel[0]],
 StyleBox["If[sd==0,sx=0, sx=RandomVariate[NormalDistribution[0,sdsx]]];\n\
If[sd==0,sy=1, sy=RandomVariate[NormalDistribution[1,sdsy]]];\nIf[sd==0,sz=1, \
sz=RandomVariate[NormalDistribution[1,sdsz]]];",
  FontColor->GrayLevel[0]],
 StyleBox["\n(*Print[\"Random radians end (\",r,\", \",theta,\", \",phi,\"), \
cartesian (\",ms[[1]],\", \",ms[[2]],\", \",ms[[3]],\"), norm \
(\",Sqrt[ms[[1]]^2+ms[[2]]^2+ms[[3]]],\")\"];*)",
  FontColor->GrayLevel[0]],
 "\n",
 StyleBox["(* End magnet for half size and unit model p *)",
  FontColor->RGBColor[0, 0, 1]],
 "\nIf[(NumPer!=0)&&(ending==0),initm={ms[[1]],",
 StyleBox["side*array*",
  FontColor->GrayLevel[0]],
 "ms[[2]]*(-Mod[NumPer,2]+Mod[NumPer+1,2]),ms[[3]]},initm={ms[[1]],",
 StyleBox["side*array*",
  FontColor->GrayLevel[0]],
 "ms[[2]]*(Mod[NumPer,2]-Mod[NumPer+1,2]),ms[[3]]}];\n\
If[(NumPer==0)||(ending==0),y+=lep[[2]]/2-lm[[2]]-lep[[2]]-sy*sp[[2]]-dpm[[1]]\
,y+=lep[[2]]/2+sy*sp[[2]]+dpm[[2]]];\nIf[(NumPer==0),y-=sy*sp[[2]],y];\n\
z1={{sx*sp[[1]],side*(y+lm[[2]]/4),array*(sz*sp[[3]])},{lm[[1]]-2*chmk,lm[[2]]\
/2}};\nz2={{sx*sp[[1]],side*(y+lm[[2]]/4),array*(chmk+sz*sp[[3]])},{lm[[1]],\
lm[[2]]/2}};\n\
z3={{sx*sp[[1]],side*(y+lm[[2]]/4),array*(lm[[3]]+sz*sp[[3]])},{lm[[1]],lm[[2]\
]/2}};\nmagEnd=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{z1,z2,z3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magEnd,nmd,cm,mm];\n\nIf[(NumPer==0),If[(side==1 && array==1),magnet=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{magEnd}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet,{magEnd}]],If[(side==1 && array==1),magnet=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{magnet1,magnet2,magEnd}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet,{magnet1,magnet2,magEnd}]]];\nIf[(NumPer==0),If[(side==1 && \
array==1),pole=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole0}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[pole,{pole0}]],If[(array==1),If[side==1,pole=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole0,pole1,pole2}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[pole,{pole1,pole2}]],If[side==1,",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[pole,{pole0,pole1,pole2}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[pole,{pole1,pole2}]]]];\nIf[(NumPer==0),poleF=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole0}],If[(array==1),If[side==1,poleF=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole0,pole1,pole2}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[poleF,{pole1,pole2}]]]];\nIf[(NumPer==0),If[(side==1 && array==1),und=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole0}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{pole0}]],If[(array==1),If[side==1,und=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole0,pole1,magnet1}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{pole1,magnet1}]],If[side==1,",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{pole0,pole1,magnet1}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{pole1,magnet1}]]]];\nIf[(NumPer==0)||(ending==0),",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{magEnd}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{magnet2,pole2,magEnd}]];\n\n)];\n)];\n\ny=Abs[y];\n\n\
If[(NumPer==0)||(ending==0),y+=lm[[2]]/4,y+=lm[[2]]/4];\n\
If[(NumPer==0),y+=sp[[2]],y];\n\nundfrc=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole,magnet}];\n\n(*undc=",
 StyleBox["radObjCutMag",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{0,0,40},{0,0,1},Frame->Lab][[1]];*)\n(*Print[\"Total length \
(\",NumPer*2+1,\" poles):    \",N[(y+lm[[2]]/4)*2,5],\"  mm\"];*)\n\
totallength=N[(y+lm[[2]]/4)*2,5];\nnumPoles=NumPer*2+1;\nund\n]"
}], "Input",
 CellChangeTimes->{{3.849572053474595*^9, 3.849572128248249*^9}, {
   3.8495721848720493`*^9, 3.8495722281664696`*^9}, 3.849572285281133*^9, {
   3.8495723201835403`*^9, 3.849572382495947*^9}, {3.8495724984617414`*^9, 
   3.8495726459489584`*^9}, {3.8495726931130342`*^9, 
   3.8495728356567016`*^9}, {3.8495729143377485`*^9, 3.849572947541973*^9}, {
   3.849574520430972*^9, 3.849574617407159*^9}, 3.8495749949739966`*^9, 
   3.849575198792453*^9, {3.849575253961528*^9, 3.849575257845567*^9}, {
   3.849575356144841*^9, 3.8495754028819685`*^9}, {3.849575440866559*^9, 
   3.849575441738719*^9}, {3.849575687866083*^9, 3.8495757106214275`*^9}, 
   3.8495765066683154`*^9, 3.8495765549937887`*^9, {3.8495769759598475`*^9, 
   3.8495769966405296`*^9}, {3.8495774603427267`*^9, 3.8495774809366355`*^9}, 
   3.8496496480230937`*^9, {3.8496497572610207`*^9, 3.8496497711510096`*^9}, {
   3.8496498796180425`*^9, 3.8496500161786733`*^9}, {3.8496501412783337`*^9, 
   3.8496501515083246`*^9}, {3.8496502064119053`*^9, 
   3.8496502315046177`*^9}, {3.849650272002843*^9, 3.849650273132842*^9}, 
   3.849650613668476*^9, {3.8496507238757906`*^9, 3.84965074316577*^9}, {
   3.8496507915721097`*^9, 3.8496509208188615`*^9}, 3.8496510498600764`*^9, {
   3.849651279488081*^9, 3.849651487604303*^9}, {3.8496518738166*^9, 
   3.8496520911898065`*^9}, 3.8496521218997993`*^9, {3.8496522562979717`*^9, 
   3.849652278647721*^9}, {3.8496523885892143`*^9, 3.849652510885844*^9}, {
   3.849652543115576*^9, 3.8496525730553303`*^9}, {3.8496526206749496`*^9, 
   3.8496526593390446`*^9}, {3.8496526938089123`*^9, 
   3.8496527410649824`*^9}, {3.849652845797761*^9, 3.8496528562377*^9}, {
   3.849652923538856*^9, 3.849652980596321*^9}, {3.849653012957328*^9, 
   3.849653056181904*^9}, {3.849653751943803*^9, 3.8496539085934997`*^9}, {
   3.849654194491127*^9, 3.849654231579466*^9}, {3.8496543520936613`*^9, 
   3.8496543620036488`*^9}, {3.849654481148229*^9, 3.849654523407072*^9}, {
   3.8496545666467896`*^9, 3.8496548105918903`*^9}, {3.84965499145909*^9, 
   3.84965499145909*^9}, {3.8496550411998053`*^9, 3.8496550547927537`*^9}, {
   3.849655089330888*^9, 3.8496551981755767`*^9}, {3.849655234461477*^9, 
   3.849655244041669*^9}, {3.849655404522587*^9, 3.849655425193003*^9}, {
   3.849655482852952*^9, 3.849655487742996*^9}, {3.8496555832061357`*^9, 
   3.8496555845161467`*^9}, {3.8496556220471354`*^9, 3.849655622617135*^9}, 
   3.84965591666016*^9, {3.8496559530157943`*^9, 3.8496559544757924`*^9}, {
   3.8496560225457516`*^9, 3.8496560416357403`*^9}, {3.8496561806245184`*^9, 
   3.8496563091946115`*^9}, {3.849656452326645*^9, 3.8496565181925516`*^9}, {
   3.8496565756179776`*^9, 3.8496566751473513`*^9}, {3.8496572097148733`*^9, 
   3.849657217110723*^9}, {3.8496572487805567`*^9, 3.8496572505705533`*^9}, {
   3.849658997552963*^9, 3.8496590409819226`*^9}, {3.8496591403549976`*^9, 
   3.849659143774991*^9}, {3.84965922107034*^9, 3.849659420929379*^9}, {
   3.8496594515093565`*^9, 3.8496595912458344`*^9}, {3.8496596525087585`*^9, 
   3.849659671818761*^9}, 3.8496597365267897`*^9, {3.849659774587121*^9, 
   3.8496598094075537`*^9}, {3.849659863057528*^9, 3.8496598670856447`*^9}, {
   3.849660321649008*^9, 3.849660328899002*^9}, {3.8496603958666625`*^9, 
   3.8496603987166376`*^9}, 3.8496606566854277`*^9, {3.849660913895274*^9, 
   3.84966095817277*^9}, {3.8496624456754284`*^9, 3.84966272601681*^9}, 
   3.8496630302098284`*^9, {3.8497499375330257`*^9, 3.849749965094982*^9}, {
   3.849750008097274*^9, 3.849750130160448*^9}, {3.849750162936884*^9, 
   3.8497502444175253`*^9}, {3.8497502763831453`*^9, 3.849750286448638*^9}, {
   3.8497504344525104`*^9, 3.849750440524328*^9}, {3.849750588148366*^9, 
   3.8497506058483562`*^9}, {3.8497506864222775`*^9, 3.849750686608833*^9}, {
   3.8497507634305534`*^9, 3.849750870078232*^9}, {3.8497509215909166`*^9, 
   3.849750961882139*^9}, 3.8497510480660105`*^9, {3.8497510953613367`*^9, 
   3.8497512108838816`*^9}, {3.8497513782035255`*^9, 
   3.8497514182469444`*^9}, {3.8497517570223703`*^9, 
   3.8497517610943174`*^9}, {3.8497522167422757`*^9, 3.849752222752227*^9}, {
   3.8497522535819855`*^9, 3.8497522715158925`*^9}, {3.8497523163636446`*^9, 
   3.849752365257762*^9}, {3.8497524394469676`*^9, 3.8497525467267733`*^9}, {
   3.8497526162460794`*^9, 3.849752730508974*^9}, {3.849752770647138*^9, 
   3.8497528754950533`*^9}, {3.8497529302808847`*^9, 
   3.8497529310368824`*^9}, {3.849752966170538*^9, 3.849752995560673*^9}, 
   3.849753094146408*^9, {3.8497531278702908`*^9, 3.849753173006328*^9}, {
   3.8497532221720777`*^9, 3.84975323998105*^9}, {3.8497532722379503`*^9, 
   3.849753308469886*^9}, {3.8497533675497417`*^9, 3.849753426157132*^9}, {
   3.849753465477519*^9, 3.849753486393488*^9}, {3.849753520149412*^9, 
   3.8497536034092927`*^9}, {3.8497536554952073`*^9, 
   3.8497536990731473`*^9}, {3.8497537605590134`*^9, 
   3.8497539324379373`*^9}, {3.849754188272478*^9, 3.8497542085632753`*^9}, {
   3.849754240222534*^9, 3.849754275428356*^9}, {3.849754319480324*^9, 
   3.849754449686803*^9}, {3.849754484139702*^9, 3.849754528988512*^9}, {
   3.8497546041260996`*^9, 3.849754604879239*^9}, {3.8497547100241218`*^9, 
   3.8497547173961897`*^9}, {3.849754754877966*^9, 3.8497547890419793`*^9}, {
   3.8497550016658645`*^9, 3.849755105812526*^9}, {3.8497551377809114`*^9, 
   3.8497551480577655`*^9}, {3.8497551800267334`*^9, 3.849755325571764*^9}, {
   3.8497553644264603`*^9, 3.8497555219991117`*^9}, {3.8497556159345703`*^9, 
   3.8497556439642153`*^9}, 3.8497556823861065`*^9, {3.8497557283136735`*^9, 
   3.849755732065662*^9}, {3.8497557959392433`*^9, 3.8497557994933662`*^9}, {
   3.8497558325750475`*^9, 3.8497558344500303`*^9}, {3.849755919684507*^9, 
   3.849755920058524*^9}, 3.8497560960695295`*^9, {3.849756178885105*^9, 
   3.8497562391128025`*^9}, {3.8497562954698844`*^9, 
   3.8497564127158794`*^9}, {3.849756443796565*^9, 3.849756462014041*^9}, {
   3.8497565288214016`*^9, 3.849756550793353*^9}, {3.849756587071148*^9, 
   3.8497566234090247`*^9}, {3.8497566535536113`*^9, 3.849756772946063*^9}, {
   3.8497568519001207`*^9, 3.8497568528021135`*^9}, {3.8497569026428585`*^9, 
   3.8497570817031617`*^9}, {3.8497571186533933`*^9, 3.84975721537283*^9}, {
   3.849757372992374*^9, 3.8497574193723087`*^9}, {3.849761942138438*^9, 
   3.8497619599451885`*^9}, {3.8497621620103097`*^9, 3.849762171790825*^9}, {
   3.8497622211559525`*^9, 3.8497622870381527`*^9}, {3.8497624530195274`*^9, 
   3.84976252969528*^9}, {3.849762567982712*^9, 3.8497625684083047`*^9}, {
   3.8497626406974173`*^9, 3.8497626406974173`*^9}, {3.8497626839848347`*^9, 
   3.8497626932761354`*^9}, {3.8497628453613615`*^9, 3.849763020820834*^9}, {
   3.849763051917959*^9, 3.849763056917778*^9}, {3.8497631446337004`*^9, 
   3.8497631743139377`*^9}, {3.849763271597988*^9, 3.8497632770438967`*^9}, {
   3.8503630079120965`*^9, 3.850363017306899*^9}, {3.8503630503472223`*^9, 
   3.850363121442315*^9}, {3.850363564765591*^9, 3.8503636606558075`*^9}, {
   3.8503637130732384`*^9, 3.85036392836654*^9}, {3.8503639641016207`*^9, 
   3.85036416309011*^9}, {3.850364201014919*^9, 3.850364202982326*^9}, {
   3.8503642614712973`*^9, 3.8503643232658005`*^9}, {3.850364427254345*^9, 
   3.8503644619422393`*^9}, {3.8503646484184103`*^9, 3.850364658187863*^9}, {
   3.850364709477672*^9, 3.850364827016487*^9}, {3.850364937036547*^9, 
   3.8503649374111104`*^9}, {3.8504258870470533`*^9, 
   3.8504258896407185`*^9}, {3.8504259684557886`*^9, 3.850426002247655*^9}, {
   3.8504260750277514`*^9, 3.8504263755725374`*^9}, {3.850426528034941*^9, 
   3.850426528038929*^9}, {3.850426950151224*^9, 3.850426950431485*^9}, {
   3.85042702073777*^9, 3.850427052511649*^9}, {3.850427114189725*^9, 
   3.850427120263237*^9}, {3.8504273595421786`*^9, 3.850427526684953*^9}, {
   3.850427560825823*^9, 3.850427588309058*^9}, {3.8504537782380285`*^9, 
   3.8504538010338*^9}, {3.850453839474612*^9, 3.8504538734518423`*^9}, {
   3.8510483894414067`*^9, 3.8510483953752337`*^9}, 3.851048427419779*^9, {
   3.851049164184822*^9, 3.851049166835044*^9}, 3.851049240080081*^9, {
   3.851049276809397*^9, 3.851049279178295*^9}, {3.851049394473662*^9, 
   3.851049424255614*^9}, {3.851049601307565*^9, 3.851049720920559*^9}, {
   3.851049761926608*^9, 3.8510497815549765`*^9}, {3.851049840294496*^9, 
   3.8510498562122307`*^9}, {3.851049897970579*^9, 3.8510499007534127`*^9}, {
   3.851049941107956*^9, 3.8510499811154613`*^9}, {3.851050033425353*^9, 
   3.851050093988776*^9}, {3.8510502137396507`*^9, 3.851050238229588*^9}, {
   3.851050272877201*^9, 3.8510503673418827`*^9}, {3.8510504088300114`*^9, 
   3.8510504565154295`*^9}, {3.851050552487337*^9, 3.851050576693821*^9}, {
   3.8510506411561995`*^9, 3.851050692153689*^9}, {3.85105072979303*^9, 
   3.851050733577072*^9}, {3.8510507665050187`*^9, 3.8510508068693447`*^9}, {
   3.851050854739363*^9, 3.851050906243621*^9}, {3.8510510286303587`*^9, 
   3.8510510800100465`*^9}, {3.851051140169341*^9, 3.851051165968132*^9}, {
   3.8510512413938026`*^9, 3.851051282147688*^9}, {3.8510513772973666`*^9, 
   3.8510514313325386`*^9}, {3.8510514687295017`*^9, 
   3.8510514847506547`*^9}, {3.8510515408764133`*^9, 3.851051564999012*^9}, {
   3.85105159932598*^9, 3.8510517112101*^9}, {3.8510517594729357`*^9, 
   3.8510519107731714`*^9}, {3.8510519567549124`*^9, 3.851051980136232*^9}, {
   3.8510520418612704`*^9, 3.8510520963086176`*^9}, {3.8510521300788937`*^9, 
   3.851052137272685*^9}, {3.8510521747102537`*^9, 3.851052235493968*^9}, {
   3.8510523920230465`*^9, 3.851052503731397*^9}, {3.8510525695586557`*^9, 
   3.8510525844124117`*^9}, {3.851052617540492*^9, 3.8510527667906313`*^9}, {
   3.851052805181423*^9, 3.8510528056613607`*^9}, {3.851052867728486*^9, 
   3.851052907964464*^9}, {3.8510530014228463`*^9, 3.8510530047340755`*^9}, {
   3.8510530665564585`*^9, 3.851053165251396*^9}, {3.8510531990998535`*^9, 
   3.851053208483695*^9}, {3.8510532452758484`*^9, 3.8510532479970207`*^9}, {
   3.851053296807282*^9, 3.8510533405797424`*^9}, {3.851054457497221*^9, 
   3.851054765871666*^9}, {3.8510548115056095`*^9, 3.851054908009046*^9}, {
   3.8510549714868507`*^9, 3.851055136882959*^9}, {3.8510552265367165`*^9, 
   3.8510552265467105`*^9}, {3.85105529645767*^9, 3.851055320437721*^9}, {
   3.8510553661138296`*^9, 3.8510554351923075`*^9}, {3.851055488144758*^9, 
   3.8510554912959037`*^9}, {3.8510555455883837`*^9, 3.851055604350341*^9}, {
   3.8510556803712626`*^9, 3.8510556803712626`*^9}, {3.851055721681344*^9, 
   3.8510557379147873`*^9}, {3.8510557816860743`*^9, 
   3.8510558641333456`*^9}, {3.8510559654753475`*^9, 3.851055978619445*^9}, {
   3.8510560931228685`*^9, 3.8510560958378305`*^9}, {3.8510561473825316`*^9, 
   3.851056149173672*^9}, {3.851056208746412*^9, 3.851056330641049*^9}, {
   3.851056383598468*^9, 3.8510564051306925`*^9}, {3.8510565081446767`*^9, 
   3.851056553788103*^9}, {3.8510570140338616`*^9, 3.8510570140338616`*^9}, {
   3.851059262540867*^9, 3.85105932080949*^9}, {3.8510625947151823`*^9, 
   3.8510626019424734`*^9}, {3.8510627051562243`*^9, 
   3.8510627308137674`*^9}, {3.8510627645574083`*^9, 
   3.8510628626649103`*^9}, {3.8510629117048273`*^9, 
   3.8510629168088336`*^9}, {3.851062966969718*^9, 3.8510629708921957`*^9}, 
   3.851063016944928*^9, {3.8510631165636015`*^9, 3.851063140758713*^9}, 
   3.851063182603561*^9, {3.851063273818302*^9, 3.851063307536127*^9}, {
   3.851063392174817*^9, 3.8510634333194113`*^9}, 3.8510635095043783`*^9, {
   3.8510635515168343`*^9, 3.8510635520956373`*^9}, 3.851064794631616*^9, {
   3.851064913089613*^9, 3.851064913089613*^9}, {3.851065735318034*^9, 
   3.8510658119665937`*^9}, {3.8510658762475014`*^9, 3.851065905983961*^9}, {
   3.851066012309628*^9, 3.8510660334873962`*^9}, {3.8510660646685514`*^9, 
   3.851066065047143*^9}, 3.8510661010584497`*^9, 3.851067673084154*^9, {
   3.8510680390895786`*^9, 3.851068049379323*^9}, 3.851068470741321*^9, 
   3.8510693442287955`*^9, {3.8511427765473843`*^9, 3.851142950111263*^9}, {
   3.8511430658784494`*^9, 3.8511430669294124`*^9}, {3.8511431637527094`*^9, 
   3.8511431715051985`*^9}, {3.8511433478057985`*^9, 3.851143358771974*^9}, {
   3.8511433893554335`*^9, 3.85114339180142*^9}, 3.8511437274506865`*^9, {
   3.8511437726278944`*^9, 3.8511437804957304`*^9}, {3.851145654735467*^9, 
   3.851145750940819*^9}, {3.851465851176131*^9, 3.8514658545985336`*^9}, {
   3.8517420508691826`*^9, 3.851742119903987*^9}, {3.8517421524123755`*^9, 
   3.8517421604196744`*^9}, {3.8517424080547905`*^9, 3.851742527380596*^9}, {
   3.8517425651150713`*^9, 3.851742578958663*^9}, {3.851742617023776*^9, 
   3.851742620691454*^9}, {3.8517426848586483`*^9, 3.851742686512022*^9}, {
   3.8517427593255854`*^9, 3.851742759348347*^9}, {3.8517428755014086`*^9, 
   3.8517428756879587`*^9}, {3.8517429064365*^9, 3.851742907085128*^9}, {
   3.8517450604670887`*^9, 3.8517451417196894`*^9}, 3.851745179979627*^9, {
   3.8517483628221736`*^9, 3.851748364216897*^9}, {3.851748547706809*^9, 
   3.851748580179346*^9}, {3.851748613424239*^9, 3.8517486256017427`*^9}, {
   3.8517486806304865`*^9, 3.8517487017164073`*^9}, {3.8517487604364986`*^9, 
   3.8517487789238997`*^9}, {3.8517488105465655`*^9, 3.8517489770986695`*^9}, 
   3.8522694945385494`*^9, 3.8535404331870284`*^9, {3.8535404878464594`*^9, 
   3.8535406687734327`*^9}, {3.8535409967754416`*^9, 
   3.8535409970631595`*^9}, {3.853542019359277*^9, 3.853542047670882*^9}, {
   3.853542244854247*^9, 3.853542247914228*^9}, {3.8535424593631287`*^9, 
   3.8535425588466263`*^9}, {3.853896349854499*^9, 3.853896370120109*^9}, {
   3.8538964191096315`*^9, 3.8538965022917194`*^9}, 3.853896533041048*^9, {
   3.8538967012253017`*^9, 3.85389671494541*^9}, {3.853896754004856*^9, 
   3.8538967592338057`*^9}, {3.854345700801812*^9, 3.854345700801812*^9}, {
   3.85434578407286*^9, 3.854345791199199*^9}, {3.854427764696726*^9, 
   3.85442778504008*^9}, {3.854427833764927*^9, 3.8544279209561863`*^9}, {
   3.8544285463687105`*^9, 3.8544285480276265`*^9}, {3.8547590167516837`*^9, 
   3.854759043805722*^9}, {3.8547590902166224`*^9, 3.85475916782139*^9}, {
   3.8753087363136606`*^9, 3.87530874760568*^9}, {3.8753088099591756`*^9, 
   3.8753088167990704`*^9}, {3.877478625070322*^9, 3.87747864368408*^9}, {
   3.877479191585326*^9, 3.8774791970315156`*^9}, {3.8774796299208784`*^9, 
   3.877479674534379*^9}, {3.8774797909644656`*^9, 3.8774798007881002`*^9}, {
   3.877481245563973*^9, 3.8774812459939723`*^9}, {3.87748134043435*^9, 
   3.877481382339762*^9}, {3.8774815637000265`*^9, 3.8774815875109825`*^9}, {
   3.8774817474493866`*^9, 3.877481769843708*^9}, {3.8774827167873287`*^9, 
   3.8774828378270416`*^9}, 3.8774839678739047`*^9, {3.8774853147592335`*^9, 
   3.877485332415537*^9}, {3.877485365970621*^9, 3.877485367100621*^9}, 
   3.8774854142540054`*^9, {3.8774857533358116`*^9, 3.8774857536658115`*^9}, {
   3.877485828383007*^9, 3.8774858583262997`*^9}, {3.8774861449558773`*^9, 
   3.8774861513364162`*^9}, 3.877486194390016*^9, 3.8774863415792103`*^9, 
   3.87748639210113*^9, 3.8774864989274197`*^9, 3.8774865550931726`*^9, {
   3.877486742374058*^9, 3.8774867501348033`*^9}, {3.8774867802896996`*^9, 
   3.877486859736727*^9}, {3.8774869010977383`*^9, 3.87748695032945*^9}, {
   3.877487254140329*^9, 3.877487286634568*^9}, 3.8774873362753625`*^9, {
   3.877487385687028*^9, 3.8774873862070303`*^9}, {3.8774874717314777`*^9, 
   3.8774874735303354`*^9}, {3.8774930764243746`*^9, 3.877493082074727*^9}, {
   3.8774934385661163`*^9, 3.8774935882693663`*^9}, {3.8774937029268*^9, 
   3.877493711163434*^9}, {3.8774937571948967`*^9, 3.8774937700556946`*^9}, 
   3.8775599675219226`*^9, {3.877560014649098*^9, 3.87756003753049*^9}, {
   3.877560070022527*^9, 3.877560080032508*^9}, {3.8775606257403665`*^9, 
   3.877560626020367*^9}, {3.877560663703086*^9, 3.87756069364742*^9}, 
   3.877560813155266*^9, 3.877560869234254*^9, {3.877561153465169*^9, 
   3.8775612478831415`*^9}, {3.8775613048250027`*^9, 3.8775613472271404`*^9}, 
   3.877561422426819*^9, {3.877562811965766*^9, 3.877562840766032*^9}, {
   3.8775711915229893`*^9, 3.877571223433023*^9}, {3.8775712701796303`*^9, 
   3.877571432044859*^9}, {3.877571465505581*^9, 3.877571527125264*^9}, {
   3.8775715747490273`*^9, 3.8775717011022453`*^9}, {3.8775717313627377`*^9, 
   3.8775717449493713`*^9}, {3.877571880009465*^9, 3.8775718815154495`*^9}, {
   3.877572049451433*^9, 3.87757205062753*^9}, {3.87757213461152*^9, 
   3.8775722136215277`*^9}, {3.8775722565416193`*^9, 3.8775722592516136`*^9}, 
   3.877572318916624*^9, {3.877572361169408*^9, 3.877572421015172*^9}, {
   3.8775724738052464`*^9, 3.877572473995247*^9}, {3.8775725109333067`*^9, 
   3.8775725220833216`*^9}, {3.877572570650856*^9, 3.8775726340164557`*^9}, {
   3.8775726655949574`*^9, 3.877572739025033*^9}, {3.8775729151735888`*^9, 
   3.8775729728237658`*^9}, {3.877573018653802*^9, 3.8775730226038055`*^9}, {
   3.8775730801842237`*^9, 3.8775731432223196`*^9}, {3.877573173362344*^9, 
   3.8775732377027464`*^9}, {3.877573345802814*^9, 3.877573345942814*^9}, {
   3.8775734638389645`*^9, 3.877573472208968*^9}, {3.877573634677643*^9, 
   3.8775736610780535`*^9}, {3.8775737203663025`*^9, 
   3.8775737379988976`*^9}, {3.8775737705135784`*^9, 
   3.8775738333536015`*^9}, {3.8775739364879723`*^9, 3.877573945737965*^9}, 
   3.8775739762779193`*^9, {3.8775743483915977`*^9, 3.877574368461605*^9}, {
   3.8775744319305844`*^9, 3.877574437040595*^9}, {3.8775744764805975`*^9, 
   3.877574478340607*^9}, {3.8775745218906193`*^9, 3.8775745517489896`*^9}, 
   3.8775747521395197`*^9, {3.8776397521479673`*^9, 3.877639890854703*^9}, {
   3.8776400021207123`*^9, 3.877640043350114*^9}, {3.8776400795740013`*^9, 
   3.8776401190927343`*^9}, {3.8776490072355304`*^9, 
   3.8776490104816194`*^9}, {3.877649043277486*^9, 3.8776490913960714`*^9}, {
   3.8776491759364953`*^9, 3.877649281055314*^9}, {3.8776493229013*^9, 
   3.877649355333025*^9}, {3.877649393050435*^9, 3.877649450536586*^9}, {
   3.8776494855925426`*^9, 3.877649496910119*^9}, {3.877649534007388*^9, 
   3.8776495826904745`*^9}, {3.8776496167658715`*^9, 
   3.8776496674764767`*^9}, {3.8776497231161637`*^9, 3.877649768804138*^9}, {
   3.877649810113368*^9, 3.877649827182825*^9}, {3.877649888287654*^9, 
   3.8776498887176523`*^9}, {3.877649925067609*^9, 3.8776499426092033`*^9}, {
   3.8776499828391795`*^9, 3.877650018934157*^9}, {3.8776500544782705`*^9, 
   3.8776501262250843`*^9}, {3.877650254596871*^9, 3.8776503086238117`*^9}, {
   3.8776550241851225`*^9, 3.8776550318573794`*^9}, {3.87765506214666*^9, 
   3.87765508022821*^9}, {3.8776551475523667`*^9, 3.8776551483623753`*^9}, {
   3.8776552504254017`*^9, 3.8776552795091567`*^9}, {3.8776555979911137`*^9, 
   3.8776556259275775`*^9}, {3.8776556679986553`*^9, 3.8776557526013546`*^9}, 
   3.8776557971332364`*^9, {3.877655851461357*^9, 3.877655909913271*^9}, {
   3.877655942925852*^9, 3.8776561559309635`*^9}, {3.8776563096496468`*^9, 
   3.877656316601699*^9}, {3.8776563523266172`*^9, 3.877656384928602*^9}, {
   3.877656534411458*^9, 3.877656560716771*^9}, {3.8776566004252963`*^9, 
   3.877656789917028*^9}, {3.877656962482732*^9, 3.877656981925252*^9}, {
   3.8776570188174133`*^9, 3.8776570851741037`*^9}, {3.8776573418362293`*^9, 
   3.8776574269040656`*^9}, {3.87765784593387*^9, 3.877657911605196*^9}, {
   3.877657993139924*^9, 3.877658013242296*^9}, {3.8776580513924694`*^9, 
   3.8776586682862835`*^9}, {3.8776587380858727`*^9, 
   3.8776587529395175`*^9}, {3.8776595275173693`*^9, 
   3.8776597961411533`*^9}, {3.8776600702613344`*^9, 3.877660121582708*^9}, {
   3.8777279557643523`*^9, 3.8777280170784955`*^9}, {3.877728265648389*^9, 
   3.8777282878797474`*^9}, {3.877729227537724*^9, 3.8777292340546136`*^9}, {
   3.878334585211794*^9, 3.878334647789109*^9}, {3.878334721120677*^9, 
   3.8783347294787407`*^9}, {3.8783490453468328`*^9, 3.8783490766338406`*^9}, 
   3.8783491219326377`*^9, {3.8786850637740316`*^9, 3.878685110042341*^9}, {
   3.878685206164668*^9, 3.8786852686633263`*^9}, 3.8786853152862587`*^9, {
   3.878686763202806*^9, 3.878686763346806*^9}, {3.9010643004031744`*^9, 
   3.9010644145985823`*^9}, {3.901064467876438*^9, 3.901064477320239*^9}, {
   3.9010645232575045`*^9, 3.901064625680664*^9}, {3.9010648380228176`*^9, 
   3.9010648679996476`*^9}, {3.9010649279152627`*^9, 3.901064954773198*^9}, {
   3.9010649847910976`*^9, 3.901065057301378*^9}, {3.901065539241851*^9, 
   3.9010655608718696`*^9}, {3.901065603452899*^9, 3.9010656945000153`*^9}, {
   3.901067334090098*^9, 3.9010674817173643`*^9}, {3.9010676821801147`*^9, 
   3.90106768679414*^9}, {3.9011538155439095`*^9, 3.9011538371161833`*^9}, {
   3.9011540038160763`*^9, 3.9011540127050753`*^9}, {3.901154045917501*^9, 
   3.9011541478084607`*^9}, {3.9011542257953143`*^9, 
   3.9011542301358023`*^9}, {3.901154264570896*^9, 3.901154279811672*^9}, {
   3.9011543119091587`*^9, 3.9011543696132407`*^9}, {3.9011548041177173`*^9, 
   3.90115480754972*^9}, {3.901154850261598*^9, 3.901154854225602*^9}, {
   3.9011548944316196`*^9, 3.901154899175624*^9}, {3.9011550672517138`*^9, 
   3.9011550732517166`*^9}, 3.9011551126414347`*^9, {3.9011552388640537`*^9, 
   3.901155246024057*^9}, {3.901155326868024*^9, 3.90115534291827*^9}, {
   3.901155392680195*^9, 3.901155514208496*^9}, {3.901155816209335*^9, 
   3.9011558388515973`*^9}, {3.9011558731652074`*^9, 
   3.9011558921657925`*^9}, {3.9011559550392733`*^9, 3.901155957299265*^9}, {
   3.901156019889785*^9, 3.9011561313462863`*^9}, {3.9011562157699833`*^9, 
   3.901156220565998*^9}, {3.9011562652056775`*^9, 3.9011562819757085`*^9}, {
   3.901156328000345*^9, 3.9011564009459424`*^9}, {3.9011565595208035`*^9, 
   3.901156573209907*^9}, {3.9011566793339977`*^9, 3.9011567088780165`*^9}, {
   3.9011567766180444`*^9, 3.9011568042300634`*^9}, {3.9011569113347816`*^9, 
   3.9011569119947834`*^9}, {3.901157018844153*^9, 3.901157026056155*^9}, {
   3.901157257798546*^9, 3.9011573133969307`*^9}, {3.901157376600662*^9, 
   3.901157376932663*^9}, {3.9011574129782505`*^9, 3.9011575133604727`*^9}, {
   3.901157552350293*^9, 3.901157575013077*^9}, {3.901157677590293*^9, 
   3.90115770477031*^9}, {3.9011577469129715`*^9, 3.9011577559051065`*^9}, {
   3.901157813712333*^9, 3.9011579259689674`*^9}, {3.901158120293392*^9, 
   3.901158124216385*^9}, {3.9011585428324347`*^9, 3.9011587089671497`*^9}, {
   3.9011601250545435`*^9, 3.901160161903131*^9}, {3.9011604019464893`*^9, 
   3.901160457048561*^9}, {3.901160489074581*^9, 3.90116054820653*^9}, {
   3.9011609543973722`*^9, 3.9011609721549225`*^9}, 3.9011641929154387`*^9, {
   3.901164227017502*^9, 3.9011642778594866`*^9}, {3.9011643306554923`*^9, 
   3.901164387723461*^9}, {3.901164442953389*^9, 3.9011649139702644`*^9}, {
   3.9011649802622485`*^9, 3.9011649938741517`*^9}, {3.9011651449595795`*^9, 
   3.901165207177583*^9}, {3.9011654734116135`*^9, 3.901165516347619*^9}, {
   3.9011661107356634`*^9, 3.9011661210716543`*^9}, {3.9011661561762333`*^9, 
   3.901166160832223*^9}, {3.9011662355162287`*^9, 3.901166257107095*^9}, {
   3.901166289121707*^9, 3.901166303901693*^9}, {3.9011663367616873`*^9, 
   3.901166453817706*^9}, {3.901166493114156*^9, 3.9011665461645856`*^9}, {
   3.901166589312416*^9, 3.9011666624157314`*^9}, {3.9011667606657076`*^9, 
   3.9011669918863726`*^9}, {3.9011670382357683`*^9, 
   3.9011670627322636`*^9}, {3.9011671115819473`*^9, 
   3.9011673296197844`*^9}, {3.9011673601477857`*^9, 3.901167442515581*^9}, {
   3.9011674728499193`*^9, 3.901167530405816*^9}, {3.9011675919247727`*^9, 
   3.9011676115761456`*^9}, {3.901167729479622*^9, 3.901167736844841*^9}, {
   3.901167776864045*^9, 3.9011677773360996`*^9}, {3.9011678643776007`*^9, 
   3.9011679008417473`*^9}, {3.901168699156147*^9, 3.901168721844209*^9}, {
   3.9011687725911603`*^9, 3.901169170382135*^9}, {3.901169245022888*^9, 
   3.9011692455388885`*^9}, 3.9011693086254263`*^9, {3.9011693753830185`*^9, 
   3.9011693779270105`*^9}, 3.901169448631056*^9, {3.9011695664455204`*^9, 
   3.901169579828124*^9}, {3.9011696101311693`*^9, 3.9011696941012273`*^9}, {
   3.901169785913681*^9, 3.901169785917678*^9}, {3.901170045461877*^9, 
   3.9011700471098776`*^9}, {3.901170920487624*^9, 3.901170937341636*^9}, {
   3.9011711556416693`*^9, 3.9011711838296766`*^9}, {3.90117121742968*^9, 
   3.9011712190496807`*^9}, {3.901171252645673*^9, 3.901171256989683*^9}, {
   3.901171370667699*^9, 3.901171400519684*^9}, {3.9011720167887745`*^9, 
   3.9011720753957586`*^9}, {3.9012242563874483`*^9, 3.901224279932408*^9}, {
   3.9012243737668357`*^9, 3.9012244689134235`*^9}, {3.9012245072552843`*^9, 
   3.9012245607897835`*^9}, {3.901224683639924*^9, 3.9012247750565605`*^9}, {
   3.901226624004748*^9, 3.90122664270475*^9}, 3.9012267351449537`*^9, {
   3.90123841142928*^9, 3.901238569177327*^9}, {3.901320207187454*^9, 
   3.9013203200811586`*^9}, {3.9013400045760765`*^9, 3.901340037415543*^9}, {
   3.9013400896545267`*^9, 3.901340106068509*^9}, {3.9013401533266797`*^9, 
   3.90134017434441*^9}, {3.9013402815023155`*^9, 3.901340408008791*^9}, {
   3.9015749189551826`*^9, 3.9015749798978076`*^9}, {3.9015750538358355`*^9, 
   3.9015752750360556`*^9}, {3.9015754274501815`*^9, 
   3.9015754309855947`*^9}, {3.9015755059281893`*^9, 3.901575689672099*^9}, {
   3.901575752895507*^9, 3.901575759542054*^9}, {3.9015757952240267`*^9, 
   3.901576083997887*^9}, {3.901576257195857*^9, 3.90157626873186*^9}, {
   3.9015763156738725`*^9, 3.901576387355918*^9}, {3.9015764510538597`*^9, 
   3.901576604996561*^9}, {3.901576757480311*^9, 3.901576827113823*^9}, {
   3.901576998257947*^9, 3.9015770839556766`*^9}, {3.901658900664406*^9, 
   3.901658900856405*^9}, {3.901659100473049*^9, 3.9016591020294886`*^9}, {
   3.9016595246818385`*^9, 3.901659567929783*^9}, 3.9016596481358285`*^9, {
   3.901848008275222*^9, 3.9018480535606318`*^9}, {3.9018480862376842`*^9, 
   3.901848201016748*^9}, {3.901848245268097*^9, 3.9018483223796606`*^9}, {
   3.901848389462254*^9, 3.901848392732212*^9}, {3.9018484284892893`*^9, 
   3.901848428965291*^9}, {3.901848460337302*^9, 3.9018485671534104`*^9}, 
   3.9018486043117094`*^9, {3.9018486855773487`*^9, 3.9018487333920403`*^9}, {
   3.901848768433881*^9, 3.9018488086337037`*^9}, {3.9018488543303246`*^9, 
   3.9018489113513837`*^9}, {3.9018490487538185`*^9, 
   3.9018490677365055`*^9}, {3.9018491596151123`*^9, 3.901849294679244*^9}, {
   3.9018494305768127`*^9, 3.9018494543008137`*^9}, {3.9018494962973557`*^9, 
   3.901849597855548*^9}, {3.9018496280002184`*^9, 3.901849732201849*^9}, {
   3.90184978789972*^9, 3.901849814052734*^9}, 3.9018498475888214`*^9, {
   3.9018500293166184`*^9, 3.9018500654103165`*^9}, {3.9018501316511283`*^9, 
   3.9018501919138527`*^9}, {3.901850235929164*^9, 3.9018503077522335`*^9}, {
   3.901850340768094*^9, 3.9018504153671436`*^9}, {3.9018504601370306`*^9, 
   3.9018504730570974`*^9}, {3.9018505120113277`*^9, 
   3.9018505412199636`*^9}, {3.9018505999132605`*^9, 3.901850641219648*^9}, {
   3.9018506753948455`*^9, 3.901850702034938*^9}, {3.9018507543180842`*^9, 
   3.901850778990087*^9}, {3.901850823917925*^9, 3.901850827745939*^9}, 
   3.9018508732010202`*^9, 3.9018509206603947`*^9, {3.9018509862690763`*^9, 
   3.9018510575728617`*^9}, {3.901851101951876*^9, 3.9018511048788457`*^9}, {
   3.9018511644024816`*^9, 3.901851170026497*^9}, {3.901851441799884*^9, 
   3.901851446407877*^9}, {3.9018528412538*^9, 3.9018529272512193`*^9}, {
   3.9025499345902257`*^9, 3.902550041882566*^9}, {3.902550084074681*^9, 
   3.9025500898306885`*^9}, {3.9025501207227497`*^9, 
   3.9025501899030113`*^9}, {3.902550405455494*^9, 3.902550417855178*^9}, {
   3.9029720026787353`*^9, 3.9029720148587294`*^9}, {3.9029721533967113`*^9, 
   3.9029727286559134`*^9}, {3.902972873644926*^9, 3.9029729117686343`*^9}, {
   3.9029731591226892`*^9, 3.9029732188313074`*^9}, {3.902973864438696*^9, 
   3.9029739074596624`*^9}, {3.902974308126629*^9, 3.902974409869705*^9}},
 AspectRatioFixed->True,
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[16]:=",ExpressionUUID->"55d175db-2e2d-4acd-b57c-348bc9f05e56"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Functions for ",
 StyleBox["even",
  FontColor->RGBColor[1, 0, 0]],
 " numbers of pole ",
 StyleBox["(you can choose either ",
  FontColor->RGBColor[1, 0.5, 0.5]],
 StyleBox["odd",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" or ",
  FontColor->RGBColor[1, 0.5, 0.5]],
 StyleBox["even",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox[" poles)",
  FontColor->RGBColor[1, 0.5, 0.5]]
}], "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.851744128405555*^9, 3.851744135206566*^9}, 
   3.8535432776540785`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"299921ee-134d-47aa-b8be-840f476c3a44"],

Cell[TextData[StyleBox["The following function builds an array of rectangular \
permanent magnets with their mirror symmetric counterparts, distributes the \
colors, magnetic materials and sets the segmentation. The function is very \
generic and can be used to build almost any hybrid wiggler (without \
optimizing the design of terminations).",
 Evaluatable->False,
 AspectRatioFixed->True]], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8520029529574227`*^9, 3.852002953874771*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"4e552465-4ec0-4637-a637-47ed123e34e8"],

Cell[TextData[{
 "wig[]:=Module[{},\n\n",
 StyleBox["(* A model for even numbers in main poles *)\n(* array for up and \
down in z *)",
  FontColor->RGBColor[0, 0, 1]],
 "\nFor[array=1,array>=-1,array-=2,(\n",
 StyleBox["(* side for positive and negative in y *)",
  FontColor->RGBColor[0, 0, 1]],
 "\nFor[side=1,side>=-1,side-=2,(\ny=0;\nFor[i=1,i<=NumPer,i++,(\n",
 StyleBox["(* Random generator 1 *)",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["\nr=RandomVariate[NormalDistribution[1,sdr]];\n\
theta=RandomVariate[NormalDistribution[0,sdt]]*Pi/180;\n\
phi=RandomReal[]*2*Pi;\n\
If[sd==0,ms={0,1,0},ms={Sin[theta]*Cos[phi],Cos[theta],Sin[theta]*Sin[phi]}];\
\nIf[sd==0,mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt],mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt*r]];\n",
  FontColor->GrayLevel[0]],
 StyleBox["If[sd==0,sx=0, sx=RandomVariate[NormalDistribution[0,sdsx]]];\n\
If[sd==0,sy=1, sy=RandomVariate[NormalDistribution[1,sdsy]]];\nIf[sd==0,sz=1, \
sz=RandomVariate[NormalDistribution[1,sdsz]]];",
  FontColor->GrayLevel[0]],
 StyleBox["\n(*Print[\"Random radians end (\",r,\", \",theta,\", \",phi,\"), \
cartesian (\",ms[[1]],\", \",ms[[2]],\", \",ms[[3]],\"), norm \
(\",Sqrt[ms[[1]]^2+ms[[2]]^2+ms[[3]]],\")\"];*)",
  FontColor->GrayLevel[0]],
 "\n",
 StyleBox["(* Periodic Magnet 1 *)\n",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["initm={ms[[1]],array*ms[[2]]*(Mod[i,2]-Mod[i+1,2]),ms[[3]]};",
  FontColor->GrayLevel[0]],
 "\nIf[i==1,y+=sy*sp[[2]]/2,y+=sy*sp[[2]]];\n\
z1={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(sz*sp[[3]])},{lm[[1]]-2*chmk,lm[[2]]\
/2}};\nz2={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(chmk+sz*sp[[3]])},{lm[[1]],\
lm[[2]]/2}};\n\
z3={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(lm[[3]]+sz*sp[[3]])},{lm[[1]],lm[[2]\
]/2}};\nmagnetP1=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{z1,z2,z3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magnetP1,nmd,cm,mm];\nIf[i==1,y+=lm[[2]]/4,y+=lm[[2]]/4];\n\n",
 StyleBox["(* Periodic Pole p *)\n",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["If[sd==0,sx=0, sx=RandomVariate[NormalDistribution[0,sdsx]]];\n\
If[sd==0,sy=1, sy=RandomVariate[NormalDistribution[1,sdsy]]];\nIf[sd==0,sz=1, \
sz=RandomVariate[NormalDistribution[1,sdsz]]];",
  FontColor->GrayLevel[0]],
 "\ny+=(lm[[2]]/2+lp[[2]])/2+sy*sp[[2]];\n\
p1={{sx+sp[[1]],side*y,array*(sz*sp[[3]]+gapoffset)},{lp[[1]]-2*chp[[1]],lp[[\
2]]-2*chp[[2]]}};\n\
p2={{sx+sp[[1]],side*y,array*(chp[[3]]+sz*sp[[3]]+gapoffset)},{lp[[1]],lp[[2]]\
}};\np3={{sx+sp[[1]],side*y,array*(lp[[3]]+sz*sp[[3]]+gapoffset)},{lp[[1]],lp[\
[2]]}};\npoleP=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{p1,p2,p3},zer];\nnpd={np[[2]],np[[2]],np[[1]]};\n\
fullMag[poleP,npd,cp,mp];\n\n",
 StyleBox["(* Random generator 2 *)",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["\nr=RandomVariate[NormalDistribution[1,sdr]];\n\
theta=RandomVariate[NormalDistribution[0,sdt]]*Pi/180;\n\
phi=RandomReal[]*2*Pi;\n\
If[sd==0,ms={0,1,0},ms={Sin[theta]*Cos[phi],Cos[theta],Sin[theta]*Sin[phi]}];\
\nIf[sd==0,mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt],mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt*r]];\n",
  FontColor->GrayLevel[0]],
 StyleBox["If[sd==0,sx=0, sx=RandomVariate[NormalDistribution[0,sdsx]]];\n\
If[sd==0,sy=1, sy=RandomVariate[NormalDistribution[1,sdsy]]];\nIf[sd==0,sz=1, \
sz=RandomVariate[NormalDistribution[1,sdsz]]];",
  FontColor->GrayLevel[0]],
 StyleBox["\n(*Print[\"Random radians end (\",r,\", \",theta,\", \",phi,\"), \
cartesian (\",ms[[1]],\", \",ms[[2]],\", \",ms[[3]],\"), norm \
(\",Sqrt[ms[[1]]^2+ms[[2]]^2+ms[[3]]],\")\"];*)",
  FontColor->GrayLevel[0]],
 "\n",
 StyleBox["(* Periodic Magnet 2 *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ninitm={ms[[1]],",
 StyleBox["array*",
  FontColor->GrayLevel[0]],
 "ms[[2]]*(Mod[i+1,2]-Mod[i,2]),ms[[3]]};\ny+=lp[[2]]/2+sy*sp[[2]];\n\
z1={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(sz*sp[[3]])},{lm[[1]]-2*chmk,lm[[2]]\
/2}};\nz2={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(chmk+sz*sp[[3]])},{lm[[1]],\
lm[[2]]/2}};\n\
z3={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(lm[[3]]+sz*sp[[3]])},{lm[[1]],lm[[2]\
]/2}};\nmagnetP2=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{z1,z2,z3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magnetP2,nmd,cm,mm];\ny+=lm[[2]]/2;\n\nIf[i==1,magnet1=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{magnetP1,magnetP2}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet1,{magnetP1,magnetP2}]];\nIf[i==1,pole1=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{poleP}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[pole1,{poleP}]];\n(*",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{poleP,mangetP1,magnetP2}];*)\n)];\n\n",
 StyleBox["(* Random generator 3p *)",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["\nr=RandomVariate[NormalDistribution[1,sdr]];\n\
theta=RandomVariate[NormalDistribution[0,sdt]]*Pi/180;\n\
phi=RandomReal[]*2*Pi;\n\
If[sd==0,ms={0,1,0},ms={Sin[theta]*Cos[phi],Cos[theta],Sin[theta]*Sin[phi]}];\
\nIf[sd==0,mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt],mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt*r]];\n",
  FontColor->GrayLevel[0]],
 StyleBox["If[sd==0,sx=0, sx=RandomVariate[NormalDistribution[0,sdsx]]];\n\
If[sd==0,sy=1, sy=RandomVariate[NormalDistribution[1,sdsy]]];\nIf[sd==0,sz=1, \
sz=RandomVariate[NormalDistribution[1,sdsz]]];",
  FontColor->GrayLevel[0]],
 StyleBox["\n(*Print[\"Random radians end (\",r,\", \",theta,\", \",phi,\"), \
cartesian (\",ms[[1]],\", \",ms[[2]],\", \",ms[[3]],\"), norm \
(\",Sqrt[ms[[1]]^2+ms[[2]]^2+ms[[3]]],\")\"];*)",
  FontColor->GrayLevel[0]],
 "\n",
 StyleBox["(* Magnet before End pole p *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ninitm={ms[[1]],",
 StyleBox["array*",
  FontColor->GrayLevel[0]],
 "ms[[2]]*(Mod[NumPer+1,2]-Mod[NumPer,2]),ms[[3]]};\n\
If[NumPer==0,y+=sy*sp[[2]]/2,y+=sy*sp[[2]]];\n\
z1={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(sz*sp[[3]])},{lm[[1]]-2*chmk,lm[[2]]\
/2}};\nz2={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(chmk+sz*sp[[3]])},{lm[[1]],\
lm[[2]]/2}};\n\
z3={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(lm[[3]]+sz*sp[[3]])},{lm[[1]],lm[[2]\
]/2}};\nmagnet2=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{z1,z2,z3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magnet2,nmd,cm,mm];\ny+=lm[[2]]/4;\n\n",
 StyleBox["(* End pole p *)\n",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["If[sd==0,sx=0, sx=RandomVariate[NormalDistribution[0,sdsx]]];\n\
If[sd==0,sy=1, sy=RandomVariate[NormalDistribution[1,sdsy]]];\nIf[sd==0,sz=1, \
sz=RandomVariate[NormalDistribution[1,sdsz]]];",
  FontColor->GrayLevel[0]],
 "\ny+=(lm[[2]]/2+lep[[2]])/2+sy*sp[[2]]+dpm[[1]];\n\
p1={{sx+sp[[1]],side*y,array*(sz*sp[[3]]+gapoffset)},{lep[[1]]-2*chp[[1]],lep[\
[2]]-2*chp[[2]]}};\n\
p2={{sx+sp[[1]],side*y,array*(chp[[3]]+sz*sp[[3]]+gapoffset)},{lep[[1]],lep[[\
2]]}};\np3={{sx+sp[[1]],side*y,array*(lep[[3]]+sz*sp[[3]]+gapoffset)},{lep[[1]\
],lep[[2]]}};\npole2=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{p1,p2,p3},zer];\nnpd={np[[2]],np[[2]],np[[1]]};\n\
fullMag[pole2,npd,cp,mp];\n\n",
 StyleBox["(* Random generator 4p *)",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["\nr=RandomVariate[NormalDistribution[1,sdr]];\n\
theta=RandomVariate[NormalDistribution[0,sdt]]*Pi/180;\n\
phi=RandomReal[]*2*Pi;\n\
If[sd==0,ms={0,1,0},ms={Sin[theta]*Cos[phi],Cos[theta],Sin[theta]*Sin[phi]}];\
\nIf[sd==0,mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt],mm=",
  FontColor->GrayLevel[0]],
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[mt*r]];\n",
  FontColor->GrayLevel[0]],
 StyleBox["If[sd==0,sx=0, sx=RandomVariate[NormalDistribution[0,sdsx]]];\n\
If[sd==0,sy=1, sy=RandomVariate[NormalDistribution[1,sdsy]]];\nIf[sd==0,sz=1, \
sz=RandomVariate[NormalDistribution[1,sdsz]]];",
  FontColor->GrayLevel[0]],
 StyleBox["\n(*Print[\"Random radians end (\",r,\", \",theta,\", \",phi,\"), \
cartesian (\",ms[[1]],\", \",ms[[2]],\", \",ms[[3]],\"), norm \
(\",Sqrt[ms[[1]]^2+ms[[2]]^2+ms[[3]]],\")\"];*)",
  FontColor->GrayLevel[0]],
 "\n",
 StyleBox["(* End magnet for half size and unit model p *)",
  FontColor->RGBColor[0, 0, 1]],
 "\nIf[(NumPer!=0)&&(ending==0),initm={ms[[1]],",
 StyleBox["array*",
  FontColor->GrayLevel[0]],
 "ms[[2]]*(-Mod[NumPer,2]+Mod[NumPer+1,2]),ms[[3]]},initm={ms[[1]],",
 StyleBox["array*",
  FontColor->GrayLevel[0]],
 "ms[[2]]*(Mod[NumPer,2]-Mod[NumPer+1,2]),ms[[3]]}];\n\
y+=lep[[2]]/2+sy*sp[[2]]+dpm[[2]];\n\
z1={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(sz*sp[[3]])},{lm[[1]]-2*chmk,lm[[2]]\
/2}};\nz2={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(chmk+sz*sp[[3]])},{lm[[1]],\
lm[[2]]/2}};\n\
z3={{sx+sp[[1]],side*(y+lm[[2]]/4),array*(lm[[3]]+sz*sp[[3]])},{lm[[1]],lm[[2]\
]/2}};\nmagEnd=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{z1,z2,z3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magEnd,nmd,cm,mm];\n\nIf[NumPer==0,If[(side==1 && array==1),magnet=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{magnet2,magEnd}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet,{magnet2,magEnd}]],If[(side==1 && array==1),magnet=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{magnet1,magnet2,magEnd}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet,{magnet1,magnet2,magEnd}]]];\nIf[NumPer==0,If[(side==1 && \
array==1),pole=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole2,pole2}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[pole,{pole2,pole2}]],If[(side==1 && array==1),pole=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole1,pole2}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[pole,{pole1,pole2}]]];\nIf[NumPer==0,poleF=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole2,pole2}],If[(array==1),If[side==1,poleF=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole1,pole2}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[poleF,{pole1,pole2}]],\"\"]];\nIf[NumPer==0,If[(side==1 && array==1),und=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole2,magnet2,magEnd}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{pole2,magnet2,magEnd}]],If[(side==1 && array==1),und=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole1,magnet1}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{pole1,magnet1}]]];\nIf[(NumPer>0) && (ending==0),\"\",",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{magnet2,pole2,magEnd}]];\n\n)];\n)];\n\ny=Abs[y];\ny+=lm[[2]]/4;\n\n\
undfrc=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole,magnet}];\n\n(*undc=",
 StyleBox["radObjCutMag",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{0,0,40},{0,0,1},Frame->Lab][[1]];*)\n(*Print[\"Total length \
(\",NumPer*2,\" poles):    \",N[(y+lm[[2]]/4)*2,5],\"  mm\"];*)\n\
totallength=N[(y+lm[[2]]/4)*2,5];\nnumPoles=NumPer*2;\nund\n]"
}], "Input",
 CellChangeTimes->{{3.849572053474595*^9, 3.849572128248249*^9}, {
   3.8495721848720493`*^9, 3.8495722281664696`*^9}, 3.849572285281133*^9, {
   3.8495723201835403`*^9, 3.849572382495947*^9}, {3.8495724984617414`*^9, 
   3.8495726459489584`*^9}, {3.8495726931130342`*^9, 
   3.8495728356567016`*^9}, {3.8495729143377485`*^9, 3.849572947541973*^9}, {
   3.849574520430972*^9, 3.849574617407159*^9}, 3.8495749949739966`*^9, 
   3.849575198792453*^9, {3.849575253961528*^9, 3.849575257845567*^9}, {
   3.849575356144841*^9, 3.8495754028819685`*^9}, {3.849575440866559*^9, 
   3.849575441738719*^9}, {3.849575687866083*^9, 3.8495757106214275`*^9}, 
   3.8495765066683154`*^9, 3.8495765549937887`*^9, {3.8495769759598475`*^9, 
   3.8495769966405296`*^9}, {3.8495774603427267`*^9, 3.8495774809366355`*^9}, 
   3.8496496480230937`*^9, {3.8496497572610207`*^9, 3.8496497711510096`*^9}, {
   3.8496498796180425`*^9, 3.8496500161786733`*^9}, {3.8496501412783337`*^9, 
   3.8496501515083246`*^9}, {3.8496502064119053`*^9, 
   3.8496502315046177`*^9}, {3.849650272002843*^9, 3.849650273132842*^9}, 
   3.849650613668476*^9, {3.8496507238757906`*^9, 3.84965074316577*^9}, {
   3.8496507915721097`*^9, 3.8496509208188615`*^9}, 3.8496510498600764`*^9, {
   3.849651279488081*^9, 3.849651487604303*^9}, {3.8496518738166*^9, 
   3.8496520911898065`*^9}, 3.8496521218997993`*^9, {3.8496522562979717`*^9, 
   3.849652278647721*^9}, {3.8496523885892143`*^9, 3.849652510885844*^9}, {
   3.849652543115576*^9, 3.8496525730553303`*^9}, {3.8496526206749496`*^9, 
   3.8496526593390446`*^9}, {3.8496526938089123`*^9, 
   3.8496527410649824`*^9}, {3.849652845797761*^9, 3.8496528562377*^9}, {
   3.849652923538856*^9, 3.849652980596321*^9}, {3.849653012957328*^9, 
   3.849653056181904*^9}, {3.849653751943803*^9, 3.8496539085934997`*^9}, {
   3.849654194491127*^9, 3.849654231579466*^9}, {3.8496543520936613`*^9, 
   3.8496543620036488`*^9}, {3.849654481148229*^9, 3.849654523407072*^9}, {
   3.8496545666467896`*^9, 3.8496548105918903`*^9}, {3.84965499145909*^9, 
   3.84965499145909*^9}, {3.8496550411998053`*^9, 3.8496550547927537`*^9}, {
   3.849655089330888*^9, 3.8496551981755767`*^9}, {3.849655234461477*^9, 
   3.849655244041669*^9}, {3.849655404522587*^9, 3.849655425193003*^9}, {
   3.849655482852952*^9, 3.849655487742996*^9}, {3.8496555832061357`*^9, 
   3.8496555845161467`*^9}, {3.8496556220471354`*^9, 3.849655622617135*^9}, 
   3.84965591666016*^9, {3.8496559530157943`*^9, 3.8496559544757924`*^9}, {
   3.8496560225457516`*^9, 3.8496560416357403`*^9}, {3.8496561806245184`*^9, 
   3.8496563091946115`*^9}, {3.849656452326645*^9, 3.8496565181925516`*^9}, {
   3.8496565756179776`*^9, 3.8496566751473513`*^9}, {3.8496572097148733`*^9, 
   3.849657217110723*^9}, {3.8496572487805567`*^9, 3.8496572505705533`*^9}, {
   3.849658997552963*^9, 3.8496590409819226`*^9}, {3.8496591403549976`*^9, 
   3.849659143774991*^9}, {3.84965922107034*^9, 3.849659420929379*^9}, {
   3.8496594515093565`*^9, 3.8496595912458344`*^9}, {3.8496596525087585`*^9, 
   3.849659671818761*^9}, 3.8496597365267897`*^9, {3.849659774587121*^9, 
   3.8496598094075537`*^9}, {3.849659863057528*^9, 3.8496598670856447`*^9}, {
   3.849660321649008*^9, 3.849660328899002*^9}, {3.8496603958666625`*^9, 
   3.8496603987166376`*^9}, 3.8496606566854277`*^9, {3.849660913895274*^9, 
   3.84966095817277*^9}, {3.8496624456754284`*^9, 3.84966272601681*^9}, 
   3.8496630302098284`*^9, {3.8497499375330257`*^9, 3.849749965094982*^9}, {
   3.849750008097274*^9, 3.849750130160448*^9}, {3.849750162936884*^9, 
   3.8497502444175253`*^9}, {3.8497502763831453`*^9, 3.849750286448638*^9}, {
   3.8497504344525104`*^9, 3.849750440524328*^9}, {3.849750588148366*^9, 
   3.8497506058483562`*^9}, {3.8497506864222775`*^9, 3.849750686608833*^9}, {
   3.8497507634305534`*^9, 3.849750870078232*^9}, {3.8497509215909166`*^9, 
   3.849750961882139*^9}, 3.8497510480660105`*^9, {3.8497510953613367`*^9, 
   3.8497512108838816`*^9}, {3.8497513782035255`*^9, 
   3.8497514182469444`*^9}, {3.8497517570223703`*^9, 
   3.8497517610943174`*^9}, {3.8497522167422757`*^9, 3.849752222752227*^9}, {
   3.8497522535819855`*^9, 3.8497522715158925`*^9}, {3.8497523163636446`*^9, 
   3.849752365257762*^9}, {3.8497524394469676`*^9, 3.8497525467267733`*^9}, {
   3.8497526162460794`*^9, 3.849752730508974*^9}, {3.849752770647138*^9, 
   3.8497528754950533`*^9}, {3.8497529302808847`*^9, 
   3.8497529310368824`*^9}, {3.849752966170538*^9, 3.849752995560673*^9}, 
   3.849753094146408*^9, {3.8497531278702908`*^9, 3.849753173006328*^9}, {
   3.8497532221720777`*^9, 3.84975323998105*^9}, {3.8497532722379503`*^9, 
   3.849753308469886*^9}, {3.8497533675497417`*^9, 3.849753426157132*^9}, {
   3.849753465477519*^9, 3.849753486393488*^9}, {3.849753520149412*^9, 
   3.8497536034092927`*^9}, {3.8497536554952073`*^9, 
   3.8497536990731473`*^9}, {3.8497537605590134`*^9, 
   3.8497539324379373`*^9}, {3.849754188272478*^9, 3.8497542085632753`*^9}, {
   3.849754240222534*^9, 3.849754275428356*^9}, {3.849754319480324*^9, 
   3.849754449686803*^9}, {3.849754484139702*^9, 3.849754528988512*^9}, {
   3.8497546041260996`*^9, 3.849754604879239*^9}, {3.8497547100241218`*^9, 
   3.8497547173961897`*^9}, {3.849754754877966*^9, 3.8497547890419793`*^9}, {
   3.8497550016658645`*^9, 3.849755105812526*^9}, {3.8497551377809114`*^9, 
   3.8497551480577655`*^9}, {3.8497551800267334`*^9, 3.849755325571764*^9}, {
   3.8497553644264603`*^9, 3.8497555219991117`*^9}, {3.8497556159345703`*^9, 
   3.8497556439642153`*^9}, 3.8497556823861065`*^9, {3.8497557283136735`*^9, 
   3.849755732065662*^9}, {3.8497557959392433`*^9, 3.8497557994933662`*^9}, {
   3.8497558325750475`*^9, 3.8497558344500303`*^9}, {3.849755919684507*^9, 
   3.849755920058524*^9}, 3.8497560960695295`*^9, {3.849756178885105*^9, 
   3.8497562391128025`*^9}, {3.8497562954698844`*^9, 
   3.8497564127158794`*^9}, {3.849756443796565*^9, 3.849756462014041*^9}, {
   3.8497565288214016`*^9, 3.849756550793353*^9}, {3.849756587071148*^9, 
   3.8497566234090247`*^9}, {3.8497566535536113`*^9, 3.849756772946063*^9}, {
   3.8497568519001207`*^9, 3.8497568528021135`*^9}, {3.8497569026428585`*^9, 
   3.8497570817031617`*^9}, {3.8497571186533933`*^9, 3.84975721537283*^9}, {
   3.849757372992374*^9, 3.8497574193723087`*^9}, {3.849761942138438*^9, 
   3.8497619599451885`*^9}, {3.8497621620103097`*^9, 3.849762171790825*^9}, {
   3.8497622211559525`*^9, 3.8497622870381527`*^9}, {3.8497624530195274`*^9, 
   3.84976252969528*^9}, {3.849762567982712*^9, 3.8497625684083047`*^9}, {
   3.8497626406974173`*^9, 3.8497626406974173`*^9}, {3.8497626839848347`*^9, 
   3.8497626932761354`*^9}, {3.8497628453613615`*^9, 3.849763020820834*^9}, {
   3.849763051917959*^9, 3.849763056917778*^9}, {3.8497631446337004`*^9, 
   3.8497631743139377`*^9}, {3.849763271597988*^9, 3.8497632770438967`*^9}, {
   3.8503630079120965`*^9, 3.850363017306899*^9}, {3.8503630503472223`*^9, 
   3.850363121442315*^9}, {3.850363564765591*^9, 3.8503636606558075`*^9}, {
   3.8503637130732384`*^9, 3.85036392836654*^9}, {3.8503639641016207`*^9, 
   3.85036416309011*^9}, {3.850364201014919*^9, 3.850364202982326*^9}, {
   3.8503642614712973`*^9, 3.8503643232658005`*^9}, {3.850364427254345*^9, 
   3.8503644619422393`*^9}, {3.8503646484184103`*^9, 3.850364658187863*^9}, {
   3.850364709477672*^9, 3.850364827016487*^9}, {3.850364937036547*^9, 
   3.8503649374111104`*^9}, {3.8504258870470533`*^9, 
   3.8504258896407185`*^9}, {3.8504259684557886`*^9, 3.850426002247655*^9}, {
   3.8504260750277514`*^9, 3.8504263755725374`*^9}, {3.850426528034941*^9, 
   3.850426528038929*^9}, {3.850426950151224*^9, 3.850426950431485*^9}, {
   3.85042702073777*^9, 3.850427052511649*^9}, {3.850427114189725*^9, 
   3.850427120263237*^9}, {3.8504273595421786`*^9, 3.850427526684953*^9}, {
   3.850427560825823*^9, 3.850427588309058*^9}, {3.8504537782380285`*^9, 
   3.8504538010338*^9}, {3.850453839474612*^9, 3.8504538734518423`*^9}, {
   3.8510483894414067`*^9, 3.8510483953752337`*^9}, 3.851048427419779*^9, {
   3.851049164184822*^9, 3.851049166835044*^9}, 3.851049240080081*^9, {
   3.851049276809397*^9, 3.851049279178295*^9}, {3.851049394473662*^9, 
   3.851049424255614*^9}, {3.851049601307565*^9, 3.851049720920559*^9}, {
   3.851049761926608*^9, 3.8510497815549765`*^9}, {3.851049840294496*^9, 
   3.8510498562122307`*^9}, {3.851049897970579*^9, 3.8510499007534127`*^9}, {
   3.851049941107956*^9, 3.8510499811154613`*^9}, {3.851050033425353*^9, 
   3.851050093988776*^9}, {3.8510502137396507`*^9, 3.851050238229588*^9}, {
   3.851050272877201*^9, 3.8510503673418827`*^9}, {3.8510504088300114`*^9, 
   3.8510504565154295`*^9}, {3.851050552487337*^9, 3.851050576693821*^9}, {
   3.8510506411561995`*^9, 3.851050692153689*^9}, {3.85105072979303*^9, 
   3.851050733577072*^9}, {3.8510507665050187`*^9, 3.8510508068693447`*^9}, {
   3.851050854739363*^9, 3.851050906243621*^9}, {3.8510510286303587`*^9, 
   3.8510510800100465`*^9}, {3.851051140169341*^9, 3.851051165968132*^9}, {
   3.8510512413938026`*^9, 3.851051282147688*^9}, {3.8510513772973666`*^9, 
   3.8510514313325386`*^9}, {3.8510514687295017`*^9, 
   3.8510514847506547`*^9}, {3.8510515408764133`*^9, 3.851051564999012*^9}, {
   3.85105159932598*^9, 3.8510517112101*^9}, {3.8510517594729357`*^9, 
   3.8510519107731714`*^9}, {3.8510519567549124`*^9, 3.851051980136232*^9}, {
   3.8510520418612704`*^9, 3.8510520963086176`*^9}, {3.8510521300788937`*^9, 
   3.851052137272685*^9}, {3.8510521747102537`*^9, 3.851052235493968*^9}, {
   3.8510523920230465`*^9, 3.851052503731397*^9}, {3.8510525695586557`*^9, 
   3.8510525844124117`*^9}, {3.851052617540492*^9, 3.8510527667906313`*^9}, {
   3.851052805181423*^9, 3.8510528056613607`*^9}, {3.851052867728486*^9, 
   3.851052907964464*^9}, {3.8510530014228463`*^9, 3.8510530047340755`*^9}, {
   3.8510530665564585`*^9, 3.851053165251396*^9}, {3.8510531990998535`*^9, 
   3.851053208483695*^9}, {3.8510532452758484`*^9, 3.8510532479970207`*^9}, {
   3.851053296807282*^9, 3.8510533405797424`*^9}, {3.851054457497221*^9, 
   3.851054765871666*^9}, {3.8510548115056095`*^9, 3.851054908009046*^9}, {
   3.8510549714868507`*^9, 3.851055136882959*^9}, {3.8510552265367165`*^9, 
   3.8510552265467105`*^9}, {3.85105529645767*^9, 3.851055320437721*^9}, {
   3.8510553661138296`*^9, 3.8510554351923075`*^9}, {3.851055488144758*^9, 
   3.8510554912959037`*^9}, {3.8510555455883837`*^9, 3.851055604350341*^9}, {
   3.8510556803712626`*^9, 3.8510556803712626`*^9}, {3.851055721681344*^9, 
   3.8510557379147873`*^9}, {3.8510557816860743`*^9, 
   3.8510558641333456`*^9}, {3.8510559654753475`*^9, 3.851055978619445*^9}, {
   3.8510560931228685`*^9, 3.8510560958378305`*^9}, {3.8510561473825316`*^9, 
   3.851056149173672*^9}, {3.851056208746412*^9, 3.851056330641049*^9}, {
   3.851056383598468*^9, 3.8510564051306925`*^9}, {3.8510565081446767`*^9, 
   3.851056553788103*^9}, {3.8510570140338616`*^9, 3.8510570140338616`*^9}, {
   3.851059262540867*^9, 3.85105932080949*^9}, {3.8510625947151823`*^9, 
   3.8510626019424734`*^9}, {3.8510627051562243`*^9, 
   3.8510627308137674`*^9}, {3.8510627645574083`*^9, 
   3.8510628626649103`*^9}, {3.8510629117048273`*^9, 
   3.8510629168088336`*^9}, {3.851062966969718*^9, 3.8510629708921957`*^9}, 
   3.851063016944928*^9, {3.8510631165636015`*^9, 3.851063140758713*^9}, 
   3.851063182603561*^9, {3.851063273818302*^9, 3.851063307536127*^9}, {
   3.851063392174817*^9, 3.8510634333194113`*^9}, 3.8510635095043783`*^9, {
   3.8510635515168343`*^9, 3.8510635520956373`*^9}, 3.851064794631616*^9, {
   3.851064913089613*^9, 3.851064913089613*^9}, {3.851065735318034*^9, 
   3.8510658119665937`*^9}, {3.8510658762475014`*^9, 3.851065905983961*^9}, {
   3.851066012309628*^9, 3.8510660334873962`*^9}, {3.8510660646685514`*^9, 
   3.851066065047143*^9}, 3.8510661010584497`*^9, 3.851067673084154*^9, {
   3.8510680390895786`*^9, 3.851068049379323*^9}, 3.851068470741321*^9, 
   3.8510693442287955`*^9, {3.8511427765473843`*^9, 3.851142950111263*^9}, {
   3.8511430658784494`*^9, 3.8511430669294124`*^9}, {3.8511431637527094`*^9, 
   3.8511431715051985`*^9}, {3.8511433478057985`*^9, 3.851143358771974*^9}, {
   3.8511433893554335`*^9, 3.85114339180142*^9}, 3.8511437274506865`*^9, {
   3.8511437726278944`*^9, 3.8511437804957304`*^9}, {3.851145654735467*^9, 
   3.851145750940819*^9}, {3.851465851176131*^9, 3.8514658545985336`*^9}, {
   3.8517420508691826`*^9, 3.851742119903987*^9}, {3.8517421524123755`*^9, 
   3.8517421604196744`*^9}, {3.8517424080547905`*^9, 3.851742527380596*^9}, {
   3.8517425651150713`*^9, 3.851742578958663*^9}, {3.851742617023776*^9, 
   3.851742620691454*^9}, {3.8517426848586483`*^9, 3.851742686512022*^9}, {
   3.8517427593255854`*^9, 3.851742759348347*^9}, {3.8517428755014086`*^9, 
   3.8517428756879587`*^9}, {3.8517429064365*^9, 3.851742907085128*^9}, {
   3.8517442380140576`*^9, 3.8517442622490263`*^9}, {3.8517443156629424`*^9, 
   3.8517445019602246`*^9}, {3.8517445741886573`*^9, 3.851744578323807*^9}, {
   3.8517446403399878`*^9, 3.851744702041258*^9}, 3.851744831498459*^9, {
   3.8517449399858174`*^9, 3.85174499125613*^9}, {3.85174521791195*^9, 
   3.8517452293032894`*^9}, 3.8517457233151503`*^9, {3.8517459754856443`*^9, 
   3.851745981984322*^9}, {3.851746017724723*^9, 3.8517460209410563`*^9}, {
   3.851746077007507*^9, 3.8517460787221966`*^9}, {3.851746114756243*^9, 
   3.8517461263897095`*^9}, {3.8517462197633133`*^9, 
   3.8517462228993745`*^9}, {3.8517463151140213`*^9, 
   3.8517463177401857`*^9}, {3.851746366771045*^9, 3.8517463670636206`*^9}, {
   3.851746405337989*^9, 3.8517464069562607`*^9}, {3.85174646691553*^9, 
   3.851746544156163*^9}, 3.851746942740648*^9, 3.851747121925827*^9, {
   3.8517471641554174`*^9, 3.8517471650502853`*^9}, {3.8517472908644876`*^9, 
   3.8517472947823043`*^9}, {3.8517475309386168`*^9, 
   3.8517475578870287`*^9}, {3.85174759081551*^9, 3.8517475909058814`*^9}, 
   3.8517477944921885`*^9, {3.851749004517153*^9, 3.851749016402214*^9}, {
   3.853541282196571*^9, 3.853541297752879*^9}, {3.8535422322576327`*^9, 
   3.853542234657625*^9}, {3.8535425732291393`*^9, 3.8535425829691205`*^9}, {
   3.8544279440762043`*^9, 3.854427958149743*^9}, {3.8547591932100573`*^9, 
   3.854759274181389*^9}, {3.8753087575345984`*^9, 3.8753087600215178`*^9}, 
   3.875308831871881*^9, 3.8753238237471685`*^9, {3.877495340966879*^9, 
   3.8774953469969997`*^9}, {3.8774955240418835`*^9, 3.877495878599823*^9}, {
   3.877561587577402*^9, 3.877561668560397*^9}, {3.8775617093369713`*^9, 
   3.877561715155995*^9}, 3.877561786791532*^9, {3.877561818484866*^9, 
   3.877561823795274*^9}, {3.8775621979917626`*^9, 3.877562212721531*^9}, 
   3.8775622521550026`*^9, {3.8775622836097155`*^9, 3.877562284179739*^9}, {
   3.8775623155715322`*^9, 3.8775623457396617`*^9}, {3.8775748335597134`*^9, 
   3.8775748381897063`*^9}, {3.877574892639731*^9, 3.8775748954597535`*^9}, {
   3.8775749265631905`*^9, 3.8775749271232014`*^9}, {3.8775749999332237`*^9, 
   3.877575002993225*^9}, 3.8775751127010202`*^9, {3.8776506978745933`*^9, 
   3.8776507395542336`*^9}, {3.877650781362553*^9, 3.877651201907811*^9}, {
   3.8776512398440347`*^9, 3.877651243133116*^9}, {3.8777301620168076`*^9, 
   3.8777301922409496`*^9}, {3.8777302400735836`*^9, 3.877730360423845*^9}, {
   3.877730481737904*^9, 3.8777307651550465`*^9}, {3.877730803755762*^9, 
   3.8777308111958103`*^9}, {3.877730847203395*^9, 3.877730980330612*^9}, {
   3.8777310131367702`*^9, 3.877731095461791*^9}, {3.8777311323083863`*^9, 
   3.8777312290578012`*^9}, 3.8777313802517896`*^9, {3.8783348523145423`*^9, 
   3.8783348627645416`*^9}, {3.878334928188939*^9, 3.8783349287535152`*^9}, {
   3.891567294308199*^9, 3.891567296186884*^9}, {3.9010678264259653`*^9, 
   3.9010683121879616`*^9}, {3.9013160799775105`*^9, 
   3.9013160805375104`*^9}, {3.9013161128035183`*^9, 3.901316222213457*^9}, {
   3.901316286414688*^9, 3.9013162997552176`*^9}, {3.9013163870960755`*^9, 
   3.9013163870960755`*^9}, {3.9013164237506757`*^9, 
   3.9013164891789417`*^9}, {3.9013165261883545`*^9, 
   3.9013166271632195`*^9}, {3.9013166646616488`*^9, 
   3.9013168826392727`*^9}, {3.901316950353601*^9, 3.90131698103749*^9}, {
   3.9013170798804197`*^9, 3.9013170805828485`*^9}, 3.901317280424265*^9, {
   3.9013173616828966`*^9, 3.9013173624829836`*^9}, {3.9013174067527356`*^9, 
   3.9013174069927235`*^9}, {3.901317471652051*^9, 3.9013174912884693`*^9}, {
   3.9013175483524*^9, 3.9013175963312707`*^9}, {3.9013176351728487`*^9, 
   3.9013176487970276`*^9}, {3.9013176901108475`*^9, 3.901317704907734*^9}, {
   3.9013178083387194`*^9, 3.901317829204553*^9}, {3.9013179861720276`*^9, 
   3.901317996966996*^9}, {3.9013180474526377`*^9, 3.901318063248122*^9}, {
   3.9013181084526424`*^9, 3.90131823304389*^9}, {3.9013183679031715`*^9, 
   3.901318369359398*^9}, {3.9013184321937704`*^9, 3.9013187095593753`*^9}, {
   3.901318768290186*^9, 3.9013187773769712`*^9}, {3.9013188852248583`*^9, 
   3.9013188976795917`*^9}, {3.901318963425865*^9, 3.901319007021507*^9}, {
   3.901319096884777*^9, 3.901319122695861*^9}, 3.9013192893738804`*^9, {
   3.901319815005362*^9, 3.90132004257382*^9}, {3.901320083714896*^9, 
   3.901320193056365*^9}, {3.901320346878107*^9, 3.901320400778838*^9}, {
   3.9013224025700884`*^9, 3.901322460082205*^9}, {3.9013225096145134`*^9, 
   3.9013225833551617`*^9}, {3.9013228520939016`*^9, 3.901322883891926*^9}, {
   3.901322991218295*^9, 3.901322991697433*^9}, {3.901323027113106*^9, 
   3.9013230281676865`*^9}, {3.9013438808856564`*^9, 3.901343941942596*^9}, {
   3.901577132853902*^9, 3.9015775973938217`*^9}, {3.9018513345866666`*^9, 
   3.901851437227172*^9}, {3.9018514699319754`*^9, 3.9018515106376815`*^9}, {
   3.901851561791366*^9, 3.901851813428033*^9}, {3.901851846267559*^9, 
   3.9018519351895723`*^9}, {3.9018519655698605`*^9, 3.90185210344059*^9}, 
   3.90185213377277*^9, {3.9018521682588797`*^9, 3.9018521782890477`*^9}, {
   3.9018523211919374`*^9, 3.901852341245458*^9}, 3.901852412838372*^9, {
   3.901852672118957*^9, 3.901852777352396*^9}, {3.902550848224428*^9, 
   3.9025509249803724`*^9}, {3.9025510497267847`*^9, 
   3.9025510499167876`*^9}, {3.9025515878802752`*^9, 
   3.9025516165695434`*^9}, {3.902551649160528*^9, 3.902551746523497*^9}, {
   3.902551810111808*^9, 3.902551866600944*^9}, {3.9025521309950514`*^9, 
   3.902552155560045*^9}, {3.902552231826227*^9, 3.902552235272232*^9}, {
   3.9025522733823547`*^9, 3.902552335050336*^9}, {3.902972767718835*^9, 
   3.9029728644789505`*^9}, {3.902972935109724*^9, 3.90297307592826*^9}, {
   3.902973224051712*^9, 3.9029732696624722`*^9}, {3.9029739117297153`*^9, 
   3.9029739498426423`*^9}, {3.9029741959308863`*^9, 3.90297430145007*^9}},
 AspectRatioFixed->True,
 Background->RGBColor[1, 0.85, 0.85],
 CellLabel->
  "In[1055]:=",ExpressionUUID->"c55f66be-e2ff-4d35-b2a5-2eb6f91ef814"]
}, Closed]],

Cell[CellGroupData[{

Cell["Create Geometry", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.3999127557963753`*^9, 3.3999127565620003`*^9}, 
   3.8535413593909225`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"41b9a76f-0607-4676-9b4f-a188723677db"],

Cell[TextData[{
 StyleBox["The following instructions build an undulator with NdFeB magnets \
and poles  made with the material previously defined. One could also use a \
Radia predefined steel by replacing \"",
  Evaluatable->False,
  AspectRatioFixed->True],
 "mp=",
 StyleBox["radMatSatIso",
  FontColor->RGBColor[1, 0, 0]],
 "[ma]",
 StyleBox["\" with \"mp=",
  Evaluatable->False,
  AspectRatioFixed->True],
 "RadMatAFK502[]",
 StyleBox["\" or \"m=",
  Evaluatable->False,
  AspectRatioFixed->True],
 "RadMatXc06[]",
 StyleBox["\" or \"m=",
  Evaluatable->False,
  AspectRatioFixed->True],
 "RadMatSteel42",
 StyleBox["[]\". See the section \"How to get Help\" later on to obtain the \
full specification of any of the material predefined in Radia .  ",
  Evaluatable->False,
  AspectRatioFixed->True]
}], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8513935804253044`*^9, 3.851393596755192*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"5e0d4460-f976-471c-bfde-5c529251cdb7"],

Cell[TextData[{
 StyleBox["radUtiDelAll",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nheaders={\"ME/eV\", \"\"};\n\n(* General Parameters: gap, # of \
periods, unit length, offset (not used), and ending suppresion on:0/off:1 *)\n\
gap=15;NumPer=2;per=230;gapoffset=0;ending=1;zer={0,0,0};subDiv=2;\n\n(* \
Spacing Parameters for exploded view *)\nsp={0,0,gap/2};\n\n(* Magnet \
Parameters *)\nlm={79,100,79};nm={subDiv,subDiv};cm={0,1,1};\n\n(* Pole \
Parameters, lengths in x,y,z, # of subdivision, color, and chamfer *)\n\
lp={79,(per-lm[[2]]*2)/2,61};np={subDiv,subDiv};cp={1,0,1};chp={10,0,10};\n\n\
(* chambers: chmp for pole, chmk for keeper *)\n\
chmp={chp[[1]],chp[[2]]};chmk=chp[[1]];\n\n(* End Pole Parameters *)\n\
lep={lp[[1]],lp[[2]]-5.5,lp[[3]]};\n\n(* Ending gaps: gap to end pole, gap to \
end mag *)\ndpm={0,0};\n\n(* Define Pole Material *)\nmp=",
 StyleBox["RadMatAFK502",
  FontColor->RGBColor[1, 0, 0]],
 "[];\n(*mp=",
 StyleBox["radMatSatIso",
  FontColor->RGBColor[1, 0, 0]],
 "[ma];*)\n\n(* Define NdFeB with 1.2 Tesla Remanent Magnetization *)\n(*mm=",
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 "[1.29];*)\nmt=1.2;\n\n(* Define magnetization errors, if sd=1, sdr: \
standard deviation (SD) in mt (%/100), sdt: SD in theta (degrees) *)\nsd=0;\n\
sdr=0.0001;\nsdt=0.0001;\n(* Define mechanical errors, if sd=1, sdsx=: SD \
(mm) in x axis, sdsy=: SD sep2 in (%/100) in y axis, sdsz=: SD half gap in \
(%/100) in z axis *)\nsdsx=0.001;\nsdsy=0.001;\nsdsz=0.001;\n\n(* Define \
function to assign segmentation, color, material *)\nfullMag[u_,x_,y_,z_]:=(",
 StyleBox["radObjDivMag",
  FontColor->RGBColor[1, 0, 0]],
 "[u,x];",
 StyleBox["radObjDrwAtr",
  FontColor->RGBColor[1, 0, 0]],
 "[u,y];",
 StyleBox["radMatApl",
  FontColor->RGBColor[1, 0, 0]],
 "[u,z]);\n\n(* Build the Structure *)\nund=wig[];\n\n\
strGap=IntegerString[gap,10,3];\nstrPoles=IntegerString[numPoles,10,2];\n\
strPer=IntegerString[per,10,3];\nstrSub=IntegerString[subDiv];\nPrint[\"Total \
length (\",numPoles,\" poles): \",totallength,\" mm, Gap: \",strGap,\" mm, \
Period: \",strPer,\" mm, Subdivision: \",strSub,\"\"]"
}], "Input",
 CellChangeTimes->{{3.8495692848909044`*^9, 3.849569336752112*^9}, 
   3.8495693920961084`*^9, {3.849570158055762*^9, 3.8495703000384903`*^9}, {
   3.849570372951692*^9, 3.8495703988626437`*^9}, {3.849575778774073*^9, 
   3.8495757788673058`*^9}, {3.8495766702841578`*^9, 3.849576680086192*^9}, {
   3.8495768230289803`*^9, 3.8495768327573757`*^9}, {3.84957690404572*^9, 
   3.849576958588648*^9}, {3.8495770422160616`*^9, 3.8495770435256042`*^9}, {
   3.84957737147299*^9, 3.849577381335451*^9}, 3.8495774146560516`*^9, {
   3.8495780525607934`*^9, 3.849578065378665*^9}, {3.849578099416645*^9, 
   3.849578107873892*^9}, {3.849578168782466*^9, 3.849578169299701*^9}, {
   3.8496500276086655`*^9, 3.849650110608214*^9}, {3.849650415393181*^9, 
   3.849650439713094*^9}, {3.8496505499439507`*^9, 3.84965059343355*^9}, {
   3.849651505460634*^9, 3.8496515094006414`*^9}, {3.8496516144490395`*^9, 
   3.8496516150590396`*^9}, {3.8496540321387825`*^9, 3.849654032788781*^9}, {
   3.8496541234826956`*^9, 3.8496541246026955`*^9}, {3.849654158292637*^9, 
   3.8496541811111484`*^9}, {3.8496588380218706`*^9, 3.849658870611829*^9}, {
   3.8496600692970963`*^9, 3.8496600759571037`*^9}, {3.849660247099047*^9, 
   3.8496602562790403`*^9}, 3.849660344108995*^9, {3.8496614569198008`*^9, 
   3.8496614906112375`*^9}, {3.849753056980522*^9, 3.8497530622841077`*^9}, {
   3.849761782410742*^9, 3.849761924334885*^9}, {3.8497621157985525`*^9, 
   3.849762152258139*^9}, 3.8497625788173227`*^9, {3.850362367350247*^9, 
   3.8503623920640783`*^9}, {3.8503625936266017`*^9, 
   3.8503626095242615`*^9}, {3.850362683559995*^9, 3.850362688669467*^9}, {
   3.850363138406599*^9, 3.850363154544655*^9}, {3.8503631916733685`*^9, 
   3.850363195469898*^9}, {3.8503634236267133`*^9, 3.850363429467437*^9}, 
   3.8503634702818503`*^9, {3.850363523062216*^9, 3.850363523578534*^9}, {
   3.8503636890510206`*^9, 3.8503636956032314`*^9}, {3.850364181288765*^9, 
   3.850364181476429*^9}, {3.8503646856669655`*^9, 3.850364689875766*^9}, {
   3.8503648353898892`*^9, 3.850364842039752*^9}, 3.8503652848064833`*^9, 
   3.8503653468962994`*^9, 3.8503654043359585`*^9, 3.8503654581685476`*^9, {
   3.850365556919186*^9, 3.8503655575748777`*^9}, 3.850365660327491*^9, {
   3.8503658116925545`*^9, 3.8503658120650525`*^9}, 3.8503660427306604`*^9, 
   3.8503661979945765`*^9, {3.8503666013516135`*^9, 3.8503666015394783`*^9}, 
   3.8503667170917134`*^9, 3.8503668433438826`*^9, 3.85036696409534*^9, 
   3.850367113803413*^9, {3.8503672199669724`*^9, 3.850367220150963*^9}, {
   3.850425553867792*^9, 3.850425576836104*^9}, {3.8504256284113626`*^9, 
   3.850425648541767*^9}, {3.8504257301192913`*^9, 3.8504257485175104`*^9}, {
   3.8504258047764344`*^9, 3.8504258244629374`*^9}, 3.850425898206072*^9, {
   3.850426007211625*^9, 3.8504260085296154`*^9}, {3.850426469882306*^9, 
   3.8504264825763807`*^9}, {3.850426705166568*^9, 3.850426739924523*^9}, {
   3.8504268204201403`*^9, 3.8504268239949102`*^9}, 3.8504268852079835`*^9, {
   3.8504272414888334`*^9, 3.8504272428949375`*^9}, 3.850427599081679*^9, {
   3.8504277218442917`*^9, 3.8504277225488467`*^9}, {3.8504513066007776`*^9, 
   3.850451315749297*^9}, {3.8504514082860956`*^9, 3.850451408381217*^9}, {
   3.850451514378485*^9, 3.8504515218444176`*^9}, {3.8504515851531115`*^9, 
   3.8504515980144663`*^9}, {3.8504516942208376`*^9, 3.850451730716586*^9}, {
   3.850452019357902*^9, 3.850452025039811*^9}, {3.8504530937143393`*^9, 
   3.850453102008336*^9}, 3.8504531906340127`*^9, {3.8504533153725767`*^9, 
   3.8504533210428843`*^9}, {3.850453404871477*^9, 3.850453410435543*^9}, 
   3.850453625739596*^9, 3.8504539891133165`*^9, {3.8504540591861324`*^9, 
   3.8504540630279026`*^9}, {3.8505364330713835`*^9, 
   3.8505364344826407`*^9}, {3.8505365190936346`*^9, 
   3.8505365207736206`*^9}, {3.8505366152067165`*^9, 
   3.8505366173635783`*^9}, {3.850536876159954*^9, 3.8505368774718957`*^9}, {
   3.8510488421966686`*^9, 3.851048843491663*^9}, {3.851049586100518*^9, 
   3.851049587889352*^9}, {3.8510871421676283`*^9, 3.851087142278759*^9}, {
   3.8511235985408697`*^9, 3.8511235987869263`*^9}, {3.85112587561395*^9, 
   3.8511258764051967`*^9}, {3.8511276386778374`*^9, 
   3.8511276390253725`*^9}, {3.85112988397759*^9, 3.8511298844901314`*^9}, {
   3.8511367700868177`*^9, 3.8511367706093016`*^9}, 3.85113807045614*^9, {
   3.851142743682721*^9, 3.8511427438692875`*^9}, {3.8511439175339055`*^9, 
   3.8511439180137987`*^9}, 3.8511451759181767`*^9, {3.8511453017382345`*^9, 
   3.8511453023968525`*^9}, {3.851145921364147*^9, 3.8511459319114723`*^9}, {
   3.851146040852874*^9, 3.851146040865836*^9}, {3.851146160081445*^9, 
   3.8511461606465135`*^9}, 3.8511463941905026`*^9, {3.851461379591907*^9, 
   3.8514613963733387`*^9}, {3.851461905728488*^9, 3.8514619441626244`*^9}, {
   3.8514619913033524`*^9, 3.851462063936046*^9}, {3.8514657422752295`*^9, 
   3.8514657439588614`*^9}, {3.8514658000365067`*^9, 3.851465802420993*^9}, {
   3.851465906273092*^9, 3.8514659086706533`*^9}, {3.851739749270759*^9, 
   3.8517397514791484`*^9}, 3.8517397820065966`*^9, 3.8517398164524703`*^9, {
   3.851745433611781*^9, 3.851745444147046*^9}, {3.8517455142483916`*^9, 
   3.851745518904194*^9}, {3.851745574933626*^9, 3.851745600632904*^9}, {
   3.851746628543537*^9, 3.851746628681171*^9}, 3.8517467194914446`*^9, 
   3.8517468810213065`*^9, {3.8517474043454227`*^9, 3.8517474074714766`*^9}, 
   3.8517474540222683`*^9, {3.8517476196253166`*^9, 3.8517476269918647`*^9}, {
   3.851747709966254*^9, 3.851747716464946*^9}, {3.8517478459410796`*^9, 
   3.8517478538322725`*^9}, {3.8517526452432575`*^9, 
   3.8517526456576586`*^9}, {3.851752781948519*^9, 3.851752782381775*^9}, {
   3.8520020144938*^9, 3.8520020152537556`*^9}, {3.8520026065281396`*^9, 
   3.852002639483098*^9}, {3.852002763358762*^9, 3.852002791884385*^9}, {
   3.852002872626895*^9, 3.852002892591587*^9}, 3.8534574415274677`*^9, {
   3.853457554225955*^9, 3.8534575543219604`*^9}, {3.8534575943022118`*^9, 
   3.8534575947712803`*^9}, 3.853457637925359*^9, {3.8534576965557065`*^9, 
   3.853457752997728*^9}, {3.853457795303581*^9, 3.853457795727581*^9}, {
   3.853457866001114*^9, 3.8534578667111444`*^9}, {3.853457962003894*^9, 
   3.8534579624273252`*^9}, {3.8534580216772795`*^9, 
   3.8534580220986395`*^9}, {3.8534581100611353`*^9, 3.853458110437186*^9}, {
   3.8534581598645267`*^9, 3.8534581602345347`*^9}, {3.853458213669674*^9, 
   3.8534582143769827`*^9}, {3.853458282604947*^9, 3.853458283026949*^9}, {
   3.8534583321348724`*^9, 3.853458333342902*^9}, {3.853459258798091*^9, 
   3.8534592600691576`*^9}, 3.8534593575593266`*^9, 3.8534594318921795`*^9, {
   3.853459478540307*^9, 3.85345947868386*^9}, {3.8534595342238708`*^9, 
   3.8534595346010885`*^9}, {3.85345957805418*^9, 3.853459578148138*^9}, {
   3.8534596206098022`*^9, 3.853459620799788*^9}, {3.853459658995768*^9, 
   3.8534596590886955`*^9}, 3.8534597023402777`*^9, 3.853459740297572*^9, 
   3.853459779540642*^9, 3.8534598217822504`*^9, {3.85345986415158*^9, 
   3.8534598642913713`*^9}, 3.8534599030909495`*^9, {3.853459945024268*^9, 
   3.8534599451622705`*^9}, {3.853540850333124*^9, 3.853540872264576*^9}, 
   3.853540902359868*^9, {3.8535410353834476`*^9, 3.853541035623848*^9}, {
   3.853542071209032*^9, 3.85354207197538*^9}, {3.8535421914509296`*^9, 
   3.853542201056244*^9}, {3.8535423123497763`*^9, 3.853542334603934*^9}, {
   3.8535423740788813`*^9, 3.8535423991490464`*^9}, {3.8535425947626657`*^9, 
   3.8535426770428963`*^9}, 3.853542771642192*^9, {3.8535430457880116`*^9, 
   3.853543095171542*^9}, {3.8535431275495586`*^9, 3.853543164375802*^9}, {
   3.8535442338694105`*^9, 3.85354423433941*^9}, {3.8535443163113623`*^9, 
   3.8535443169413614`*^9}, {3.853544403701349*^9, 3.8535444041213493`*^9}, 
   3.8535543099649467`*^9, {3.8538887672522497`*^9, 3.8538887673940964`*^9}, {
   3.854344441412094*^9, 3.8543444661308093`*^9}, {3.854346544467913*^9, 
   3.854346554125417*^9}, {3.854346619032477*^9, 3.854346729643385*^9}, {
   3.854346761186941*^9, 3.85434685075185*^9}, {3.854346899232811*^9, 
   3.854346939081559*^9}, {3.8543469716189175`*^9, 3.854346997091382*^9}, {
   3.8544279745146794`*^9, 3.854428063062183*^9}, {3.8544281112206388`*^9, 
   3.8544281143918457`*^9}, {3.8544281559418707`*^9, 
   3.8544281627758684`*^9}, {3.854428328496714*^9, 3.854428334644313*^9}, 
   3.8544284865566473`*^9, {3.8544285774861965`*^9, 3.854428601078596*^9}, {
   3.8544292577767067`*^9, 3.854429261775771*^9}, {3.854429323144385*^9, 
   3.8544293232343254`*^9}, 3.854490583454543*^9, 3.8547592879728785`*^9, {
   3.8547593453973556`*^9, 3.854759370988138*^9}, {3.8547594279060373`*^9, 
   3.854759443402356*^9}, {3.8547595829469233`*^9, 3.8547596014317436`*^9}, {
   3.854759638726978*^9, 3.8547596399168406`*^9}, 3.854759694846144*^9, {
   3.854759955862186*^9, 3.8547599601701474`*^9}, {3.8547602031773186`*^9, 
   3.8547602325005074`*^9}, {3.854762074577223*^9, 3.8547620776212163`*^9}, {
   3.8547622074946623`*^9, 3.8547622121786494`*^9}, {3.8547623073099356`*^9, 
   3.85476230993301*^9}, {3.855623925695157*^9, 3.855623939611549*^9}, {
   3.855624004184059*^9, 3.855624005729573*^9}, {3.855624044928923*^9, 
   3.855624046195738*^9}, {3.8556241231908007`*^9, 3.8556243018071995`*^9}, {
   3.855624357136744*^9, 3.8556244227066803`*^9}, {3.8556244681393547`*^9, 
   3.8556244793302293`*^9}, {3.855624525300475*^9, 3.855624526238421*^9}, 
   3.872803039410325*^9, 3.872803073886324*^9, {3.872803224870792*^9, 
   3.872803233895694*^9}, {3.8728032857217293`*^9, 3.872803285959813*^9}, {
   3.872803367975639*^9, 3.8728033681636677`*^9}, {3.872803404247867*^9, 
   3.8728035680684104`*^9}, {3.8729087316378517`*^9, 
   3.8729087401040945`*^9}, {3.8729088274772687`*^9, 3.872908827697934*^9}, 
   3.8729089215159817`*^9, 3.8729089579228687`*^9, 3.872908998672201*^9, 
   3.872909099720125*^9, 3.8729091535821214`*^9, {3.8729091931121283`*^9, 
   3.872909220380149*^9}, {3.8729093278233347`*^9, 3.872909383290944*^9}, 
   3.8729094144982038`*^9, 3.872909622056717*^9, 3.872911536775921*^9, {
   3.872911568788245*^9, 3.872911595568243*^9}, {3.8729116289445267`*^9, 
   3.872911756266997*^9}, {3.8737731953127193`*^9, 3.873773195502719*^9}, {
   3.8737734195984488`*^9, 3.873773423538967*^9}, 3.8737743472024045`*^9, {
   3.8738356108999033`*^9, 3.8738356531150455`*^9}, 3.8738359018189583`*^9, {
   3.8738379401551237`*^9, 3.873837962062958*^9}, {3.873838227361147*^9, 
   3.8738382305011435`*^9}, {3.8738400569192133`*^9, 3.873840057199222*^9}, 
   3.873840271250455*^9, 3.87384470856783*^9, 3.8738475103928924`*^9, {
   3.873864388180604*^9, 3.873864393999298*^9}, 3.874028075907876*^9, {
   3.874028470606369*^9, 3.874028479892212*^9}, 3.874029627207472*^9, 
   3.874031681700382*^9, {3.874373254160679*^9, 3.87437325869284*^9}, 
   3.874379323632713*^9, {3.874381653106589*^9, 3.8743816577927575`*^9}, 
   3.8743817161647763`*^9, {3.874381916425956*^9, 3.874381919699418*^9}, {
   3.8745338351125765`*^9, 3.874533845459112*^9}, 3.874534126872942*^9, {
   3.8745341625311766`*^9, 3.8745343695234365`*^9}, {3.8745457320987606`*^9, 
   3.8745457320987606`*^9}, {3.8745457710452614`*^9, 3.874545789231279*^9}, {
   3.8745458278707504`*^9, 3.8745458278707504`*^9}, {3.8745458638773203`*^9, 
   3.8745458638773203`*^9}, {3.8745459210829096`*^9, 
   3.8745460547152157`*^9}, {3.874548386023799*^9, 3.874548386203787*^9}, {
   3.8752359805136256`*^9, 3.875236010445729*^9}, 3.875236891116954*^9, {
   3.8752458604306865`*^9, 3.8752458628259554`*^9}, 3.8753088499548907`*^9, {
   3.875308912791568*^9, 3.8753089199167905`*^9}, {3.8753090496997643`*^9, 
   3.8753091553477116`*^9}, 3.8753092082189426`*^9, {3.8753092724149523`*^9, 
   3.875309286684945*^9}, {3.8753093496289988`*^9, 3.8753095841648283`*^9}, {
   3.87530963771126*^9, 3.875309699753315*^9}, {3.875318198184411*^9, 
   3.875318202407407*^9}, {3.8753189412515073`*^9, 3.875318942210881*^9}, 
   3.875319492255845*^9, {3.875323497442088*^9, 3.875323534849775*^9}, {
   3.8756603241821957`*^9, 3.875660324411327*^9}, {3.875838832092026*^9, 
   3.8758388612669497`*^9}, 3.8758389661877904`*^9, {3.8758390020270743`*^9, 
   3.875839120228228*^9}, {3.8758399479906363`*^9, 3.8758400892032757`*^9}, {
   3.876373162154467*^9, 3.8763731622444715`*^9}, 3.876879065181177*^9, 
   3.8774812650944605`*^9, 3.8774814143180017`*^9, 3.8774864247948713`*^9, {
   3.8774896830708895`*^9, 3.877489752647135*^9}, {3.8774933810640078`*^9, 
   3.877493414747617*^9}, 3.877493602123341*^9, {3.8774938370961456`*^9, 
   3.8774938984960637`*^9}, {3.8774940036301785`*^9, 3.8774940981835756`*^9}, 
   3.8774946281621532`*^9, {3.877495896269828*^9, 3.877495923344471*^9}, 
   3.8774960129315996`*^9, 3.877496081067107*^9, {3.8774961129321995`*^9, 
   3.8774961292877254`*^9}, {3.8774964099647756`*^9, 3.877496442080826*^9}, {
   3.877559662240378*^9, 3.8775596886846657`*^9}, 3.8775608427652545`*^9, 
   3.8775610230191693`*^9, 3.8775611062511787`*^9, {3.87756127360786*^9, 
   3.877561276096552*^9}, {3.8775613537711115`*^9, 3.8775613889291368`*^9}, {
   3.8775619548410892`*^9, 3.8775619865758076`*^9}, 3.877562442634797*^9, {
   3.877562746724955*^9, 3.8775627807454753`*^9}, 3.8775718917574587`*^9, 
   3.877572754993413*^9, {3.8775739059792237`*^9, 3.8775739091292257`*^9}, {
   3.877574201141542*^9, 3.877574203771556*^9}, {3.877574593714258*^9, 
   3.8775746092366743`*^9}, {3.8775746638247585`*^9, 3.877574704022271*^9}, {
   3.8775751600674276`*^9, 3.8775751654304223`*^9}, {3.8775752870914893`*^9, 
   3.8775753031151586`*^9}, 3.8775753448055058`*^9, 3.8776401377487307`*^9, {
   3.87764024606874*^9, 3.8776402858567486`*^9}, {3.8776403230847406`*^9, 
   3.877640324888754*^9}, {3.877640372886735*^9, 3.8776403772107477`*^9}, {
   3.877640471498581*^9, 3.877640473189026*^9}, {3.8776425351710453`*^9, 
   3.877642537840942*^9}, {3.8776491295204897`*^9, 3.8776491310249233`*^9}, {
   3.8776501802835474`*^9, 3.877650182448927*^9}, {3.8776503382850494`*^9, 
   3.877650346312679*^9}, {3.877651261490844*^9, 3.8776512645867157`*^9}, {
   3.877651307290355*^9, 3.877651383411155*^9}, {3.8776514572957296`*^9, 
   3.877651485830006*^9}, {3.8776515313338428`*^9, 3.87765156569413*^9}, 
   3.877651817941514*^9, {3.877651916996088*^9, 3.8776519305678263`*^9}, 
   3.8776525108331966`*^9, 3.8776525423600645`*^9, {3.877652617215971*^9, 
   3.8776526244026937`*^9}, {3.8776526699406652`*^9, 
   3.8776526723471575`*^9}, {3.877652771682083*^9, 3.8776527887712774`*^9}, {
   3.877654388304987*^9, 3.8776544007680435`*^9}, 3.87765479751071*^9, {
   3.8776548419388504`*^9, 3.877654857101314*^9}, {3.877656179169942*^9, 
   3.877656283402264*^9}, {3.87765716794479*^9, 3.877657186736212*^9}, {
   3.8776574407901278`*^9, 3.8776574470295897`*^9}, 3.877657482950952*^9, {
   3.877657535954553*^9, 3.8776576144908237`*^9}, {3.8776576463733625`*^9, 
   3.8776578067386*^9}, {3.8776589010762415`*^9, 3.8776589135665617`*^9}, {
   3.8776589887807193`*^9, 3.877658992058668*^9}, {3.8776592582978177`*^9, 
   3.8776592611564083`*^9}, {3.87765930982822*^9, 3.8776593116383204`*^9}, {
   3.8776593552045007`*^9, 3.877659356380992*^9}, {3.8776594361268535`*^9, 
   3.877659439174697*^9}, {3.877659814176915*^9, 3.877659816103275*^9}, 
   3.8776599275863304`*^9, {3.877660047952911*^9, 3.8776600583314905`*^9}, {
   3.8776601462551455`*^9, 3.877660181082074*^9}, {3.8776602187786326`*^9, 
   3.8776603036150017`*^9}, 3.8777280414902925`*^9, {3.8777281468205166`*^9, 
   3.8777282530183473`*^9}, {3.877728300074669*^9, 3.877728303402863*^9}, {
   3.877728688981154*^9, 3.877728689591109*^9}, 3.87772879641529*^9, 
   3.877728901382416*^9, {3.877729774148199*^9, 3.877729774398198*^9}, 
   3.8777298123361425`*^9, {3.877729980085121*^9, 3.8777299900933237`*^9}, {
   3.8777300403257227`*^9, 3.877730040525648*^9}, {3.877730086559145*^9, 
   3.8777300866991496`*^9}, {3.8777301170303664`*^9, 
   3.8777301339680367`*^9}, {3.8777314094577117`*^9, 3.877731508096629*^9}, {
   3.877748459610208*^9, 3.8777484848456864`*^9}, {3.8777486078954744`*^9, 
   3.8777486108004675`*^9}, {3.877748674952114*^9, 3.8777486815310097`*^9}, {
   3.877749182992494*^9, 3.877749186022504*^9}, {3.8781008218598757`*^9, 
   3.8781008489216413`*^9}, {3.878100987157476*^9, 3.8781009872519565`*^9}, {
   3.878101049649153*^9, 3.8781010516018925`*^9}, {3.8781010921435738`*^9, 
   3.8781011020079603`*^9}, {3.8781585034227715`*^9, 3.878158520990139*^9}, {
   3.878176308025534*^9, 3.8781763245711775`*^9}, {3.8781818173120513`*^9, 
   3.8781818174094524`*^9}, 3.8781818784402313`*^9, {3.8781819743166237`*^9, 
   3.878181998958469*^9}, {3.878182574158377*^9, 3.878182609658843*^9}, 
   3.878183022205157*^9, 3.8783320430622063`*^9, 3.8783339801157613`*^9, {
   3.878334041994953*^9, 3.8783340420888634`*^9}, {3.8783343647322464`*^9, 
   3.87833437144643*^9}, 3.878334424313924*^9, 3.878334540607183*^9, 
   3.87833476636837*^9, 3.8783348890945177`*^9, 3.878349087075159*^9, {
   3.8783495778455086`*^9, 3.878349611839255*^9}, 3.8783496956732244`*^9, {
   3.878350159406897*^9, 3.8783501724169245`*^9}, 3.878350206943524*^9, {
   3.878350299453698*^9, 3.878350455876399*^9}, {3.8783505006951838`*^9, 
   3.878350529582121*^9}, 3.878350567159193*^9, {3.8783521870359097`*^9, 
   3.878352208230546*^9}, 3.878352240536767*^9, 3.8783524885041513`*^9, {
   3.8783526258142858`*^9, 3.878352654204198*^9}, {3.8783530095842485`*^9, 
   3.8783530619037704`*^9}, {3.8783530929711876`*^9, 3.878353093441174*^9}, 
   3.878353142565165*^9, {3.8783531950548964`*^9, 3.8783532514961634`*^9}, {
   3.8783532823623314`*^9, 3.8783532824800396`*^9}, {3.8783573551059303`*^9, 
   3.8783573620192585`*^9}, {3.87835739389367*^9, 3.878357477975649*^9}, 
   3.8783582990569506`*^9, {3.8783584066490884`*^9, 3.8783584068390894`*^9}, {
   3.878358567893072*^9, 3.8783585680330715`*^9}, {3.8783587453289843`*^9, 
   3.878358745612913*^9}, {3.8783590232493935`*^9, 3.878359073671195*^9}, 
   3.8783591740258455`*^9, {3.8783592539180593`*^9, 3.8783592651353817`*^9}, {
   3.8783593599554453`*^9, 3.878359439612933*^9}, {3.878683678597335*^9, 
   3.878683763033128*^9}, 3.8786838429428525`*^9, {3.878684909296607*^9, 
   3.8786849184572287`*^9}, {3.878685411466361*^9, 3.878685430915032*^9}, 
   3.8786858775398974`*^9, {3.8786859742940607`*^9, 3.8786859956642437`*^9}, {
   3.878686272716417*^9, 3.878686309797511*^9}, {3.878686478406606*^9, 
   3.8786864949046*^9}, {3.878686530954632*^9, 3.8786865538335295`*^9}, {
   3.878686607857436*^9, 3.878686626436721*^9}, 3.878686780274798*^9, 
   3.87868682548882*^9, {3.87868688610703*^9, 3.8786869159472303`*^9}, {
   3.8786869513529034`*^9, 3.8786869965788918`*^9}, {3.8786870394395704`*^9, 
   3.878687062394933*^9}, {3.878687426407011*^9, 3.8786874355629063`*^9}, {
   3.8786874683803306`*^9, 3.878687578009221*^9}, {3.878687647709017*^9, 
   3.8786876587006273`*^9}, {3.8793844078926706`*^9, 3.879384408032672*^9}, {
   3.879384457786971*^9, 3.879384484620984*^9}, {3.879384516253018*^9, 
   3.879384580031065*^9}, {3.8793846659617877`*^9, 3.8793847054891443`*^9}, {
   3.879384754245191*^9, 3.879384758194739*^9}, {3.8793849722458477`*^9, 
   3.8793849726698422`*^9}, 3.8793851455568056`*^9, 3.879385231741827*^9, 
   3.8793852707468233`*^9, 3.879385413201342*^9, {3.879385453834882*^9, 
   3.8793854543052225`*^9}, {3.879385882759013*^9, 3.8793859140828896`*^9}, {
   3.879385954763216*^9, 3.8793859790059233`*^9}, {3.879554727624734*^9, 
   3.879554760539328*^9}, {3.8795548053585815`*^9, 3.879554805598578*^9}, 
   3.879554926857295*^9, 3.8795553854914293`*^9, 3.8795554595419803`*^9, {
   3.8795555683304214`*^9, 3.879555647781222*^9}, {3.879560859889954*^9, 
   3.8795609645053997`*^9}, {3.879561255592885*^9, 3.8795612556928854`*^9}, {
   3.8795613541093035`*^9, 3.8795614917473335`*^9}, {3.879561572496446*^9, 
   3.879561706858354*^9}, {3.879563359876175*^9, 3.879563359966175*^9}, {
   3.8795640557486753`*^9, 3.8795640654585204`*^9}, {3.8795641403617277`*^9, 
   3.8795642998550396`*^9}, {3.879892558505455*^9, 3.8798926003427153`*^9}, {
   3.8798934723714657`*^9, 3.879893478959428*^9}, 3.879902055486308*^9, {
   3.879902205048876*^9, 3.879902205240875*^9}, 3.8799022817765923`*^9, 
   3.8799023752093177`*^9, {3.879902532914273*^9, 3.8799025331391006`*^9}, 
   3.879902655323655*^9, {3.879902859561741*^9, 3.87990285980059*^9}, 
   3.8799029379393797`*^9, {3.879903122485475*^9, 3.8799031227254477`*^9}, {
   3.8799719521389823`*^9, 3.879971952234315*^9}, 3.8799728091933756`*^9, {
   3.8799731413085337`*^9, 3.8799731415438447`*^9}, 3.879973521794812*^9, {
   3.879973857524397*^9, 3.879973857712391*^9}, 3.8799741870916367`*^9, {
   3.8799748041189938`*^9, 3.879974804256778*^9}, 3.879975456951331*^9, {
   3.879976855253078*^9, 3.8799768558690786`*^9}, 3.8799771899770155`*^9, {
   3.898558363130851*^9, 3.8985583632263737`*^9}, 3.8985585261149373`*^9, {
   3.8985586026749425`*^9, 3.8985586027688885`*^9}, 3.898558664829451*^9, {
   3.8985587022592344`*^9, 3.898558731828725*^9}, {3.898558763077279*^9, 
   3.8985587631272683`*^9}, 3.8985599348486743`*^9, {3.8985601539198036`*^9, 
   3.8985601545446515`*^9}, 3.898561160222675*^9, 3.898561304004128*^9, 
   3.8985639849036064`*^9, {3.8985642666318955`*^9, 3.8985642955321093`*^9}, {
   3.8985650023548527`*^9, 3.8985650026397657`*^9}, 3.8985662608873043`*^9, {
   3.8985668949634547`*^9, 3.8985668950587454`*^9}, 3.8985674986969595`*^9, {
   3.89856808644551*^9, 3.898568086541604*^9}, 3.89856866044983*^9, {
   3.8985693693728266`*^9, 3.898569369611244*^9}, 3.8985701750769176`*^9, {
   3.8985707237121487`*^9, 3.8985707238081656`*^9}, {3.8985727220686493`*^9, 
   3.898572722162656*^9}, {3.898573412913236*^9, 3.8985734137652106`*^9}, 
   3.8985739669931073`*^9, 3.9010650825123844`*^9, 3.9010651274400935`*^9, {
   3.901065400929707*^9, 3.9010654382679315`*^9}, {3.9010654685103674`*^9, 
   3.901065502251815*^9}, {3.9010657323419647`*^9, 3.9010658991081076`*^9}, {
   3.9010660366301723`*^9, 3.9010660806773834`*^9}, 3.9010661574282527`*^9, 
   3.9010662555843043`*^9, {3.901067544424074*^9, 3.9010675894866323`*^9}, {
   3.9010677263273764`*^9, 3.901067741791246*^9}, {3.9010683439503965`*^9, 
   3.90106835496554*^9}, {3.901068445018076*^9, 3.9010684806547527`*^9}, {
   3.9011557402229595`*^9, 3.901155765897022*^9}, {3.9011568509300814`*^9, 
   3.9011568716281004`*^9}, {3.9011579415569696`*^9, 3.901157993320524*^9}, {
   3.9011588704604893`*^9, 3.9011588722164893`*^9}, {3.901159102387165*^9, 
   3.9011591074659004`*^9}, {3.901159152651245*^9, 3.901159235422524*^9}, {
   3.9011593018085327`*^9, 3.9011593328125253`*^9}, {3.9011593783655305`*^9, 
   3.901159378601023*^9}, 3.9011594799631815`*^9, {3.901159590153534*^9, 
   3.901159591049531*^9}, {3.9011600237007694`*^9, 3.9011600270887847`*^9}, {
   3.9011603471214867`*^9, 3.9011603623964615`*^9}, {3.901160598478645*^9, 
   3.901160621940713*^9}, {3.9011609049848785`*^9, 3.9011609060688915`*^9}, 
   3.901165631947605*^9, {3.901165673941618*^9, 3.901165676243758*^9}, {
   3.9011657071469035`*^9, 3.901165711340455*^9}, 3.9011657543076267`*^9, {
   3.901169797807295*^9, 3.9011697986352916`*^9}, 3.901171734336173*^9, 
   3.901172090120826*^9, 3.9012248991959405`*^9, 3.901224944569992*^9, 
   3.9012257659847918`*^9, 3.901226128291996*^9, 3.9012262136885414`*^9, 
   3.901226757457341*^9, 3.901229512360778*^9, 3.9012379514593697`*^9, 
   3.9012379918655477`*^9, {3.9012380432814674`*^9, 3.901238046665469*^9}, {
   3.901316349735853*^9, 3.9013163628021283`*^9}, {3.90131824398971*^9, 
   3.9013182443970485`*^9}, 3.901322675404979*^9, {3.9013227164546847`*^9, 
   3.9013227702938585`*^9}, {3.9013229312484937`*^9, 
   3.9013229527654634`*^9}, {3.9013230729455175`*^9, 3.901323075201868*^9}, {
   3.9013231057354097`*^9, 3.901323144690777*^9}, {3.9013231909403253`*^9, 
   3.9013232249134464`*^9}, {3.901339958731564*^9, 3.9013399587415648`*^9}, {
   3.9013401976292105`*^9, 3.9013402555517893`*^9}, {3.901340454851904*^9, 
   3.9013404613624086`*^9}, {3.901340492010645*^9, 3.9013404935115037`*^9}, {
   3.90134297507027*^9, 3.901342976180269*^9}, {3.9013436316248655`*^9, 
   3.901343695026663*^9}, {3.901343747521364*^9, 3.9013437962995863`*^9}, {
   3.9013438588292503`*^9, 3.9013438600598574`*^9}, {3.9015754782921877`*^9, 
   3.901575478839645*^9}, 3.9016585280532503`*^9, {3.9016586110491347`*^9, 
   3.901658619154166*^9}, {3.901658753780938*^9, 3.901658782826967*^9}, 
   3.901834812090955*^9, 3.901847941074207*^9, {3.9018524864639106`*^9, 
   3.9018525160257673`*^9}, 3.9018530460557437`*^9, 3.90218450005322*^9, {
   3.90218495252184*^9, 3.902184953843573*^9}, {3.902549736705613*^9, 
   3.902549746049697*^9}, {3.90255050237158*^9, 3.9025505694718847`*^9}, {
   3.902550616967*^9, 3.9025506359540057`*^9}, {3.902550687178217*^9, 
   3.902550789922014*^9}, {3.902552357326826*^9, 3.9025523889406567`*^9}, {
   3.902973281228453*^9, 3.90297336640322*^9}, {3.9029734115387707`*^9, 
   3.9029734182085*^9}, 3.902973456046815*^9, {3.9029735043572025`*^9, 
   3.9029735623041983`*^9}, {3.902973623950808*^9, 3.902973791541258*^9}, {
   3.902974000831259*^9, 3.9029740481747017`*^9}, {3.9029744415092983`*^9, 
   3.9029744463646603`*^9}, {3.902976269567528*^9, 3.9029762697575274`*^9}, {
   3.9029763126648693`*^9, 3.9029763127568703`*^9}, {3.902976351531005*^9, 
   3.902976378667631*^9}, {3.902978251897256*^9, 3.902978252089241*^9}, 
   3.903148211970061*^9, {3.903155678389411*^9, 3.903155682897295*^9}, {
   3.92717356623072*^9, 3.927173566360289*^9}, 3.9271739026594276`*^9, {
   3.9271739346665416`*^9, 3.927173942053507*^9}, {3.928538086310351*^9, 
   3.9285380881724324`*^9}, {3.9294030329802036`*^9, 
   3.9294030333742027`*^9}, {3.9294080563031063`*^9, 3.929408056487105*^9}, {
   3.929423384624614*^9, 3.929423388246883*^9}, {3.929484627869174*^9, 
   3.929484629419172*^9}, {3.929485481413453*^9, 3.929485481487032*^9}, 
   3.9294950675839643`*^9, {3.931312897491457*^9, 3.9313128976914587`*^9}, {
   3.9313144174202642`*^9, 3.9313144180302663`*^9}, {3.931316523310501*^9, 
   3.931316523550501*^9}, 3.9313232603760967`*^9, {3.9313951393293543`*^9, 
   3.9313951415485153`*^9}, {3.932780341567487*^9, 3.932780342137499*^9}, {
   3.9327805344848347`*^9, 3.932780534914836*^9}, 3.9327807188665*^9, {
   3.93311745074891*^9, 3.9331174510167694`*^9}},
 AspectRatioFixed->True,
 CellLabel->"In[17]:=",ExpressionUUID->"f9610f9d-2237-404b-bdbc-ee8eeedef1ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot Geometry", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.3999127615620003`*^9, 3.3999127622651253`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"6a40f96f-68cb-45d3-903a-0cca6a81d7d5"],

Cell["\<\
The following instructions create a set of 3D graphical primitives \
representing the structure in space, and plot it.\
\>", "Text",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"5e3354bb-12e3-478d-8e39-b51d423c832d"],

Cell[TextData[{
 StyleBox["draw=",
  FontColor->GrayLevel[0]],
 StyleBox["radObjDrw",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[und];",
  FontColor->GrayLevel[0]],
 StyleBox["\n\nRadPlot3DOptions",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nShow[Graphics3D[draw]\n,ViewPoint->{5,-1.5,2}\n,AxesLabel->{\"X \
[mm]\",\"Z [mm]\",\"Y [mm]\"}\n,PlotRange->All]\n\n\
Export[FileNameJoin[{NotebookDirectory[],\"Mag_p\"<>strPoles<>\"_n\"<>strSub<>\
\"_g\"<>strGap<>\"_3D.vtk\"}], Graphics3D[",
 StyleBox["draw",
  FontColor->GrayLevel[0]],
 "]]"
}], "Input",
 CellChangeTimes->{
  3.3998980155276566`*^9, {3.3999126650776253`*^9, 3.3999126661557503`*^9}, {
   3.6700787688556767`*^9, 3.670078772058878*^9}, {3.849654027638794*^9, 
   3.849654027968789*^9}, {3.8510564806522017`*^9, 3.851056483773333*^9}, {
   3.8510565721155987`*^9, 3.851056597193217*^9}, {3.8510569866200056`*^9, 
   3.851056987152727*^9}, {3.8510593375185065`*^9, 3.851059338732342*^9}, {
   3.851062876417424*^9, 3.8510628771751432`*^9}, 3.8510631499096613`*^9, {
   3.8510660425758533`*^9, 3.851066043538373*^9}, 3.851068343887452*^9, {
   3.8510693562036886`*^9, 3.8510693717988963`*^9}, {3.85113420436419*^9, 
   3.851134207383194*^9}, {3.8511368466404963`*^9, 3.851136847647799*^9}, {
   3.8511381095035934`*^9, 3.8511381098269267`*^9}, {3.851143217672477*^9, 
   3.851143220086031*^9}, {3.851143291526165*^9, 3.8511432956033397`*^9}, {
   3.851143412846573*^9, 3.851143445720421*^9}, {3.851747656656841*^9, 
   3.8517476971852636`*^9}, {3.853540760699243*^9, 3.8535407711310062`*^9}, {
   3.8535410571957884`*^9, 3.8535410718029985`*^9}, {3.853896546528343*^9, 
   3.853896571811363*^9}, {3.853896662946783*^9, 3.8538966699670277`*^9}, 
   3.853896777338599*^9, {3.854428169919366*^9, 3.8544281723117733`*^9}, {
   3.8544912741195087`*^9, 3.8544912746035175`*^9}, {3.854759299049115*^9, 
   3.8547593016975613`*^9}, {3.8547599838227797`*^9, 3.854760017470727*^9}, {
   3.874969408880315*^9, 3.874969472976459*^9}, 3.8749695586022234`*^9, {
   3.8749696304161386`*^9, 3.8749697099541645`*^9}, 3.87497056317663*^9, {
   3.8749713777933464`*^9, 3.8749714041090994`*^9}, {3.874971435152404*^9, 
   3.8749714964802756`*^9}, {3.8749791275597878`*^9, 3.87497914703551*^9}, {
   3.874979230505808*^9, 3.874979271378941*^9}, 3.874983658785466*^9, 
   3.874983841641162*^9, {3.8749843111986*^9, 3.874984331958038*^9}, {
   3.8749843719787507`*^9, 3.8749844277385683`*^9}, {3.87523613924306*^9, 
   3.8752361489039235`*^9}, {3.8752361845796747`*^9, 3.87523633353271*^9}, {
   3.875308842826955*^9, 3.8753088458793273`*^9}, {3.8753181573278723`*^9, 
   3.8753181655564585`*^9}, {3.8753182424342628`*^9, 
   3.8753182582483053`*^9}, {3.8753183529454756`*^9, 3.875318360051789*^9}, {
   3.875318405055428*^9, 3.8753184531656265`*^9}, {3.8753186059611197`*^9, 
   3.875318620321474*^9}, {3.875318776661355*^9, 3.875318794094635*^9}, {
   3.875318922983847*^9, 3.8753189711130867`*^9}, 3.875319008019101*^9, 
   3.8753235567095175`*^9, {3.8763732700235543`*^9, 3.876373288969636*^9}, 
   3.8763734449587417`*^9, {3.8775720922305684`*^9, 3.8775721113185763`*^9}, {
   3.87765238119256*^9, 3.8776524191047215`*^9}, {3.8776525189413724`*^9, 
   3.8776525191813717`*^9}, 3.8783348911453667`*^9, {3.878352079634449*^9, 
   3.8783520921825275`*^9}, {3.901224849597412*^9, 3.9012248842352533`*^9}, {
   3.901226681491583*^9, 3.9012266970049515`*^9}, {3.90122942240475*^9, 
   3.9012294226927614`*^9}, {3.901238377525395*^9, 3.9012383869240727`*^9}, {
   3.901322915955327*^9, 3.9013229463610344`*^9}, {3.9013230863296485`*^9, 
   3.9013230866327477`*^9}, {3.9016595798977757`*^9, 
   3.9016595821297846`*^9}, {3.9016596298517127`*^9, 
   3.9016596883156605`*^9}, {3.901659973856286*^9, 3.901659974334118*^9}, {
   3.9018348332221804`*^9, 3.9018348335119143`*^9}, {3.9018510757763476`*^9, 
   3.901851082658117*^9}, {3.9018511290217915`*^9, 3.9018511297898026`*^9}, {
   3.901851261373671*^9, 3.9018512616614656`*^9}, {3.901852215728075*^9, 
   3.9018522338235273`*^9}, {3.9313868564426537`*^9, 
   3.9313868991655416`*^9}, {3.93138694103596*^9, 3.9313869516236134`*^9}},
 AspectRatioFixed->True,
 CellLabel->"In[69]:=",ExpressionUUID->"c7896b99-1018-444a-acab-41eef79736aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve", "Section",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"f2047b13-2bc0-4c07-9f29-d3a1640badca"],

Cell["\<\
The following instructions Solve for the magnetization of each sub-block \
which constitutes the wiggler.\
\>", "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8520030112593613`*^9, 3.8520030122255955`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"74e90033-9ad3-4443-87b6-7ba9132b1854"],

Cell[TextData[{
 "t0=AbsoluteTime[];\nre=",
 StyleBox["RadSolve",
  FontColor->RGBColor[1, 0, 0]],
 "[und,0.0003,1000];\nt1=AbsoluteTime[];\n\nPrint[\"Solved in : \
\",Round[t1-t0],\" seconds\"];\nPrint[\"Number of Iterations : \",re[[4]]];\n\
Print[\"Average Stability of Magnetization at the last iteration : \
\",N[re[[1]],2],\" T\"];\nPrint[\"Maximum Absolute Magnetization at the last \
iteration : \",N[re[[2]],4],\" T\"];\nPrint[\"Maximum H vector at the last \
iteration : \",N[re[[3]],4],\" T\"];\nPrint[\"\"];\nPrint[\"Central Field \
Bz(0,0,0) : \",N[If[OddQ[numPoles],",
 StyleBox["radFld",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"Bz\",zer],",
 StyleBox["radFld",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"Bz\",{0,-per/4,0}]],4],\" T\"];\n(*Print[\"Even-pole Field \
Bz(0,\",-per/4,\",0) : \",N[",
 StyleBox["radFld",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"Bz\",{0,-per/4,0}],4],\" T\"];*)"
}], "Input",
 CellChangeTimes->{{3.849659983329946*^9, 3.8496599986770363`*^9}, {
  3.8517479409441953`*^9, 3.8517479946003323`*^9}, {3.85174804863535*^9, 
  3.8517480668304615`*^9}, {3.8517481049917417`*^9, 3.8517482284525623`*^9}, {
  3.8517482640160313`*^9, 3.8517482656009192`*^9}, {3.873838158361765*^9, 
  3.873838214173647*^9}, {3.8753236622297707`*^9, 3.875323746864647*^9}, {
  3.8753238586263113`*^9, 3.8753238586263113`*^9}, {3.9010683920241995`*^9, 
  3.9010684077983055`*^9}},
 AspectRatioFixed->True,
 CellLabel->"In[75]:=",ExpressionUUID->"177175c9-89ec-406b-9603-c0cf26effe5b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot the Magnetic Field", "Section",
 Evaluatable->False,
 CellChangeTimes->{3.8729088539939547`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"13a563cc-9ccb-4a8d-94c4-8905ca7468b5"],

Cell[TextData[{
 StyleBox["RadPlotOptions",
  FontColor->RGBColor[1, 0, 0]],
 "[];\ntrj=Plot[",
 StyleBox["radFld",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"Bz\",{0,y,0}],{y,-(NumPer+1)/1*per,(NumPer+1)/1*per}\n\
,AxesOrigin->{0,0}\n,RotateLabel->True\n,FrameLabel->{\"Y [mm]\",\"Bz \
[T]\",\"X = Z =  0\",\"\"}]\n(*Print[trj[[1,1,1,3,1,2,1]]];*)\n(*t=Table[{y, ",
 StyleBox["radFld",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"Bz\",{0,y,0}]},{y,-(NumPer+1)/1*per,(NumPer+1)/1*per}];*)\n\
t=Table[trj[[1,1,1,3,1,2,1]]];\nt=Prepend[t,headers];\n\
Export[FileNameJoin[{NotebookDirectory[],\"Field_y_p\"<>strPoles<>\"_n\"<>\
strSub<>\"_g\"<>strGap<>\".dat\"}],t]"
}], "Input",
 CellChangeTimes->{
  3.3999127191557503`*^9, {3.8495763030167513`*^9, 3.8495763573241215`*^9}, {
   3.8495775405648103`*^9, 3.8495775906862516`*^9}, {3.8496601464032965`*^9, 
   3.8496601466895857`*^9}, {3.849761336890487*^9, 3.8497613391008987`*^9}, {
   3.85114069017412*^9, 3.851140729321649*^9}, {3.8511408678675833`*^9, 
   3.8511408725854626`*^9}, {3.87291129806186*^9, 3.872911298531849*^9}, {
   3.872912206662447*^9, 3.8729122115994415`*^9}, {3.872912281301263*^9, 
   3.8729122828452625`*^9}, {3.8731492583236976`*^9, 3.8731492585645647`*^9}, 
   3.873149289407671*^9, {3.8731493426423607`*^9, 3.873149368618701*^9}, 
   3.873149436296256*^9, {3.874538080633662*^9, 3.874538143178136*^9}, {
   3.874539686126153*^9, 3.8745398089580083`*^9}, {3.874539841604335*^9, 
   3.8745398590701466`*^9}, {3.874539956012993*^9, 3.8745400036065426`*^9}, {
   3.8745402211841393`*^9, 3.8745402320610266`*^9}, {3.8745403942783484`*^9, 
   3.874540424227538*^9}, {3.8745404580990314`*^9, 3.8745404603394938`*^9}, {
   3.8745404991387024`*^9, 3.8745405332617636`*^9}, {3.874540600738474*^9, 
   3.874540634496504*^9}, 3.8745406722592926`*^9, {3.874540717270974*^9, 
   3.8745407606565638`*^9}, {3.8745408665589266`*^9, 3.874540926278302*^9}, {
   3.874540997752496*^9, 3.8745409988725123`*^9}, 3.874548446011737*^9, 
   3.8752363735636945`*^9, 3.875319045416836*^9, {3.8798931370166674`*^9, 
   3.879893214905362*^9}, {3.879893458336376*^9, 3.8798934588085127`*^9}},
 AspectRatioFixed->True,
 CellLabel->"In[87]:=",ExpressionUUID->"c23c1001-0828-48db-935f-f2cd6a792019"],

Cell[TextData[{
 StyleBox["RadPlotOptions",
  FontColor->RGBColor[1, 0, 0]],
 "[];\ntrj=Plot[",
 StyleBox["radFld",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"Bz\",{x,0,0}],{x,-100,100}\n,AxesOrigin->{0,0}\n,RotateLabel->True\n\
,FrameLabel->{\"X [mm]\",\"Bz [T]\",\"Y = Z =  0\",\"\"}]\n(*t=Table[{x, ",
 StyleBox["radFld",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"Bz\",{x,0,0}]},{x,-100,100}];*)\nt=Table[trj[[1,1,1,3,1,2,1]]];\n\
t=Prepend[t,headers];\n\
Export[FileNameJoin[{NotebookDirectory[],\"Field_x_p\"<>strPoles<>\"_n\"<>\
strSub<>\"_g\"<>strGap<>\".dat\"}],t]"
}], "Input",
 CellChangeTimes->{
  3.3999127191557503`*^9, {3.8495763030167513`*^9, 3.8495763573241215`*^9}, {
   3.8495775405648103`*^9, 3.8495775906862516`*^9}, {3.8496601464032965`*^9, 
   3.8496601466895857`*^9}, {3.849761336890487*^9, 3.8497613391008987`*^9}, {
   3.85114069017412*^9, 3.851140729321649*^9}, {3.8511408678675833`*^9, 
   3.8511408725854626`*^9}, {3.8535650996013255`*^9, 
   3.8535651407326827`*^9}, {3.8731493042701015`*^9, 3.87314933960233*^9}, 
   3.873149382782696*^9, {3.8731494227907476`*^9, 3.8731494500427456`*^9}, 
   3.8731495400388813`*^9, {3.8745399316897764`*^9, 3.8745399434377656`*^9}, {
   3.874540074426299*^9, 3.874540078966281*^9}, {3.874540139945366*^9, 
   3.8745401491892595`*^9}, {3.8745402144723644`*^9, 3.8745402170681896`*^9}, 
   3.8745484440950155`*^9, 3.8752363787677107`*^9, 3.8753190594200516`*^9, {
   3.87989340482718*^9, 3.879893405257023*^9}, {3.8798934482220592`*^9, 
   3.879893454849868*^9}},
 AspectRatioFixed->True,
 CellLabel->"In[94]:=",ExpressionUUID->"e9f58193-654c-4f92-8a2c-0c0bd8095936"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checking the Magnetic Material", "Section",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"e828e54d-83b4-4eec-9b65-9a304282b9bf"],

Cell[TextData[StyleBox["This cell presents a plot of the Magnetization vs \
Field Strength for the materials in use. Note that the NdFeB is anisotropic.",
 Evaluatable->False,
 AspectRatioFixed->True]], "Text",
 Evaluatable->False,
 CellChangeTimes->{3.8513937128169065`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"f141ba92-ffae-45d5-8d00-15d26515a7ef"],

Cell[TextData[{
 StyleBox["RadPlotOptions",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nPlot[",
 StyleBox["radMatMvsH",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[pole",
  FontColor->GrayLevel[0]],
 ", \"mz\", {0,0,hz}],{hz,-0.01,0.01}\n,FrameLabel->\"Pole Material \"\n\
,AxesLabel->{\"H\",\"M\"}\n]\n\nPlot[\n{",
 StyleBox["radMatMvsH",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet, \"mz\", {0,0,h}]\n,",
 StyleBox["radMatMvsH",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet, \"my\", {0,h,0}]}\n,{h,-1,1}\n,FrameLabel->\"NdFeB\"\n\
,AxesLabel->{\"H\",\"M\"}\n]"
}], "Input",
 CellChangeTimes->{
  3.3999127861088753`*^9, 3.41130367171875*^9, {3.41130375146875*^9, 
   3.411303760375*^9}, {3.411304570453125*^9, 3.411304577265625*^9}, {
   3.8538968038528557`*^9, 3.853896806962809*^9}, {3.8538968398284435`*^9, 
   3.853896842285179*^9}, {3.8538969411677217`*^9, 3.853896973075436*^9}, 
   3.8543431671935835`*^9, {3.8543432915121307`*^9, 3.85434329309089*^9}, 
   3.8543433834582863`*^9, {3.8543434357918067`*^9, 3.8543434415619507`*^9}, {
   3.8543435290028753`*^9, 3.854343536831567*^9}, {3.8543436099691167`*^9, 
   3.854343659507372*^9}, {3.85434561065574*^9, 3.8543456436795692`*^9}, {
   3.873157806238907*^9, 3.873157898190508*^9}, {3.873158177418696*^9, 
   3.8731581776506596`*^9}, {3.873158213922814*^9, 3.8731582309430294`*^9}, {
   3.8731584255192814`*^9, 3.87315845407543*^9}, {3.8731687140379896`*^9, 
   3.873168728313053*^9}, {3.873168761114502*^9, 3.8731688529092445`*^9}, {
   3.8731688898395004`*^9, 3.873168891549518*^9}, {3.8731689713219075`*^9, 
   3.873168980048828*^9}, {3.873769704252731*^9, 3.87376974901378*^9}, {
   3.901659594436122*^9, 3.901659597827736*^9}, {3.901659932277869*^9, 
   3.901659948667948*^9}, {3.9016603461155977`*^9, 3.901660347591601*^9}},
 AspectRatioFixed->True,
 CellLabel->
  "In[723]:=",ExpressionUUID->"9113889a-20af-485c-be53-acb2e2734784"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot the Beam Trajectory", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.849758921283576*^9, 3.8497589306411304`*^9}, 
   3.8729087986019197`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"e04a0304-5016-4e5e-8082-9f5a6046bd21"],

Cell[TextData[{
 "trj=",
 StyleBox["radFldPtcTrj",
  FontColor->RGBColor[1, 0, 0]],
 "[und,1.2,{0,0,0,0},{-2000,2000},1001];\n(*trjy=Table[x, {x, -2000, 2000, \
4}];*)\ntrjy=trj[[All,1]];\ntrjx=trj[[All,2]];\nt2=Table[{trjy[[z]], \
trjx[[z]]}, {z, 1, 1001}];\nt2=Prepend[t2,headers];\n\
Export[FileNameJoin[{NotebookDirectory[],\"Trajectory_x0_p\"<>strPoles<>\"_n\"\
<>strSub<>\"_g\"<>strGap<>\"_epy\"<>ToString[lep[[2]]]<>\".dat\"}],t2]\n\
ListLinePlot[t2,PlotRange->{{-(NumPer+2)*(per*2/3),(NumPer+2)*(per*2/3)}, \
{-0.5,1.2}}\n,Frame->True,FrameLabel->{\"Y [mm]\",\"Trajectory [mm]\",\" Z = \
0 \",\"\"}\n,RotateLabel->True,GridLines->Automatic, \
PlotStyle->{Thickness[0.002]}]\n\ntrja=1000*trj[[All,3]];\n\
t3=Table[{trjy[[z]], trja[[z]]}, {z, 1, 1001}];\nt3=Prepend[t3,headers];\n\
Export[FileNameJoin[{NotebookDirectory[],\"Trajectory_x1_p\"<>strPoles<>\"_n\"\
<>strSub<>\"_g\"<>strGap<>\"_epy\"<>ToString[lep[[2]]]<>\".dat\"}],t3]\n\
ListLinePlot[t3,PlotRange->{{-(NumPer+2)*(per*2/3),(NumPer+2)*(per*2/3)},{-20,\
 20}}\n,Frame->True,FrameLabel->{\"Y [mm]\",\"Angle [mrad]\",\" Z = 0 \
\",\"\"}\n,RotateLabel->True,GridLines->Automatic, \
PlotStyle->{Thickness[0.002]}]"
}], "Input",
 CellChangeTimes->{
  3.3999127191557503`*^9, {3.8495763030167513`*^9, 3.8495763573241215`*^9}, {
   3.8495775405648103`*^9, 3.8495775906862516`*^9}, {3.8496601464032965`*^9, 
   3.8496601466895857`*^9}, {3.849758934201888*^9, 3.849758965466861*^9}, {
   3.849758995671694*^9, 3.8497590471613293`*^9}, {3.849759085428671*^9, 
   3.8497590945203657`*^9}, {3.84975914289253*^9, 3.849759163404252*^9}, {
   3.849759205625345*^9, 3.8497593014898973`*^9}, {3.8497596618549557`*^9, 
   3.8497597278699403`*^9}, {3.849759759190307*^9, 3.8497598462145157`*^9}, {
   3.849760235398965*^9, 3.849760282003975*^9}, {3.849760325119749*^9, 
   3.8497603336507263`*^9}, {3.8497604471952887`*^9, 
   3.8497605503955956`*^9}, {3.849760662613845*^9, 3.8497607015724382`*^9}, {
   3.8497609083795815`*^9, 3.8497609550850444`*^9}, {3.849760998170805*^9, 
   3.849761017911478*^9}, {3.8497610816185737`*^9, 3.849761097306507*^9}, {
   3.849761140545887*^9, 3.8497611658474884`*^9}, {3.8497613167874346`*^9, 
   3.8497613183774357`*^9}, {3.849761371098154*^9, 3.8497613853107233`*^9}, {
   3.849761435924719*^9, 3.84976143981538*^9}, {3.8731495883568454`*^9, 
   3.8731496654829445`*^9}, {3.873151645136984*^9, 3.873151733502899*^9}, 
   3.8731518287880735`*^9, {3.8731519632233973`*^9, 3.873151980442554*^9}, {
   3.873152078243929*^9, 3.8731521289921436`*^9}, {3.873152393850757*^9, 
   3.873152401957018*^9}, 3.8731525811169577`*^9, {3.8731526255330863`*^9, 
   3.873152633905614*^9}, {3.8731527095218153`*^9, 3.873152723832174*^9}, {
   3.873152912943234*^9, 3.8731529469072104`*^9}, {3.8731531825829515`*^9, 
   3.873153194229101*^9}, {3.8731532557841825`*^9, 3.8731532617590756`*^9}, {
   3.8731540472438226`*^9, 3.873154051811249*^9}, {3.8731541439892178`*^9, 
   3.873154199015379*^9}, {3.873154268664457*^9, 3.873154288715515*^9}, 
   3.8731543316346245`*^9, {3.8731544911132784`*^9, 3.8731544949616814`*^9}, {
   3.873154631244213*^9, 3.8731546609572897`*^9}, {3.8731547171041956`*^9, 
   3.8731547466900682`*^9}, {3.873154900177001*^9, 3.8731549394262495`*^9}, {
   3.873155060717128*^9, 3.8731550921853657`*^9}, {3.8731551439739046`*^9, 
   3.873155152246679*^9}, {3.873155190102206*^9, 3.8731551931443143`*^9}, {
   3.873155235682529*^9, 3.8731552715605145`*^9}, {3.87315533162784*^9, 
   3.8731553624398537`*^9}, {3.873155645637825*^9, 3.873155660803918*^9}, {
   3.8731556942709036`*^9, 3.873155704555462*^9}, {3.873155786277837*^9, 
   3.8731558194871817`*^9}, {3.8731558728919*^9, 3.8731558995078373`*^9}, {
   3.873155956665845*^9, 3.873155960571486*^9}, {3.8731560091798105`*^9, 
   3.873156012855734*^9}, {3.8731560432317114`*^9, 3.873156058703618*^9}, {
   3.8731562053644533`*^9, 3.8731562169117317`*^9}, {3.873156262205022*^9, 
   3.873156431840908*^9}, 3.873156473775015*^9, {3.873156554510163*^9, 
   3.8731565994932814`*^9}, {3.873156639880785*^9, 3.873156704518467*^9}, {
   3.873156743266735*^9, 3.8731567710766864`*^9}, {3.873156916640628*^9, 
   3.873156988918971*^9}, {3.873772240986657*^9, 3.8737722578070507`*^9}, 
   3.873772296231247*^9, {3.8737724433559613`*^9, 3.8737724442262287`*^9}, 
   3.8737724834514017`*^9, {3.873772586885578*^9, 3.8737725889135513`*^9}, {
   3.8737727020164366`*^9, 3.8737727044097257`*^9}, {3.8737727499687405`*^9, 
   3.8737727584576764`*^9}, {3.873772789034867*^9, 3.8737728413611565`*^9}, {
   3.873772885523624*^9, 3.8737729426578927`*^9}, {3.8737729763101673`*^9, 
   3.8737730482340374`*^9}, 3.8737731670352793`*^9, {3.873773310459447*^9, 
   3.87377331228532*^9}, {3.873773402684389*^9, 3.873773407752008*^9}, 
   3.8737735945940695`*^9, {3.8737738399731383`*^9, 3.873773929911495*^9}, {
   3.8737739802542524`*^9, 3.8737739841946917`*^9}, {3.8737740378927293`*^9, 
   3.8737740434486303`*^9}, {3.873774074448284*^9, 3.8737740802549286`*^9}, {
   3.8737741180472474`*^9, 3.8737741457169504`*^9}, {3.873774179995798*^9, 
   3.8737741816836944`*^9}, {3.8737742263459225`*^9, 3.873774304601469*^9}, {
   3.8737744177504325`*^9, 3.8737744466891375`*^9}, {3.873837802904654*^9, 
   3.8738378985281243`*^9}, {3.8738380358601503`*^9, 
   3.8738380561037683`*^9}, {3.8745340185935273`*^9, 
   3.8745341066531334`*^9}, {3.8745341397264795`*^9, 3.874534143473506*^9}, {
   3.8745341745808*^9, 3.874534331431533*^9}, {3.8745343873127613`*^9, 
   3.8745343985800934`*^9}, {3.874548250578047*^9, 3.8745482579179144`*^9}, {
   3.8752364000749273`*^9, 3.875236406495778*^9}, {3.8753190834777*^9, 
   3.8753190905152817`*^9}, {3.8753192979064517`*^9, 3.875319350628664*^9}, {
   3.8798934223908105`*^9, 3.87989344492441*^9}, {3.9011590428924923`*^9, 
   3.901159074017212*^9}, 3.927173664863475*^9, 3.927173723933486*^9},
 AspectRatioFixed->True,
 CellLabel->
  "In[100]:=",ExpressionUUID->"87010605-74fc-48a9-915f-936cc44eff69"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot the Field Integrals", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.849759919376339*^9, 3.849759923907228*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"a2a1ed25-3eb1-4bb4-a51c-16e39b7cdbb1"],

Cell[TextData[{
 "int=Plot[",
 StyleBox["radFldInt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"inf\",\"ibz\",{x,-1500,0},{x,1500,0}]",
 StyleBox[",{x,-30,30},",
  FontColor->GrayLevel[0]],
 "\nFrameLabel->{\"X [mm]\",\"IBz [T mm]\",\"Z = 0\",\"\"},\n\
RotateLabel->True]\n(* which means the integral between y = -1500 to 1500 for \
each x ranging from -300 to 300 *)\n(*Print[int[[1,1,1,3,1,2,1]]];*)\n\
t=Table[int[[1,1,1,3,1,2,1]]];\nt=Prepend[t,headers];\n\
Export[FileNameJoin[{NotebookDirectory[],\"Fieldint_x_p\"<>strPoles<>\"_n\"<>\
strSub<>\"_g\"<>strGap<>\"_epy\"<>ToString[lep[[2]]]<>\".dat\"}],t]"
}], "Input",
 CellChangeTimes->{
  3.3999127191557503`*^9, {3.8495763030167513`*^9, 3.8495763573241215`*^9}, {
   3.8495775405648103`*^9, 3.8495775906862516`*^9}, {3.8496601464032965`*^9, 
   3.8496601466895857`*^9}, {3.8497599323842635`*^9, 3.849759949303007*^9}, {
   3.8497612710557795`*^9, 3.849761273783752*^9}, {3.8503621770710697`*^9, 
   3.8503621775450664`*^9}, {3.850362310944833*^9, 3.8503623453813295`*^9}, 
   3.8503624629955745`*^9, {3.8503625296444254`*^9, 3.850362554205467*^9}, {
   3.8511346117721195`*^9, 3.8511346159356966`*^9}, {3.851739717181954*^9, 
   3.8517397262909775`*^9}, {3.8517399014521427`*^9, 3.851739904336752*^9}, {
   3.8517399876687098`*^9, 3.8517399999438705`*^9}, {3.8517401000230207`*^9, 
   3.8517401322669883`*^9}, {3.85174021449631*^9, 3.851740216074888*^9}, {
   3.8517497462587976`*^9, 3.8517497465026035`*^9}, 3.8520030383119907`*^9, {
   3.853457130484833*^9, 3.8534571471623*^9}, {3.8534572121206446`*^9, 
   3.8534572338930817`*^9}, {3.853457298570691*^9, 3.8534573037304688`*^9}, {
   3.853540254143448*^9, 3.853540288871326*^9}, {3.853542842682109*^9, 
   3.8535428533123746`*^9}, {3.8543458385715113`*^9, 
   3.8543458934140368`*^9}, {3.8543460123843746`*^9, 3.854346069479134*^9}, {
   3.8556253282074385`*^9, 3.8556253316996717`*^9}, {3.855625636580715*^9, 
   3.8556256721702695`*^9}, {3.855628720836735*^9, 3.8556287369275246`*^9}, {
   3.855629152366682*^9, 3.8556291767632065`*^9}, {3.8556292113992558`*^9, 
   3.855629326927168*^9}, {3.8556293734051204`*^9, 3.8556294095644813`*^9}, {
   3.855629691629794*^9, 3.855629732802349*^9}, 3.85562978308834*^9, {
   3.855629823491311*^9, 3.855629850177179*^9}, {3.85563218532474*^9, 
   3.8556322497755637`*^9}, {3.855632328830665*^9, 3.855632335150651*^9}, {
   3.855632495252677*^9, 3.855632496042675*^9}, {3.855808041405472*^9, 
   3.8558080443447013`*^9}, {3.873157202898458*^9, 3.873157245078357*^9}, 
   3.873157276404545*^9, {3.873158505447081*^9, 3.873158505917098*^9}, {
   3.87315857824832*^9, 3.873158618546558*^9}, {3.8731586655095243`*^9, 
   3.8731587472913485`*^9}, {3.873160477096804*^9, 3.8731605330022044`*^9}, {
   3.873160590111107*^9, 3.873160591193328*^9}, 3.8731606616127353`*^9, 
   3.873160703231393*^9, {3.8731607415904818`*^9, 3.8731607784909153`*^9}, {
   3.8731608820441437`*^9, 3.8731610369647026`*^9}, {3.8731610966110163`*^9, 
   3.873161285584781*^9}, {3.873161321364519*^9, 3.8731613935631647`*^9}, {
   3.873161712581431*^9, 3.873161748368446*^9}, {3.873161821084298*^9, 
   3.873161821088298*^9}, {3.874536257360826*^9, 3.8745362651308317`*^9}, {
   3.8745402568189554`*^9, 3.874540264056934*^9}, {3.874545877910248*^9, 
   3.8745458831567583`*^9}, {3.8745459352399416`*^9, 3.874546062574834*^9}, {
   3.8745482371380477`*^9, 3.874548237311759*^9}, 3.8752364169397893`*^9, 
   3.875319115225121*^9, 3.8753193671094475`*^9, {3.8798934903093476`*^9, 
   3.8798934940873313`*^9}, {3.879973341610127*^9, 3.8799733476891637`*^9}, {
   3.901159858726224*^9, 3.9011598665026603`*^9}, {3.9011602093182993`*^9, 
   3.901160218510313*^9}, {3.931305789701482*^9, 3.9313057920961246`*^9}},
 AspectRatioFixed->True,
 CellLabel->
  "In[114]:=",ExpressionUUID->"2148320c-9341-4d90-84da-6b03cbbe43c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Magnetization field vector ", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.3999161090463753`*^9, 3.3999161098901253`*^9}, {
  3.8496745837586856`*^9, 3.8496745927688885`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"9f4fbd33-34e8-4c18-a846-4d6c516cc774"],

Cell[TextData[StyleBox["Plot the magnetization in the center of each \
subdivided element of the magnet. ",
 Evaluatable->False,
 AspectRatioFixed->True]], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.849674604328885*^9, 
  3.8496746064188843`*^9}},ExpressionUUID->"547c101f-275c-4514-9faf-\
65051eb7d800"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   StyleBox["RadPlot3DOptions",
    FontColor->RGBColor[1, 0, 0]], "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"fldvec", "=", 
   RowBox[{"ListVectorFieldPlot3D", "[", 
    RowBox[{
     RowBox[{
      StyleBox["radObjM",
       FontColor->RGBColor[1, 0, 0]], "[", "und", "]"}], "\n", ",", 
     RowBox[{"VectorHeads", "->", "True"}], "\n", ",", 
     RowBox[{"ColorFunction", "->", " ", "Hue"}], "\n", ",", 
     RowBox[{"PlotLabel", "->", "\"\<Magnetization in Element # \>\""}], "\n",
      ",", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"3", ",", "2", ",", " ", "0"}], "}"}]}], "\n", ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{"All", ",", "All", ",", "All"}], "}"}]}], " ", "\n", ",", 
     RowBox[{"ScaleFactor", "->", "15"}]}], "]"}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{"Print", "[", 
    RowBox[{"fldvec", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"2", ";;", " ", ";;", " ", "5"}], ",", "1", ",", "1"}], "]"}], 
     "]"}], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Print", "[", 
    RowBox[{"fldvec", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"1", ";;", " ", ";;", "5"}]}], "]"}], "]"}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fldvec", "[", 
          RowBox[{"[", 
           RowBox[{"1", "  ", ",", 
            RowBox[{"2", " ", ";;", " ", ";;", " ", "5"}], ",", " ", "1", ",",
             "1"}], "]"}], "]"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"fldvec", "[", 
          RowBox[{"[", 
           RowBox[{"1", "  ", ",", 
            RowBox[{"2", " ", ";;", " ", ";;", " ", "5"}], ",", " ", "1", ",",
             "2"}], "]"}], "]"}], "}"}], ",", "3"}], "]"}], ",", "1"}], "]"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      StyleBox[
       RowBox[{
       "\"\<Mag_p\>\"", "<>", "strPoles", "<>", "\"\<_n\>\"", "<>", "strSub", 
        "<>", "\"\<_g\>\"", "<>", "strGap", "<>", "\"\<_vec.dat\>\""}],
       FontColor->GrayLevel[0]]}], 
     StyleBox["}",
      FontColor->GrayLevel[0]]}], 
    StyleBox["]",
     FontColor->GrayLevel[0]]}], 
   StyleBox[",",
    FontColor->GrayLevel[0]], 
   StyleBox["t",
    FontColor->GrayLevel[0]]}], 
  StyleBox["]",
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox["Export",
   FontColor->GrayLevel[0]], 
  StyleBox["[",
   FontColor->GrayLevel[0]], 
  RowBox[{
   StyleBox[
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       RowBox[{
       "\"\<Mag_p\>\"", "<>", "strPoles", "<>", "\"\<_n\>\"", "<>", "strSub", 
        "<>", "\"\<_g\>\"", "<>", "strGap", "<>", "\"\<_vec.vtk\>\""}]}], 
      "}"}], "]"}],
    FontColor->GrayLevel[0]], 
   StyleBox[",",
    FontColor->GrayLevel[0]], 
   RowBox[{"Graphics3D", "[", "fldvec", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.3999178362963753`*^9, 3.3999185101870003`*^9, {3.849673971733321*^9, 
   3.8496739827637234`*^9}, {3.8496740967892575`*^9, 3.849674131559239*^9}, {
   3.8496742683663273`*^9, 3.849674268667714*^9}, {3.8496743395400047`*^9, 
   3.8496743432800026`*^9}, 3.8511400778628387`*^9, {3.851140642457172*^9, 
   3.8511406749607143`*^9}, {3.851146260392548*^9, 3.8511462719938207`*^9}, {
   3.8731620833011475`*^9, 3.8731621237082624`*^9}, {3.873162220884925*^9, 
   3.8731622291540337`*^9}, {3.8731624374435415`*^9, 
   3.8731624376780205`*^9}, {3.8731705398202667`*^9, 3.873170597189557*^9}, {
   3.873170657578685*^9, 3.8731706820041428`*^9}, {3.873170733186885*^9, 
   3.873170736847183*^9}, {3.873171167803356*^9, 3.8731711713199873`*^9}, {
   3.8731713978458567`*^9, 3.873171399205983*^9}, {3.873171443990018*^9, 
   3.87317145128448*^9}, {3.873235476490508*^9, 3.8732354913910794`*^9}, {
   3.873235919593499*^9, 3.8732360355033617`*^9}, {3.8732361624032393`*^9, 
   3.8732362023907824`*^9}, {3.8738430494207087`*^9, 
   3.8738430782997665`*^9}, {3.8738645381923428`*^9, 
   3.8738645430995865`*^9}, {3.8743737034707108`*^9, 
   3.8743737227804174`*^9}, {3.874373896733656*^9, 3.874373933556782*^9}, {
   3.874374122496338*^9, 3.8743741326116643`*^9}, {3.874374174312461*^9, 
   3.8743741748324614`*^9}, {3.874374530027667*^9, 3.87437453290514*^9}, {
   3.874374859927023*^9, 3.8743748683631544`*^9}, {3.874375018680959*^9, 
   3.8743750241855826`*^9}, {3.8743750760733447`*^9, 3.87437511578864*^9}, {
   3.8743754040169325`*^9, 3.8743755238011265`*^9}, {3.8743756377890844`*^9, 
   3.8743757532638683`*^9}, {3.8743759128239975`*^9, 3.874375962377983*^9}, {
   3.8743759930589485`*^9, 3.8743759961449614`*^9}, {3.874376039383239*^9, 
   3.8743760744754825`*^9}, {3.8743761072517204`*^9, 
   3.8743761126565576`*^9}, {3.8743761982238026`*^9, 3.874376224079115*^9}, {
   3.8743762565387707`*^9, 3.8743762590690784`*^9}, {3.8743762915779266`*^9, 
   3.874376325627499*^9}, {3.874376361767765*^9, 3.874376364104616*^9}, {
   3.8743764957366104`*^9, 3.874376510699926*^9}, {3.87437662047856*^9, 
   3.874376651947129*^9}, {3.874376724047211*^9, 3.8743767264060936`*^9}, {
   3.874376759043358*^9, 3.8743768291404533`*^9}, {3.874376900581311*^9, 
   3.8743769091679487`*^9}, {3.874377285981876*^9, 3.8743772913663745`*^9}, {
   3.8743773540564303`*^9, 3.874377358309749*^9}, {3.874377409919383*^9, 
   3.8743774270110984`*^9}, 3.874377484688851*^9, {3.8743775528656435`*^9, 
   3.8743775633717065`*^9}, {3.8743785062663565`*^9, 3.8743785166111174`*^9}, 
   3.8743793461444187`*^9, 3.8743816810590243`*^9, 3.8743817311037846`*^9, {
   3.8743819526729507`*^9, 3.8743819723438663`*^9}, 3.8745338738947926`*^9, {
   3.874548328093648*^9, 3.874548339503828*^9}, {3.8749715164329185`*^9, 
   3.874971522584694*^9}, 3.87497160355783*^9, {3.875236429635*^9, 
   3.8752364331479197`*^9}, {3.87531912590224*^9, 3.875319134141346*^9}, {
   3.9012243330753336`*^9, 3.901224349817649*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"38b94814-3bb7-4c90-8e7f-ddbabc2517b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Magnetic Force ", "Section",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"d15fabc2-96b4-4a55-b25d-8819783997ee"],

Cell[TextData[{
 StyleBox["One computes the force over the element ",
  Evaluatable->False,
  AspectRatioFixed->True],
 StyleBox["pole",
  Evaluatable->False,
  AspectRatioFixed->True,
  FontColor->RGBColor[1, 0, 0]],
 StyleBox[" induced by the whole structure. One should be cautious that the \
cpu time to compute the force can be very long and one must set the \
segmentation parameter k to the lowest values consistent with sufficient \
precision. Taking into account the symmetry with respect to the x axis \
{1,0,0} would remove the Fx component and double the Fy and Fz components. ",
  Evaluatable->False,
  AspectRatioFixed->True]
}], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.851393648546874*^9, 3.851393657352412*^9}, 
   3.8513937208981*^9, {3.853544499630618*^9, 3.853544500068325*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"b91a60b9-8c56-4759-a8a7-0709b316b6a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"fr", "=", 
   RowBox[{
    StyleBox["radFldEnrFrc",
     FontColor->RGBColor[1, 0, 0]], "[", 
    RowBox[{"poleF", ",", "und", ",", "\"\<\>\"", ",", "k"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<{Fx, Fy, Fz} = \>\"", ",", 
    RowBox[{"N", "[", 
     RowBox[{"fr", ",", "3"}], "]"}], ",", "\"\< Newton\>\""}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", " ", "[", 
   RowBox[{"\"\<cpu time : \>\"", ",", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"t2", "-", "t1"}], ",", "3"}], "]"}], ",", "\"\< seconds\>\""}],
    "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.851048328125846*^9, 3.851048340700386*^9}, {
   3.851048598074871*^9, 3.8510485987790127`*^9}, 3.8510566695405135`*^9, {
   3.851059402479393*^9, 3.8510594066780987`*^9}, {3.8510684298974805`*^9, 
   3.851068433380258*^9}, {3.8510684965444694`*^9, 3.8510684992134743`*^9}, {
   3.8510694108835635`*^9, 3.8510694185248213`*^9}, 3.85112997208502*^9, {
   3.8511340242614408`*^9, 3.8511340256976967`*^9}, {3.851134281246358*^9, 
   3.851134284374837*^9}, {3.8511366993379183`*^9, 3.851136700349275*^9}, 
   3.853544520033885*^9, {3.8538214765601015`*^9, 3.853821525853097*^9}, {
   3.853821571510219*^9, 3.853821579845916*^9}, {3.853821613578614*^9, 
   3.8538216169785976`*^9}, 3.9012268253635263`*^9},
 CellLabel->
  "In[125]:=",ExpressionUUID->"49ef75ca-1487-4a29-b498-91c185383a97"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kick map ", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.9285382186421437`*^9, 3.9285382224123087`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"fe48622e-8603-4276-9d1f-bfe344babb35"],

Cell[TextData[StyleBox["One computes the kick map. Details are available in \
the help. [[1]]- matrix of kick values in the first transverse direction, \
[[2]]- matrix of kick values in the second transverse direction, [[3]]- \
matrix of longitudinally-integrated squared transverse magnetic field \
calculated on same transverse mesh as kicks, [[4]],[[5]]- lists of positions \
defining the transverse grid, [[6]]- formatted string containing the computed \
results (for saving into a text file).",
 Evaluatable->False,
 AspectRatioFixed->True]], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.851393648546874*^9, 3.851393657352412*^9}, 
   3.8513937208981*^9, {3.853544499630618*^9, 3.853544500068325*^9}, {
   3.928538242353736*^9, 3.928538245093853*^9}, {3.9285523122760324`*^9, 
   3.9285523405047555`*^9}, {3.9294080108307285`*^9, 3.9294080268972387`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"37c612b7-6e4f-42bb-a3d5-cf02b4880eae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Test: \>\"", ",", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{
         StyleBox["radFldFocKickPer",
          FontColor->RGBColor[1, 0, 0]], "[", 
         RowBox[{"und", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"-", "per"}], "*", 
             RowBox[{"NumPer", "/", "2"}]}], ",", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", " ", "per", ",", 
          " ", "NumPer", ",", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", " ", 
          RowBox[{"gap", "*", "0.75"}], ",", " ", "21", ",", " ", 
          RowBox[{"gap", "*", "0.75"}], ",", " ", "21", ",", " ", 
          "\"\<com\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "8", ",", "0", ",", "0"}], "}"}], ",", 
          "\"\<T2m2\>\"", ",", "1", ",", "\"\<fix\>\""}], "]"}], ",", "4"}], 
       "]"}]}], "]"}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"int", "=", 
     RowBox[{
      StyleBox["radFldFocKickPer",
       FontColor->RGBColor[1, 0, 0]], "[", 
      RowBox[{"und", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "per"}], "*", 
          RowBox[{"NumPer", "/", "2"}]}], ",", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", " ", "per", ",", " ", 
       "1", ",", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", " ", "200", ",", " ", 
       "201", ",", " ", "14", ",", " ", "15", ",", " ", "\"\<com\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "8", ",", "0", ",", "0"}], "}"}], ",", 
       "\"\<T2m2\>\"", ",", "1.2", ",", "\"\<fix\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tx", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"int", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"ListPlot3D", "[", 
    RowBox[{"tx", ",", " ", 
     RowBox[{"DataRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "7"}], ",", "7"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", " ", 
        RowBox[{"HoldForm", "[", 
         RowBox[{
          RowBox[{"Superscript", "[", 
           RowBox[{"T", ",", " ", "2"}], "]"}], 
          RowBox[{"Superscript", "[", 
           RowBox[{"m", ",", " ", "2"}], "]"}]}], "]"}]}], "}"}]}]}], "]"}], 
   "\n", 
   RowBox[{
    RowBox[{"tx", " ", "=", " ", 
     RowBox[{"Prepend", "[", 
      RowBox[{"tx", ",", " ", 
       RowBox[{"int", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tx", " ", "=", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{"Prepend", ",", " ", 
       RowBox[{"{", 
        RowBox[{"tx", ",", " ", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"int", "[", 
            RowBox[{"[", "5", "]"}], "]"}], ",", " ", "\"\<\>\""}], "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tx", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"tx", ",", "\"\<horizontal kick in T2m2\>\""}], "]"}]}], ";"}], 
   " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tz", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"int", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"ListPlot3D", "[", 
    RowBox[{"tz", ",", " ", 
     RowBox[{"DataRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "7"}], ",", "7"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", " ", 
        RowBox[{"HoldForm", "[", 
         RowBox[{
          RowBox[{"Superscript", "[", 
           RowBox[{"T", ",", " ", "2"}], "]"}], 
          RowBox[{"Superscript", "[", 
           RowBox[{"m", ",", " ", "2"}], "]"}]}], "]"}]}], "}"}]}]}], "]"}], 
   "\n", 
   RowBox[{
    RowBox[{"tz", " ", "=", " ", 
     RowBox[{"Prepend", "[", 
      RowBox[{"tz", ",", " ", 
       RowBox[{"int", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tz", " ", "=", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{"Prepend", ",", " ", 
       RowBox[{"{", 
        RowBox[{"tz", ",", " ", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"int", "[", 
            RowBox[{"[", "5", "]"}], "]"}], ",", " ", "\"\<\>\""}], "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tz", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"tz", ",", "\"\<vertical kick in T2m2\>\""}], "]"}]}], ";"}], 
   " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tp", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"int", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"ListPlot3D", "[", 
    RowBox[{"tp", ",", " ", 
     RowBox[{"DataRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "7"}], ",", "7"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", " ", 
        RowBox[{"HoldForm", "[", 
         RowBox[{
          RowBox[{"Superscript", "[", 
           RowBox[{"T", ",", " ", "2"}], "]"}], 
          RowBox[{"Superscript", "[", 
           RowBox[{"m", ",", " ", "3"}], "]"}]}], "]"}]}], "}"}]}]}], "]"}], 
   "\n", 
   RowBox[{
    RowBox[{"tp", " ", "=", " ", 
     RowBox[{"Prepend", "[", 
      RowBox[{"tp", ",", " ", 
       RowBox[{"int", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tp", " ", "=", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{"Prepend", ",", " ", 
       RowBox[{"{", 
        RowBox[{"tp", ",", " ", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"int", "[", 
            RowBox[{"[", "5", "]"}], "]"}], ",", " ", "\"\<\>\""}], "]"}]}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tp", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{"tp", ",", "\"\<Potential [T2m]\>\""}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        RowBox[{
        "\"\<Kickmap\>\"", "<>", "strPoles", "<>", "\"\<_n\>\"", "<>", 
         "strSub", "<>", "\"\<_g\>\"", "<>", "strGap", "<>", "\"\<_epy\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"lep", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", 
         "\"\<_hor_T2m2.dat\>\""}]}], "}"}], "]"}], ",", "tx"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        RowBox[{
        "\"\<Kickmap\>\"", "<>", "strPoles", "<>", "\"\<_n\>\"", "<>", 
         "strSub", "<>", "\"\<_g\>\"", "<>", "strGap", "<>", "\"\<_epy\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"lep", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", 
         "\"\<_ver_T2m2.dat\>\""}]}], "}"}], "]"}], ",", "tz"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        RowBox[{
        "\"\<Kickmap\>\"", "<>", "strPoles", "<>", "\"\<_n\>\"", "<>", 
         "strSub", "<>", "\"\<_g\>\"", "<>", "strGap", "<>", "\"\<_epy\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"lep", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", 
         "\"\<_phi_T2m1.dat\>\""}]}], "}"}], "]"}], ",", "tp"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.851048328125846*^9, 3.851048340700386*^9}, {
   3.851048598074871*^9, 3.8510485987790127`*^9}, 3.8510566695405135`*^9, {
   3.851059402479393*^9, 3.8510594066780987`*^9}, {3.8510684298974805`*^9, 
   3.851068433380258*^9}, {3.8510684965444694`*^9, 3.8510684992134743`*^9}, {
   3.8510694108835635`*^9, 3.8510694185248213`*^9}, 3.85112997208502*^9, {
   3.8511340242614408`*^9, 3.8511340256976967`*^9}, {3.851134281246358*^9, 
   3.851134284374837*^9}, {3.8511366993379183`*^9, 3.851136700349275*^9}, 
   3.853544520033885*^9, {3.8538214765601015`*^9, 3.853821525853097*^9}, {
   3.853821571510219*^9, 3.853821579845916*^9}, {3.853821613578614*^9, 
   3.8538216169785976`*^9}, 3.9012268253635263`*^9, {3.9285383310459385`*^9, 
   3.9285383345019584`*^9}, {3.9285414246209474`*^9, 
   3.9285414266409593`*^9}, {3.928541501829551*^9, 3.9285415458843365`*^9}, {
   3.928541592008731*^9, 3.9285417403583174`*^9}, {3.9285418183341084`*^9, 
   3.928541818910331*^9}, {3.9285418626052985`*^9, 3.928541863826633*^9}, {
   3.928541923584627*^9, 3.928541949241088*^9}, 3.9285419903867216`*^9, {
   3.928542022108453*^9, 3.928542070102411*^9}, 3.9285421286684465`*^9, {
   3.9285421842692137`*^9, 3.9285422138699703`*^9}, {3.9285424920514126`*^9, 
   3.92854251198498*^9}, {3.9285425429310665`*^9, 3.9285426065690002`*^9}, 
   3.928542684424055*^9, {3.928542726649398*^9, 3.9285427352490263`*^9}, 
   3.928542870380126*^9, 3.92854296152862*^9, {3.9285430135339766`*^9, 
   3.928543065188614*^9}, {3.9285431734316487`*^9, 3.928543208545703*^9}, {
   3.9285433822245593`*^9, 3.928543409192542*^9}, 3.9285434668713217`*^9, {
   3.928543651567415*^9, 3.928543652876213*^9}, {3.9285438792244787`*^9, 
   3.928543884944474*^9}, 3.928543967105072*^9, {3.9285441045439854`*^9, 
   3.9285441410257053`*^9}, 3.9285441873454237`*^9, {3.9285442700792227`*^9, 
   3.9285442947652855`*^9}, {3.9285444317584486`*^9, 3.9285444319998684`*^9}, 
   3.9285446039573865`*^9, 3.928544754210086*^9, {3.9285447857562723`*^9, 
   3.9285447865262885`*^9}, 3.9285448307313404`*^9, 3.928544863840126*^9, {
   3.928544995611817*^9, 3.9285449960318174`*^9}, 3.928545034702001*^9, {
   3.9285451322603683`*^9, 3.928545145710396*^9}, {3.928545205836026*^9, 
   3.9285452162662287`*^9}, 3.9285454829914923`*^9, {3.928548696450299*^9, 
   3.928548712417433*^9}, {3.9285488624619527`*^9, 3.928548877681994*^9}, {
   3.928549060876525*^9, 3.9285490904290977`*^9}, {3.9285492255616846`*^9, 
   3.9285492660382133`*^9}, {3.928549525851229*^9, 3.92854954905126*^9}, {
   3.9285497281901655`*^9, 3.9285497377994595`*^9}, {3.9285497908309975`*^9, 
   3.928549796491002*^9}, 3.92854982971672*^9, {3.9285498657570477`*^9, 
   3.9285498732530537`*^9}, {3.928549908029663*^9, 3.9285499112776675`*^9}, {
   3.9285500306371975`*^9, 3.9285500681505575`*^9}, {3.928550100630576*^9, 
   3.9285501437806015`*^9}, {3.9285502875664873`*^9, 3.928550338111045*^9}, {
   3.9285504061014614`*^9, 3.9285504424065895`*^9}, {3.92855047979531*^9, 
   3.928550555582032*^9}, {3.928550629822651*^9, 3.9285506410798144`*^9}, {
   3.928550680891305*^9, 3.928550712926147*^9}, {3.928550792902193*^9, 
   3.928550809723674*^9}, {3.9285508459760747`*^9, 3.9285508776764956`*^9}, {
   3.9285518594541483`*^9, 3.9285518671341486`*^9}, {3.9285519127345443`*^9, 
   3.928551936728713*^9}, 3.928552361344884*^9, {3.92855266494829*^9, 
   3.928552667838306*^9}, {3.928552907628065*^9, 3.9285529337218404`*^9}, {
   3.928552990231881*^9, 3.9285530117084417`*^9}, {3.928553085017209*^9, 
   3.9285530888372254`*^9}, {3.928553143665495*^9, 3.928553151105516*^9}, {
   3.929402196548994*^9, 3.929402225132555*^9}, {3.9294025608713284`*^9, 
   3.9294025800276427`*^9}, {3.929422751339632*^9, 3.9294227545276327`*^9}, 
   3.929422949597694*^9, {3.9294231561425385`*^9, 3.929423168314498*^9}, {
   3.9294232966968765`*^9, 3.9294232990377836`*^9}, {3.9294234389218473`*^9, 
   3.929423441783861*^9}, {3.9294235177879004`*^9, 3.9294235214478254`*^9}, {
   3.929423557212698*^9, 3.9294235850486555`*^9}, {3.9294846444317007`*^9, 
   3.9294846559374065`*^9}, {3.9294847474411077`*^9, 3.929484959198882*^9}, {
   3.929485007761374*^9, 3.929485012183116*^9}, {3.9294851168117094`*^9, 
   3.9294851253176165`*^9}, {3.929485156861654*^9, 3.9294852275366025`*^9}, {
   3.929485428887463*^9, 3.9294854350901947`*^9}, {3.929489325080223*^9, 
   3.929489335724143*^9}, {3.9294899952617583`*^9, 3.9294900441392546`*^9}, {
   3.9294901383334923`*^9, 3.9294901835471025`*^9}, {3.929490260253435*^9, 
   3.9294902642397575`*^9}, {3.9294903597700434`*^9, 3.929490381568204*^9}, {
   3.929490419234335*^9, 3.9294904278502913`*^9}, {3.929490512498555*^9, 
   3.9294905301923943`*^9}, {3.9294906051929145`*^9, 3.929490638811388*^9}, {
   3.929490951153673*^9, 3.929490957314233*^9}, {3.9294920023752294`*^9, 
   3.929492004930329*^9}, 3.9294920488191943`*^9, {3.9294921848720827`*^9, 
   3.9294922065290613`*^9}, {3.929492251269804*^9, 3.9294922530597763`*^9}, {
   3.929492504985138*^9, 3.929492523443532*^9}, {3.9294925595840797`*^9, 
   3.929492560104085*^9}, {3.929493257566555*^9, 3.929493258106558*^9}, {
   3.929493335639931*^9, 3.9294933379197702`*^9}, {3.9294933789381213`*^9, 
   3.929493379398122*^9}, {3.9294934209263616`*^9, 3.929493422317261*^9}, {
   3.9294934594121447`*^9, 3.92949346264305*^9}, {3.929493519781709*^9, 
   3.9294935265077486`*^9}, {3.929493561198693*^9, 3.929493563028697*^9}, {
   3.929493612219159*^9, 3.929493639015109*^9}, {3.9294936903837442`*^9, 
   3.929493693733694*^9}, {3.9294937325479193`*^9, 3.929493736667494*^9}, {
   3.9294938132810802`*^9, 3.9294938399506917`*^9}, {3.9294938990981503`*^9, 
   3.9294939007073636`*^9}, {3.929493979429713*^9, 3.9294940125173163`*^9}, {
   3.9294940699197035`*^9, 3.929494105630105*^9}, {3.929494166923298*^9, 
   3.929494182896316*^9}, {3.929494233783864*^9, 3.929494258326948*^9}, {
   3.929494336205309*^9, 3.929494341643062*^9}, {3.929494459989642*^9, 
   3.9294944693600054`*^9}, {3.9294945259203615`*^9, 3.929494631658983*^9}, {
   3.9294946987753277`*^9, 3.92949470074658*^9}, {3.929494738585329*^9, 
   3.929494750188219*^9}, {3.929494799503127*^9, 3.9294948042135153`*^9}, {
   3.9294948350757155`*^9, 3.929494845443661*^9}, {3.929494889366458*^9, 
   3.9294949189872084`*^9}, {3.9294950245975523`*^9, 3.929495027817423*^9}, {
   3.931323297891159*^9, 3.931323301754694*^9}, {3.93132342020613*^9, 
   3.9313234388908033`*^9}, {3.9313235664843807`*^9, 
   3.9313236229469724`*^9}, {3.931323656199188*^9, 3.9313236727116385`*^9}, {
   3.931323706686488*^9, 3.9313237226831255`*^9}, 3.9331174983374276`*^9, 
   3.933117835002002*^9, {3.9331179314876766`*^9, 3.9331179319836493`*^9}, {
   3.9331213877913203`*^9, 3.933121398229306*^9}, 3.933121454193783*^9, 
   3.9331215204540033`*^9, {3.9331215595782037`*^9, 3.9331215849942985`*^9}, 
   3.9331216347775354`*^9, 3.9331216665500193`*^9, 3.933220646676185*^9, {
   3.9332207747970963`*^9, 3.9332207819031*^9}, {3.9332208338898997`*^9, 
   3.933220835407107*^9}, {3.933291039691863*^9, 3.9332910440351143`*^9}, {
   3.9332966943804736`*^9, 3.933296772313455*^9}, {3.9332970414366612`*^9, 
   3.9332970451462727`*^9}, {3.933297129149622*^9, 3.933297139372069*^9}, {
   3.933297183218586*^9, 3.93329719298367*^9}, {3.933297396504311*^9, 
   3.9332974257209415`*^9}, 3.9333011021277657`*^9, {3.933302793656686*^9, 
   3.9333028010572133`*^9}, 3.933303015628681*^9, {3.933303610314275*^9, 
   3.933303614603015*^9}, 3.93330394507805*^9, {3.9333042453115172`*^9, 
   3.933304248900402*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"6fae57be-63f5-4bed-bd2a-437897e95773"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimizing Parameters in pole and PM dimensions", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.8544920118167677`*^9, 3.8544920507583504`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"da6efea5-2765-4b3e-99fc-4997ed78ea2f"],

Cell[TextData[{
 StyleBox["In this section, some iterations are made on solving and computing \
the peak field of the wiggler as a function of the horizontal width of the \
pole. The segmentation in the pole and magnet has been set to",
  Evaluatable->False,
  AspectRatioFixed->True],
 " {1,1,1} resulting in a quick but inaccurate computation."
}], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8513936674668603`*^9, 3.851393674752615*^9}, {
  3.8535565255182357`*^9, 3.8535565333221936`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"a3592047-feec-4b42-88ad-40a01e8a5b1a"],

Cell[TextData[{
 "gap=15;NumPer=1;per=230;gapoffset=0;ending=1;zer={0,0,0};sp={0,0,gap/2};\
subDiv=2;\n\nlm={79,100,79};nm={subDiv,subDiv};cm={0,1,1};\n\
lp={79,15,61};np={subDiv,subDiv};cp={1,0,1};chp={10,0,chmk};\n\
lep={lp[[1]],lp[[2]]-5.5,lp[[3]]};\nchmp={chp[[1]],chp[[2]]};chmk=chp[[1]];\n\
sd=0;\nsdr=0.001;\nsdt=10;\nsdsx=0.001;\nsdsy=0.001;\nsdsz=0.001;\n\n\
F[]:=Module[{},\nlp[[2]]=(per-lm[[2]]*2)/2;\nsp[[3]]=gap/2;\n",
 StyleBox["radUtiDelAll",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nmm=",
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 "[1.29];\nmp=",
 StyleBox["RadMatAFK502",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nund=wig[];\nre=",
 StyleBox["RadSolve",
  FontColor->RGBColor[1, 0, 0]],
 "[und,0.0003,1000];\nN[",
 StyleBox["radFld",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"Bz\",{0,0,0}],4]\n]\n\nt=Table[{y,(gap=y;F[])},{y,5,50,5}];\n\
(*t=Table[{y,(lp[[1]]=y;F[])},{y,30,100,5}];*)\n\
(*t=Table[{y,(lm[[1]]=y;F[])},{y,50,150,5}];*)\n\
(*t=Table[{y,(per=y;F[])},{y,100,300,20}];*)\n\
(*t=Table[{y,(NumPer=y;F[])},{y,2,20,2}];*)\n\
(*t=Table[{y,(np[[1]]=y;F[])},{y,1,5,1}];*)\n\
(*t=Table[{y,(nm[[1]]=y;F[])},{y,1,5,1}];*)\n\
(*t=Table[{y,(nm[[1]]=y;F[])},{y,1,5,1}];*)\n\
(*t=Table[{y,(chp[[1]]=y;F[])},{y,1,15,1}];*)\nt=Prepend[t,headers];\n\
Export[FileNameJoin[{NotebookDirectory[],\"maxField_gap_p\"<>strPoles<>\"_n\"<\
>strSub<>\"_epy\"<>ToString[lep[[2]]]<>\"_NP\"<>ToString[j]<>\"_test.dat\"}],\
t];\nListPlot[t,Joined->True,AxesLabel->{\"NumPer\",\"Peak Field\"}]\n\n(*\n\
t1=AbsoluteTime[];\nFor[j=1,j<=100,j++,(\n\
t=Table[{y,(sdr=y;F[])},{y,0.001,0.101,0.005}];\n\
(*t=Table[{y,(sdt=y;F[])},{y,0.01,20.01,1}];*)\nt=Prepend[t,headers];\n\
Export[FileNameJoin[{NotebookDirectory[],\"maxField_gap_p\"<>strPoles<>\"_n\"<\
>strSub<>\"_epy\"<>ToString[lep[[2]]]<>\"_sdr\"<>ToString[j]<>\".dat\"}],t];\n\
t=0\n)]\nt2=AbsoluteTime[];\nPrint [\"cpu time : \",N[t2-t1,3],\" seconds\"];\
\n*)"
}], "Input",
 CellChangeTimes->{
  3.3999128077182503`*^9, {3.670086569076912*^9, 3.670086570090914*^9}, {
   3.84975796422351*^9, 3.84975796422351*^9}, {3.849758010170967*^9, 
   3.8497580288346553`*^9}, {3.849758096482314*^9, 3.849758096812314*^9}, 
   3.8497581697324505`*^9, {3.8513943592481747`*^9, 3.8513943656779213`*^9}, {
   3.853541546650813*^9, 3.8535415615281825`*^9}, 3.853554333787671*^9, {
   3.853554381902648*^9, 3.8535544156988864`*^9}, {3.8535544756855755`*^9, 
   3.8535545585589266`*^9}, {3.853554749653496*^9, 3.8535547581246333`*^9}, 
   3.8535547975090322`*^9, 3.8535551124473968`*^9, {3.8535552254208317`*^9, 
   3.8535552272888126`*^9}, 3.8535553157323246`*^9, 3.853555345960641*^9, {
   3.8535554326998577`*^9, 3.853555514611102*^9}, {3.8535631852586374`*^9, 
   3.8535631852586374`*^9}, 3.8538233792183914`*^9, {3.854343746160897*^9, 
   3.854343791978351*^9}, {3.854343857213177*^9, 3.8543438714992175`*^9}, {
   3.8543439061641912`*^9, 3.8543439139044003`*^9}, {3.8543439921354294`*^9, 
   3.8543440603325996`*^9}, {3.8543441948287973`*^9, 
   3.8543441977801557`*^9}, {3.854344341109933*^9, 3.854344341109933*^9}, {
   3.8543445474296603`*^9, 3.8543445628416753`*^9}, {3.8543446235584564`*^9, 
   3.8543446235584564`*^9}, 3.8543446569369297`*^9, {3.854344691534068*^9, 
   3.854344726828185*^9}, {3.854344759968051*^9, 3.8543447600965953`*^9}, {
   3.8543447999825697`*^9, 3.8543448129310217`*^9}, 3.854344851731723*^9, {
   3.854344896994212*^9, 3.854344913400282*^9}, {3.8543449533477054`*^9, 
   3.8543449875863295`*^9}, 3.854345214877819*^9, {3.854345433433157*^9, 
   3.8543454434597874`*^9}, {3.854347324579743*^9, 3.854347325121939*^9}, {
   3.8544293852504077`*^9, 3.854429392109395*^9}, {3.854429504572999*^9, 
   3.854429599785128*^9}, {3.8544296368291364`*^9, 3.8544296429240866`*^9}, {
   3.854429694796728*^9, 3.854429694796728*^9}, {3.8544297776203284`*^9, 
   3.854429789892683*^9}, {3.854429820088727*^9, 3.8544298387653513`*^9}, {
   3.8544304080983906`*^9, 3.8544304178784103`*^9}, {3.854430578303263*^9, 
   3.8544306150216155`*^9}, {3.8544306776557875`*^9, 
   3.8544307179310627`*^9}, {3.854430792744999*^9, 3.854430793081359*^9}, {
   3.85443083244681*^9, 3.854430832866598*^9}, {3.854485306324357*^9, 
   3.8544853077643547`*^9}, 3.854485387361941*^9, {3.854485461703277*^9, 
   3.8544854617975674`*^9}, {3.85448567082574*^9, 3.8544856709657526`*^9}, {
   3.8544857277533813`*^9, 3.8544857277533813`*^9}, {3.854485770728446*^9, 
   3.854485770729447*^9}, {3.8544858047098675`*^9, 3.8544858122855444`*^9}, {
   3.854485902317337*^9, 3.8544859380113344`*^9}, {3.8544859823055067`*^9, 
   3.854485988490259*^9}, {3.854486037975329*^9, 3.8544860719230094`*^9}, {
   3.8544861364674296`*^9, 3.8544861812528334`*^9}, 3.8544862738527355`*^9, {
   3.8544864542285767`*^9, 3.854486457464572*^9}, {3.854486662600819*^9, 
   3.8544866717048206`*^9}, {3.854486747041586*^9, 3.854486796982286*^9}, {
   3.854486828158271*^9, 3.8544868519355187`*^9}, {3.8544882124290485`*^9, 
   3.8544882246767454`*^9}, {3.85448830421719*^9, 3.8544883629473605`*^9}, {
   3.854488412273262*^9, 3.8544884489548244`*^9}, {3.854490462214801*^9, 
   3.8544904915727396`*^9}, {3.8544906270884557`*^9, 
   3.8544906617683773`*^9}, {3.854490709198308*^9, 3.854490711910303*^9}, {
   3.8544907483922567`*^9, 3.854490832706109*^9}, {3.854490892276417*^9, 
   3.8544909247100286`*^9}, 3.8544909754108086`*^9, {3.854760260869015*^9, 
   3.85476028127238*^9}, {3.854762052472717*^9, 3.854762053983793*^9}, {
   3.854762089957183*^9, 3.8547620940771713`*^9}, {3.854762272645768*^9, 
   3.8547622741057644`*^9}, 3.8547624255275445`*^9, {3.8556150050713716`*^9, 
   3.85561507531079*^9}, {3.855615231590989*^9, 3.8556153091768985`*^9}, {
   3.8556153592805223`*^9, 3.85561535928452*^9}, {3.855615390111263*^9, 
   3.8556154074365845`*^9}, {3.855615494797606*^9, 3.8556155046786003`*^9}, {
   3.8556155803893304`*^9, 3.855615598516057*^9}, {3.8556157433051915`*^9, 
   3.855615756208087*^9}, {3.855617573192146*^9, 3.8556176124761143`*^9}, {
   3.8556182842193274`*^9, 3.8556182844993415`*^9}, {3.855618369937791*^9, 
   3.8556184066523657`*^9}, {3.8556238158587685`*^9, 
   3.8556238486857967`*^9}, {3.8556239765830727`*^9, 3.855623976820963*^9}, {
   3.855625393266676*^9, 3.8556254073914433`*^9}, {3.8557007604869967`*^9, 
   3.855700815124436*^9}, {3.8558081031433687`*^9, 3.8558081209713583`*^9}, {
   3.87290469376735*^9, 3.872904713879056*^9}, {3.872904797619011*^9, 
   3.872904845047599*^9}, {3.8729049322650795`*^9, 3.8729049551839046`*^9}, {
   3.8729050285489645`*^9, 3.8729050887224216`*^9}, {3.872906678828231*^9, 
   3.8729066878220015`*^9}, {3.872906902877486*^9, 3.872907034954172*^9}, {
   3.8729070795163507`*^9, 3.872907232149472*^9}, {3.8738385971622024`*^9, 
   3.8738386389748955`*^9}, 3.8745484930565534`*^9, 3.8752364975238595`*^9, 
   3.875319188650812*^9, {3.8775754632280245`*^9, 3.8775755598383093`*^9}, 
   3.8775756174769306`*^9, {3.87774856732987*^9, 3.877748591370753*^9}, 
   3.8777486416363754`*^9, 3.877748701672862*^9, {3.8777491143972673`*^9, 
   3.8777491170872164`*^9}, {3.878101337899722*^9, 3.8781013420260305`*^9}, {
   3.8781581340970182`*^9, 3.8781581438249407`*^9}, {3.8783321065983686`*^9, 
   3.8783321730464067`*^9}, 3.878333255058182*^9, 3.878333455863106*^9, {
   3.878333503239978*^9, 3.8783335208240185`*^9}, {3.878333560689023*^9, 
   3.8783336121682363`*^9}, {3.878333660558013*^9, 3.8783336712483854`*^9}, 
   3.878333708564395*^9, 3.878333763304453*^9, {3.8783338345475426`*^9, 
   3.8783339606498566`*^9}, {3.8783526834152703`*^9, 
   3.8783527153753033`*^9}, {3.8783577122690735`*^9, 3.878357770014126*^9}, {
   3.8783578290125732`*^9, 3.878357852114335*^9}, 3.878357904054142*^9, 
   3.8783580276114445`*^9, {3.878358787063139*^9, 3.878358800801998*^9}, {
   3.878358889438442*^9, 3.8783588986485615`*^9}, {3.8786860931630177`*^9, 
   3.8786861747928967`*^9}, {3.8786872933325686`*^9, 
   3.8786873058671894`*^9}, {3.878687355464391*^9, 3.8786874090330176`*^9}, {
   3.879382758993613*^9, 3.879382776216525*^9}, 3.8793843950966673`*^9, {
   3.87938478198074*^9, 3.8793848077290163`*^9}, {3.8793848426007442`*^9, 
   3.8793848564014134`*^9}, {3.879384889112756*^9, 3.8793849028885975`*^9}, {
   3.8793849567492943`*^9, 3.879384957276781*^9}, {3.879385001269616*^9, 
   3.87938503430419*^9}, {3.879385067376799*^9, 3.8793851324708104`*^9}, {
   3.8793851730889425`*^9, 3.8793852221452756`*^9}, {3.879385289905143*^9, 
   3.8793852990013514`*^9}, {3.879385369178832*^9, 3.8793853930111403`*^9}, {
   3.879554861117503*^9, 3.879554864507516*^9}, {3.8795552992857943`*^9, 
   3.87955533181621*^9}, {3.879559156282978*^9, 3.8795591908976126`*^9}, {
   3.879560710687632*^9, 3.8795607215175242`*^9}, 3.8795607757104263`*^9, {
   3.879893506567336*^9, 3.879893506901308*^9}, {3.879980079703237*^9, 
   3.8799801036554785`*^9}, {3.8799801704959745`*^9, 
   3.8799801900946493`*^9}, {3.8799802529096994`*^9, 
   3.8799802704268403`*^9}, {3.879980315138917*^9, 3.8799803226888533`*^9}, {
   3.8799806442579403`*^9, 3.8799806499241114`*^9}, 3.8799807036518803`*^9, 
   3.879980741867178*^9, {3.8799808551579523`*^9, 3.8799808698721914`*^9}, 
   3.8799809108545446`*^9, {3.87998099741446*^9, 3.8799810228584647`*^9}, {
   3.8799811244264297`*^9, 3.8799811516302266`*^9}, {3.9010706278762445`*^9, 
   3.9010707562150235`*^9}, {3.901072074275839*^9, 3.9010721032368617`*^9}, {
   3.9010721353493967`*^9, 3.901072161764559*^9}, 3.9010728452473326`*^9, {
   3.9010729402485394`*^9, 3.901072951569421*^9}, 3.9010729896056504`*^9, {
   3.901073367210737*^9, 3.9010733704799323`*^9}, 3.9010734038573236`*^9, {
   3.901073588849038*^9, 3.9010735896490393`*^9}, {3.9011599154738617`*^9, 
   3.901159951230322*^9}, {3.9011600674822454`*^9, 3.9011600685582476`*^9}, {
   3.90116022409832*^9, 3.9011602266263247`*^9}, 3.901160282534915*^9, 
   3.901160837827498*^9, {3.901160873470873*^9, 3.9011608776548758`*^9}, 
   3.901161070088951*^9, 3.901227066227016*^9, 3.901238253168475*^9, {
   3.9012386797199936`*^9, 3.9012387040948954`*^9}, {3.9012387579617944`*^9, 
   3.90123879865162*^9}, {3.9012388610502453`*^9, 3.9012388861967945`*^9}, {
   3.9012389309062614`*^9, 3.901238943660819*^9}, {3.901238980835219*^9, 
   3.901239002207261*^9}, {3.901239059127819*^9, 3.901239081345154*^9}, {
   3.901239148677355*^9, 3.9012391814155517`*^9}, {3.901239305775419*^9, 
   3.901239392200119*^9}, {3.901239429175379*^9, 3.9012394889155493`*^9}, {
   3.901239739769682*^9, 3.901239742108471*^9}, 3.9012398045012703`*^9, {
   3.9012402041106825`*^9, 3.9012402041226683`*^9}, {3.901240260673608*^9, 
   3.901240260677609*^9}, {3.90124031214384*^9, 3.901240316979848*^9}, {
   3.901240349636443*^9, 3.9012403501084433`*^9}, {3.901240413174387*^9, 
   3.9012404290467443`*^9}, {3.901240870684376*^9, 3.9012408997616653`*^9}, {
   3.901240935728567*^9, 3.9012409457339025`*^9}, {3.901323356511964*^9, 
   3.9013233573151364`*^9}, {3.901326770924779*^9, 3.9013268021530523`*^9}, 
   3.901327271479298*^9, {3.901334693962509*^9, 3.9013347017082253`*^9}, {
   3.9013367683937197`*^9, 3.901336866973748*^9}, {3.9013405192012587`*^9, 
   3.9013405457900047`*^9}, 3.901340954908337*^9, {3.9021846273052835`*^9, 
   3.9021847156813736`*^9}, {3.9021847498647013`*^9, 
   3.9021847510968556`*^9}, {3.902184825703196*^9, 3.90218482679031*^9}, {
   3.9021849425624504`*^9, 3.9021849428511324`*^9}, {3.9021849856908536`*^9, 
   3.902184999773587*^9}, {3.9021850806444016`*^9, 3.9021850868503084`*^9}, 
   3.902185802395351*^9, {3.9021868524500885`*^9, 3.902186860068055*^9}, {
   3.902186923333061*^9, 3.90218695363761*^9}, {3.9021869902354584`*^9, 
   3.902187042866519*^9}, {3.902187168256459*^9, 3.902187170734829*^9}, {
   3.9021875152778826`*^9, 3.902187536961795*^9}, {3.90218756744386*^9, 
   3.902187567826415*^9}, {3.9021879056228037`*^9, 3.902187948768732*^9}, {
   3.90218801074546*^9, 3.9021880112634797`*^9}, 3.902189666008127*^9, {
   3.9025524347544193`*^9, 3.9025524441724105`*^9}, 3.902978375098411*^9, {
   3.902978412537839*^9, 3.9029784185761557`*^9}, {3.9031340390467997`*^9, 
   3.903134065287462*^9}, {3.9031340961140656`*^9, 3.903134097608452*^9}, 
   3.9031482214619865`*^9, {3.9031556966619563`*^9, 3.9031557042633457`*^9}, {
   3.9031564799494705`*^9, 3.903156480099471*^9}, {3.928555848308851*^9, 
   3.9285558490688505`*^9}, {3.9325154799037943`*^9, 3.932515522473092*^9}, {
   3.932516678103247*^9, 3.9325166784774923`*^9}, {3.93251685600072*^9, 
   3.9325168730936637`*^9}, {3.932516924863521*^9, 3.9325169614000206`*^9}, {
   3.9325171212447877`*^9, 3.9325171919247265`*^9}, {3.9326835870872064`*^9, 
   3.9326836070733337`*^9}, {3.93336824993334*^9, 3.933368279473303*^9}},
 AspectRatioFixed->True,
 CellLabel->
  "In[150]:=",ExpressionUUID->"9279ef9f-baea-4903-b5a1-eb035aebc7f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Field integral upon gap, distance to ending units or end side magnet height\
\>", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.8538212453166027`*^9, 3.853821274373686*^9}, {
  3.8543461346002536`*^9, 3.8543461405326567`*^9}, {3.8543464724552937`*^9, 
  3.8543464866451597`*^9}, {3.8544286203074727`*^9, 3.8544286368511343`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"86fab811-3e67-43b6-889c-dabd0fb90927"],

Cell[TextData[{
 StyleBox["In this section, some iterations are made on solving and computing \
the peak field of the wiggler as a function of the horizontal width of the \
pole. The segmentation in the pole and magnet has been set to",
  Evaluatable->False,
  AspectRatioFixed->True],
 " {1,1,1} resulting in a quick but inaccurate computation."
}], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8513936674668603`*^9, 3.851393674752615*^9}, {
  3.8535565255182357`*^9, 3.8535565333221936`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"31fe8877-035f-437e-95c3-29f142885a28"],

Cell[TextData[{
 "gap=15;NumPer=2;per=230;gapoffset=0;ending=1;zer={0,0,0};sp={0,0,gap/2};\
subDiv=2;\n\nlm={79,100,79};nm={subDiv,subDiv};cm={0,1,1};\n\
lp={79,15,61};np={subDiv,subDiv};cp={1,0,1};chp={10,0,chmk};\n\
lep={lp[[1]],lp[[2]]-5.5,lp[[3]]};\nchmp={chp[[1]],chp[[2]]};chmk=10;\n\n\
F[]:=Module[{},\nsp[[3]]=gap/2;\n",
 StyleBox["radUtiDelAll",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nmm=",
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 "[1.29];\nmp=",
 StyleBox["RadMatAFK502",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nund=wig[];\nre=",
 StyleBox["RadSolve",
  FontColor->RGBColor[1, 0, 0]],
 "[und,0.0003,1000];\nN[",
 StyleBox["radFldInt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"inf\",\"ibz\",{0,-2000,0},{0,2000,0}],3]\n]\n\n\
(*t=Table[{y,(gap=y;F[])},{y,5,100,5}];*)\n\
(*t=Table[{y,(dpm[[1]]=y;F[])},{y,0,10,1}];*)\n\
t=Table[{y,(lep[[2]]=y;F[])},{y,5,15,1}];\nt=Prepend[t,headers];\n\
Export[FileNameJoin[{NotebookDirectory[],\"fldint_p\"<>strPoles<>\"_n\"<>\
strSub<>\"_gap\"<>strGap<>\".dat\"}],t];\n\
ListPlot[t,Joined->True,AxesLabel->{\"lesz\",\"fldint\"}]"
}], "Input",
 CellChangeTimes->{
  3.3999128077182503`*^9, {3.670086569076912*^9, 3.670086570090914*^9}, {
   3.84975796422351*^9, 3.84975796422351*^9}, {3.849758010170967*^9, 
   3.8497580288346553`*^9}, {3.849758096482314*^9, 3.849758096812314*^9}, 
   3.8497581697324505`*^9, {3.8513943592481747`*^9, 3.8513943656779213`*^9}, {
   3.853541546650813*^9, 3.8535415615281825`*^9}, 3.853554333787671*^9, {
   3.853554381902648*^9, 3.8535544156988864`*^9}, {3.8535544756855755`*^9, 
   3.8535545585589266`*^9}, {3.853554749653496*^9, 3.8535547581246333`*^9}, 
   3.8535547975090322`*^9, 3.8535551124473968`*^9, {3.8535552254208317`*^9, 
   3.8535552272888126`*^9}, 3.8535553157323246`*^9, 3.853555345960641*^9, {
   3.8535554326998577`*^9, 3.853555514611102*^9}, {3.8535631852586374`*^9, 
   3.8535631852586374`*^9}, {3.853820946709757*^9, 3.853820992352663*^9}, {
   3.8538210292635975`*^9, 3.8538212276462193`*^9}, {3.8538216637963285`*^9, 
   3.853821666890695*^9}, 3.8538218313777018`*^9, {3.8538232976423197`*^9, 
   3.85382329810847*^9}, {3.8538233533517017`*^9, 3.8538233545211697`*^9}, {
   3.8538237173941116`*^9, 3.853823761539635*^9}, {3.8538240342069263`*^9, 
   3.853824091753352*^9}, {3.8538241448056087`*^9, 3.8538241590681543`*^9}, {
   3.85382420145013*^9, 3.853824202015748*^9}, {3.8538888483406324`*^9, 
   3.853888848478819*^9}, {3.854346160389157*^9, 3.854346187154301*^9}, {
   3.8543462549338913`*^9, 3.8543462638154173`*^9}, {3.8543463138876066`*^9, 
   3.8543464028979945`*^9}, {3.8543464381715064`*^9, 
   3.8543464678866777`*^9}, {3.8543470348465805`*^9, 3.854347066860038*^9}, {
   3.854347119135144*^9, 3.8543471201762667`*^9}, {3.854347193381149*^9, 
   3.8543471955584908`*^9}, {3.8543473366444464`*^9, 
   3.8543473506880245`*^9}, {3.8543474482180796`*^9, 3.8543474592167273`*^9}, 
   3.854347505657852*^9, {3.8543475518530116`*^9, 3.8543475532967196`*^9}, {
   3.8544286773810825`*^9, 3.854428893735918*^9}, {3.85442892412844*^9, 
   3.854429008746972*^9}, {3.8544291119482393`*^9, 3.854429188040766*^9}, {
   3.8544294088394475`*^9, 3.8544294099040003`*^9}, {3.8544300074940295`*^9, 
   3.8544300134461827`*^9}, {3.8544302831384735`*^9, 
   3.8544303305425987`*^9}, {3.8544303701891837`*^9, 3.854430397015108*^9}, 
   3.8544304819554763`*^9, {3.854430534358094*^9, 3.8544305462678037`*^9}, {
   3.854430846161438*^9, 3.85443085704523*^9}, {3.8544868914664583`*^9, 
   3.8544868914664583`*^9}, {3.8544869216864653`*^9, 3.85448692648246*^9}, {
   3.854487016340131*^9, 3.854487037868116*^9}, {3.8544870878680935`*^9, 
   3.8544871296060658`*^9}, {3.854487219350472*^9, 3.854487219642736*^9}, {
   3.85448738813402*^9, 3.8544873988639293`*^9}, {3.8544882171249332`*^9, 
   3.8544882878889604`*^9}, {3.8544886056503916`*^9, 3.854488605988163*^9}, {
   3.854490291263158*^9, 3.8544902912671695`*^9}, {3.854490326975089*^9, 
   3.854490337491234*^9}, {3.85562546232686*^9, 3.8556254678469653`*^9}, {
   3.855699415984618*^9, 3.855699438489831*^9}, {3.8558081369772787`*^9, 
   3.8558081509932923`*^9}, {3.8752365719491477`*^9, 
   3.8752365795427213`*^9}, {3.875319199280489*^9, 3.8753192061744432`*^9}, 
   3.87749421615742*^9, {3.8783342791391706`*^9, 3.878334321185274*^9}, {
   3.8783483934650197`*^9, 3.8783483935588646`*^9}, {3.878349207440695*^9, 
   3.8783492559468284`*^9}, {3.878349295144811*^9, 3.878349306153078*^9}, {
   3.878349350818925*^9, 3.878349351114659*^9}, {3.878349408387046*^9, 
   3.8783494302211657`*^9}, {3.878349522762376*^9, 3.878349527888318*^9}, 
   3.879385509092848*^9, 3.8793855608468513`*^9, {3.879385591053582*^9, 
   3.8793856036748576`*^9}, {3.8793857537308464`*^9, 3.879385784478298*^9}, {
   3.8793858171828756`*^9, 3.8793858605852385`*^9}, {3.879893512224905*^9, 
   3.8798935125112495`*^9}, {3.8799819787933445`*^9, 
   3.8799819912981653`*^9}, {3.879982335034233*^9, 3.8799823390358667`*^9}, {
   3.901070975182171*^9, 3.901071018650423*^9}, 3.9010710518852787`*^9, 
   3.901071120065657*^9, {3.901159964006762*^9, 3.9011599645227757`*^9}, 
   3.901227074378205*^9, {3.9021850342230206`*^9, 3.9021850521950235`*^9}, {
   3.9031557130732765`*^9, 3.903155716068684*^9}, {3.903156495987606*^9, 
   3.903156496077607*^9}, {3.932527665070613*^9, 3.932527665308324*^9}, {
   3.9333683003745813`*^9, 3.933368300777605*^9}},
 AspectRatioFixed->True,
 CellLabel->
  "In[179]:=",ExpressionUUID->"7c577dcf-29f6-4104-b3de-12c260e1ee51"],

Cell[TextData[{
 "(* Plot field integral in x axis upon gap, lpx, lesz *)\n\
gap=15;NumPer=2;per=230;gapoffset=0;ending=1;zer={0,0,0};sp={0,0,gap/2};\
subDiv=2;\n\nlm={79,100,79};nm={subDiv,subDiv};cm={0,1,1};\n\
lp={79,15,61};np={subDiv,subDiv};cp={1,0,1};chp={10,0,chmk};\n\
lep={lp[[1]],lp[[2]]-5.5,lp[[3]]};\nchmp={chp[[1]],chp[[2]]};chmk=10;\n\n\
F[]:=Module[{},\n",
 StyleBox["radUtiDelAll",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nmm=",
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 "[1.29];\nmp=",
 StyleBox["RadMatAFK502",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nund=wig[];\nre=",
 StyleBox["RadSolve",
  FontColor->RGBColor[1, 0, 0]],
 "[und,0.0003,1000];\nN[",
 StyleBox["radFldInt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"inf\",\"ibz\",{x0,-2000,z0},{x0,2000,z0}],3]\n]\n\nt={};\n(* \
t=Table[{y1,(x0=y1;F[])},{y1,-5,5,1}];  *)\nFor[z0=-5,z0<=5,z0=z0+1,(\n\
For[x0=-20,x0<=20,x0=x0+1,(\nt0=Table[{z0,x0,(x0;z0;F[])}];\nt=Prepend[t,t0];\
\n)];\n)];\n(* t=Prepend[t,headers]; *)\n\
Export[FileNameJoin[{NotebookDirectory[],\"fldint_x_lesz80_gap\"<>strGap<>\".\
dat\"}],t]\n(* ListPlot[t,Joined->True,AxesLabel->{\"lesz\",\"fldint\"}] *)"
}], "Input",
 CellChangeTimes->{
  3.3999128077182503`*^9, {3.670086569076912*^9, 3.670086570090914*^9}, {
   3.84975796422351*^9, 3.84975796422351*^9}, {3.849758010170967*^9, 
   3.8497580288346553`*^9}, {3.849758096482314*^9, 3.849758096812314*^9}, 
   3.8497581697324505`*^9, {3.8513943592481747`*^9, 3.8513943656779213`*^9}, {
   3.853541546650813*^9, 3.8535415615281825`*^9}, 3.853554333787671*^9, {
   3.853554381902648*^9, 3.8535544156988864`*^9}, {3.8535544756855755`*^9, 
   3.8535545585589266`*^9}, {3.853554749653496*^9, 3.8535547581246333`*^9}, 
   3.8535547975090322`*^9, 3.8535551124473968`*^9, {3.8535552254208317`*^9, 
   3.8535552272888126`*^9}, 3.8535553157323246`*^9, 3.853555345960641*^9, {
   3.8535554326998577`*^9, 3.853555514611102*^9}, {3.8535631852586374`*^9, 
   3.8535631852586374`*^9}, {3.853820946709757*^9, 3.853820992352663*^9}, {
   3.8538210292635975`*^9, 3.8538212276462193`*^9}, {3.8538216637963285`*^9, 
   3.853821666890695*^9}, 3.8538218313777018`*^9, {3.8538232976423197`*^9, 
   3.85382329810847*^9}, {3.8538233533517017`*^9, 3.8538233545211697`*^9}, {
   3.8538237173941116`*^9, 3.853823761539635*^9}, {3.8538240342069263`*^9, 
   3.853824091753352*^9}, {3.8538241448056087`*^9, 3.8538241590681543`*^9}, {
   3.85382420145013*^9, 3.853824202015748*^9}, {3.8538888483406324`*^9, 
   3.853888848478819*^9}, {3.854346160389157*^9, 3.854346187154301*^9}, {
   3.8543462549338913`*^9, 3.8543462638154173`*^9}, {3.8543463138876066`*^9, 
   3.8543464028979945`*^9}, {3.8543464381715064`*^9, 
   3.8543464678866777`*^9}, {3.8543470348465805`*^9, 3.854347066860038*^9}, {
   3.854347119135144*^9, 3.8543471201762667`*^9}, {3.854347193381149*^9, 
   3.8543471955584908`*^9}, {3.8543473366444464`*^9, 
   3.8543473506880245`*^9}, {3.8543474482180796`*^9, 3.8543474592167273`*^9}, 
   3.854347505657852*^9, {3.8543475518530116`*^9, 3.8543475532967196`*^9}, {
   3.8544286773810825`*^9, 3.854428893735918*^9}, {3.85442892412844*^9, 
   3.854429008746972*^9}, {3.8544291119482393`*^9, 3.854429188040766*^9}, {
   3.8544294088394475`*^9, 3.8544294099040003`*^9}, {3.8544300074940295`*^9, 
   3.8544300134461827`*^9}, {3.8544302831384735`*^9, 
   3.8544303305425987`*^9}, {3.8544303701891837`*^9, 3.854430397015108*^9}, 
   3.8544304819554763`*^9, {3.854430534358094*^9, 3.8544305462678037`*^9}, {
   3.854430846161438*^9, 3.85443085704523*^9}, {3.8544868914664583`*^9, 
   3.8544868914664583`*^9}, {3.8544869216864653`*^9, 3.85448692648246*^9}, {
   3.854487016340131*^9, 3.854487037868116*^9}, {3.8544870878680935`*^9, 
   3.8544871296060658`*^9}, {3.854487219350472*^9, 3.854487219642736*^9}, {
   3.85448738813402*^9, 3.8544873988639293`*^9}, {3.8544882171249332`*^9, 
   3.8544882878889604`*^9}, {3.8544886056503916`*^9, 3.854488605988163*^9}, {
   3.854490291263158*^9, 3.8544902912671695`*^9}, {3.854490326975089*^9, 
   3.854490337491234*^9}, {3.85562546232686*^9, 3.8556254678469653`*^9}, {
   3.85563255979209*^9, 3.8556326486889505`*^9}, {3.8556327035304103`*^9, 
   3.855632706890368*^9}, {3.8556327499561634`*^9, 3.8556329007407417`*^9}, {
   3.8556342940461283`*^9, 3.8556345783075795`*^9}, {3.8556346331231422`*^9, 
   3.855634652514516*^9}, {3.8556346854643583`*^9, 3.855634916098587*^9}, {
   3.875236594808142*^9, 3.875236600192322*^9}, 3.8753192260152507`*^9, 
   3.8795582925812836`*^9, {3.8798935441645746`*^9, 3.8798935446412354`*^9}, {
   3.901070996986394*^9, 3.9010710128064203`*^9}, {3.9010710545722065`*^9, 
   3.901071062533637*^9}, {3.9010711129879723`*^9, 3.901071127666154*^9}, 
   3.9012270774862022`*^9, {3.902185635901854*^9, 3.902185648929634*^9}, {
   3.903155720374075*^9, 3.903155724075371*^9}, {3.9031565015757203`*^9, 
   3.9031565016657333`*^9}, {3.927159178230996*^9, 3.9271591816751347`*^9}, {
   3.9271592607815657`*^9, 3.92715928784129*^9}, {3.927160608090339*^9, 
   3.9271606235275717`*^9}, {3.9271606936064835`*^9, 
   3.9271607199938326`*^9}, {3.9271608361799374`*^9, 3.927160847095251*^9}, {
   3.927160903525865*^9, 3.9271609124538407`*^9}, {3.9271610115946207`*^9, 
   3.927161025667387*^9}, {3.927161056342778*^9, 3.927161119964717*^9}, {
   3.927161157249125*^9, 3.927161177496807*^9}, {3.9271612156297555`*^9, 
   3.927161227981633*^9}, {3.9271620794831176`*^9, 3.9271620949111347`*^9}, 
   3.927162173832171*^9, {3.9271629907780046`*^9, 3.927163143524589*^9}, {
   3.9271634859126854`*^9, 3.9271634864808807`*^9}, 3.927165569018289*^9, {
   3.927165611849723*^9, 3.9271656387307053`*^9}, {3.9271657297386956`*^9, 
   3.9271657621223593`*^9}, {3.9271657974797587`*^9, 
   3.9271658105125513`*^9}, {3.927165870337906*^9, 3.927165870588711*^9}, {
   3.9271659267279243`*^9, 3.927165963614115*^9}, {3.9271660020322437`*^9, 
   3.927166044607439*^9}, {3.9271660841276007`*^9, 3.92716608627269*^9}, {
   3.927166253636463*^9, 3.9271662562422795`*^9}, {3.927166286731033*^9, 
   3.9271662955985813`*^9}, {3.9271663505254393`*^9, 3.9271663522623835`*^9}, 
   3.927166385541793*^9, {3.92716657088697*^9, 3.927166672977477*^9}, {
   3.92716672176267*^9, 3.9271667344487157`*^9}, {3.927166785713864*^9, 
   3.927166795136868*^9}, {3.9271672484581795`*^9, 3.927167250391564*^9}, 
   3.9271680951753225`*^9, 3.9271695580156174`*^9, {3.9333683056968255`*^9, 
   3.933368306064123*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"b55ebfdd-804e-4c31-9d32-d62728080c52"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Magnetic force upon gap", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.8538212453166027`*^9, 3.853821274373686*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"f6c6205a-4abc-4639-8baf-7f06c1cc5fe9"],

Cell[TextData[{
 StyleBox["In this section, some iterations are made on solving and computing \
the peak field of the wiggler as a function of the horizontal width of the \
pole. The segmentation in the pole and magnet has been set to",
  Evaluatable->False,
  AspectRatioFixed->True],
 " {1,1,1} resulting in a quick but inaccurate computation."
}], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8513936674668603`*^9, 3.851393674752615*^9}, {
  3.8535565255182357`*^9, 3.8535565333221936`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"fe642e10-e03e-4330-b4e7-e37838182556"],

Cell[TextData[{
 "gap=15;NumPer=2;per=230;gapoffset=0;ending=1;zer={0,0,0};sp={0,0,gap/2};\
subDiv=2;\n\n\
lp={79,(per-lm[[2]]*2)/2,61};np={subDiv,subDiv};cp={1,0,1};chp={10,0,chmk};\n\
lm={79,100,79};nm={subDiv,subDiv};cm={0,1,1};\n\
lep={lp[[1]],lp[[2]]-5.5,lp[[3]]};\nchmp={chp[[1]],chp[[2]]};chmk=10;\n\n\
F[]:=Module[{},\nlp[[2]]=(per-lm[[2]]*2)/2;\nsp[[3]]=gap/2;\n",
 StyleBox["radUtiDelAll",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nmm=",
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 "[1.29];\nmp=",
 StyleBox["RadMatAFK502",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nund=wig[];\nre=",
 StyleBox["RadSolve",
  FontColor->RGBColor[1, 0, 0]],
 "[und,0.0003,1000];\nN[",
 StyleBox["radFldEnrFrc",
  FontColor->RGBColor[1, 0, 0]],
 "[poleF,und,\"\",{1,1,4}][[3]],3]\n]\n\n\
t=Table[{y,(gap=y;F[])},{y,5,200,5}];\nt=Prepend[t,headers];\n\
Export[FileNameJoin[{NotebookDirectory[],\"force_gap.dat\"}],t];\n\
ListPlot[t,Joined->True,AxesLabel->{\"Gap\",\"Force\"}]\n\n\
(*t=Table[{y,(NumPer=y;F[])},{y,1,5,1}];\nt=Prepend[t,headers];\n\
Export[FileNameJoin[{NotebookDirectory[],\"force_pole_odd.dat\"}],t];\n\
ListPlot[t,Joined->True,AxesLabel->{\"Pole\",\"Force\"}]*)"
}], "Input",
 CellChangeTimes->{
  3.3999128077182503`*^9, {3.670086569076912*^9, 3.670086570090914*^9}, {
   3.84975796422351*^9, 3.84975796422351*^9}, {3.849758010170967*^9, 
   3.8497580288346553`*^9}, {3.849758096482314*^9, 3.849758096812314*^9}, 
   3.8497581697324505`*^9, {3.8513943592481747`*^9, 3.8513943656779213`*^9}, {
   3.853541546650813*^9, 3.8535415615281825`*^9}, 3.853554333787671*^9, {
   3.853554381902648*^9, 3.8535544156988864`*^9}, {3.8535544756855755`*^9, 
   3.8535545585589266`*^9}, {3.853554749653496*^9, 3.8535547581246333`*^9}, 
   3.8535547975090322`*^9, 3.8535551124473968`*^9, {3.8535552254208317`*^9, 
   3.8535552272888126`*^9}, 3.8535553157323246`*^9, 3.853555345960641*^9, {
   3.8535554326998577`*^9, 3.853555514611102*^9}, {3.8535631852586374`*^9, 
   3.8535631852586374`*^9}, {3.853820946709757*^9, 3.853820992352663*^9}, {
   3.8538210292635975`*^9, 3.8538212276462193`*^9}, {3.8538216637963285`*^9, 
   3.853821666890695*^9}, 3.8538218313777018`*^9, {3.8538232976423197`*^9, 
   3.85382329810847*^9}, {3.8538233533517017`*^9, 3.8538233545211697`*^9}, {
   3.8538237173941116`*^9, 3.853823761539635*^9}, {3.8538240342069263`*^9, 
   3.853824091753352*^9}, {3.8538241448056087`*^9, 3.8538241590681543`*^9}, {
   3.85382420145013*^9, 3.853824202015748*^9}, {3.8538888483406324`*^9, 
   3.853888848478819*^9}, {3.85434741628821*^9, 3.8543474179116735`*^9}, {
   3.8544885474948807`*^9, 3.854488547638878*^9}, {3.8556139694926414`*^9, 
   3.8556139859248996`*^9}, {3.8556141110789113`*^9, 3.855614148334099*^9}, {
   3.8556147237558565`*^9, 3.8556147246937966`*^9}, {3.855614810108515*^9, 
   3.855614810494492*^9}, {3.8556149010349216`*^9, 3.8556149010349216`*^9}, {
   3.872909863022334*^9, 3.8729098631643353`*^9}, 3.87955829752129*^9, {
   3.8798935537371283`*^9, 3.879893565932222*^9}, 3.8799822869550114`*^9, {
   3.879982322915474*^9, 3.8799823266828036`*^9}, {3.9010711586357193`*^9, 
   3.9010711907370224`*^9}, 3.9012268714493504`*^9, 3.9012270836524897`*^9, 
   3.901227269688684*^9, {3.901227333284139*^9, 3.9012273352481427`*^9}, {
   3.9012273978173823`*^9, 3.9012274161707945`*^9}, {3.902185658875017*^9, 
   3.9021856711822567`*^9}, {3.9325987621764636`*^9, 
   3.9325987802616835`*^9}, {3.9325990446809874`*^9, 
   3.9325990449709954`*^9}, {3.9333683614745827`*^9, 3.9333683619167194`*^9}},
 AspectRatioFixed->True,
 CellLabel->
  "In[194]:=",ExpressionUUID->"6fdeb01d-bf8b-43e4-ab50-17585b125c3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["How to Get Help", "Section",
 Evaluatable->False,
 CellChangeTimes->{3.8545092456532536`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"7fe160c3-17a9-4432-abc7-23d9121950e5"],

Cell[TextData[StyleBox["The following command lists all the functions defined \
in the Radia.exe  file.",
 Evaluatable->False,
 AspectRatioFixed->True]], "Text",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"742ac2b3-d67f-4920-b35d-4703457ac75c"],

Cell["?rad*", "Input",
 AspectRatioFixed->True,
 CellLabel->
  "In[701]:=",ExpressionUUID->"4d7b3697-ab5f-45d8-84ba-8880dfcc4657"],

Cell[TextData[StyleBox["The following command gives the template and the \
description of the function  \"radObjArcCur\".",
 Evaluatable->False,
 AspectRatioFixed->True]], "Text",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"f05d35ce-682b-401a-9b5e-b5bc7ed6b5c4"],

Cell[TextData[{
 "?",
 StyleBox["RadPlot3DOptions",
  FontColor->RGBColor[1, 0, 0]]
}], "Input",
 CellChangeTimes->{3.8495756290006084`*^9, 3.849575828548298*^9},
 AspectRatioFixed->True,
 CellLabel->
  "In[702]:=",ExpressionUUID->"1459a613-b464-440b-86d3-1b2f0448148b"],

Cell[TextData[{
 StyleBox["The following command lists all the functions defined in the \
Init.m file. These functions are fully written in ",
  Evaluatable->False,
  AspectRatioFixed->True],
 StyleBox["Mathematica",
  Evaluatable->False,
  AspectRatioFixed->True,
  FontSlant->"Italic"],
 StyleBox[" code ",
  Evaluatable->False,
  AspectRatioFixed->True]
}], "Text",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"284281e6-6e4f-4ae1-9e97-69b9d9742e53"],

Cell["?Rad*", "Input",
 AspectRatioFixed->True,
 CellLabel->
  "In[703]:=",ExpressionUUID->"05136f8d-7cda-4537-9b50-de11ac86b179"],

Cell[TextData[{
 "The following command gives the full mathematica definition of the function \
\"RadMatAFK502\" as defined in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 ". "
}], "Text",ExpressionUUID->"24c81614-623f-4844-81ed-bc4048b37110"],

Cell[BoxData[
 RowBox[{"??", 
  StyleBox["radFldFocKickPer",
   FontColor->RGBColor[1, 0, 0]]}]], "Input",
 CellChangeTimes->{
  3.8495758510074816`*^9, 3.8495759120888677`*^9, {3.8495760884780216`*^9, 
   3.849576104682849*^9}, 3.927153811903002*^9, {3.9285384521862774`*^9, 
   3.9285384643146887`*^9}, 3.9285488183520856`*^9, 3.9294077897170663`*^9, 
   3.931305861077851*^9, 3.932782563952468*^9, {3.932786899863312*^9, 
   3.9327869011433105`*^9}, 3.932786944141128*^9, 3.9331175716511693`*^9},
 CellLabel->
  "In[528]:=",ExpressionUUID->"f8fc8852-812b-4696-aca0-0afef93de670"]
}, Open  ]]
},
PrintingStyleEnvironment->"Working",
WindowToolbars->"EditBar",
CellGrouping->Manual,
WindowSize->{1218.75, 841.5},
WindowMargins->{{-1308, Automatic}, {Automatic, 55.5}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PageHeaders->{{
   Cell[
    TextData[{
      CounterBox["Page"]}], "PageNumber"], Inherited, 
   Cell[
    TextData[{
      ValueBox["FileName"]}], "Header"]}, {
   Cell[
    TextData[{
      ValueBox["FileName"]}], "Header"], Inherited, 
   Cell[
    TextData[{
      CounterBox["Page"]}], "PageNumber"]}},
PrintingOptions->{"FacingPages"->True,
"FirstPageHeader"->False,
"PrintCellBrackets"->False,
"PrintMultipleHorizontalPages"->False,
"PrintRegistrationMarks"->False,
"PrintingMargins"->{{54, 54}, {72, 72}}},
ShowSelection->True,
TaggingRules-><|"TryRealOnly" -> False|>,
ShowCellLabel->False,
ShowCellTags->False,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Classroom.nb",
ExpressionUUID->"da620b4a-ee51-49b8-852a-a9524d17fdf4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 559, 12, 55, "Title",ExpressionUUID->"80f95f21-688f-466a-be74-1c788a5280bc",
 Evaluatable->False],
Cell[1107, 34, 201, 4, 24, "Text",ExpressionUUID->"2cf92360-50b0-457e-9c90-a3c2cc5e2c8a",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[1333, 42, 135, 3, 54, "Section",ExpressionUUID->"61178415-e883-4c84-ac7e-e8b13f3d9ce8",
 Evaluatable->False],
Cell[1471, 47, 3020, 56, 230, "Text",ExpressionUUID->"717b5375-299b-4a73-b1c4-5b4c657d9166",
 Evaluatable->False]
}, Open  ]],
Cell[CellGroupData[{
Cell[4528, 108, 148, 3, 54, "Section",ExpressionUUID->"dcd0e42c-1b7c-44b2-ace2-3d9a57a69efb",
 Evaluatable->False],
Cell[4679, 113, 275, 6, 24, "Text",ExpressionUUID->"55364a9b-41af-4208-be09-cf8c70609193",
 Evaluatable->False],
Cell[4957, 121, 480, 13, 82, "Input",ExpressionUUID->"0a81d872-9815-47a6-a8ca-b399b670058c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5474, 139, 218, 4, 54, "Section",ExpressionUUID->"252e519d-81eb-497c-88b0-81b5bad93f75",
 Evaluatable->False],
Cell[5695, 145, 852, 21, 41, "Text",ExpressionUUID->"e6a5c227-0ba1-40b6-9f43-47dbab68bcd6",
 Evaluatable->False],
Cell[6550, 168, 1222, 21, 320, "Input",ExpressionUUID->"dc1242ef-4d98-4bd0-ab04-28bea0ccd1bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7809, 194, 757, 22, 54, "Section",ExpressionUUID->"6448deeb-d2ba-43c7-8b1b-7a7791494f61",
 Evaluatable->False],
Cell[8569, 218, 574, 10, 41, "Text",ExpressionUUID->"e745422a-8ea8-4e90-9e99-c52555fec598",
 Evaluatable->False],
Cell[9146, 230, 42259, 714, 3040, "Input",ExpressionUUID->"55d175db-2e2d-4acd-b57c-348bc9f05e56"]
}, Closed]],
Cell[CellGroupData[{
Cell[51442, 949, 607, 20, 34, "Section",ExpressionUUID->"299921ee-134d-47aa-b8be-840f476c3a44",
 Evaluatable->False],
Cell[52052, 971, 574, 10, 41, "Text",ExpressionUUID->"4e552465-4ec0-4637-a637-47ed123e34e8",
 Evaluatable->False],
Cell[52629, 983, 30309, 536, 2428, "Input",ExpressionUUID->"c55f66be-e2ff-4d35-b2a5-2eb6f91ef814"]
}, Closed]],
Cell[CellGroupData[{
Cell[82975, 1524, 236, 5, 34, "Section",ExpressionUUID->"41b9a76f-0607-4676-9b4f-a188723677db",
 Evaluatable->False],
Cell[83214, 1531, 990, 30, 41, "Text",ExpressionUUID->"5e0d4460-f976-471c-bfde-5c529251cdb7",
 Evaluatable->False],
Cell[84207, 1563, 28537, 396, 915, "Input",ExpressionUUID->"f9610f9d-2237-404b-bdbc-ee8eeedef1ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112781, 1964, 206, 4, 54, "Section",ExpressionUUID->"6a40f96f-68cb-45d3-903a-0cca6a81d7d5",
 Evaluatable->False],
Cell[112990, 1970, 246, 6, 24, "Text",ExpressionUUID->"5e3354bb-12e3-478d-8e39-b51d423c832d",
 Evaluatable->False],
Cell[113239, 1978, 4218, 67, 184, "Input",ExpressionUUID->"c7896b99-1018-444a-acab-41eef79736aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117494, 2050, 128, 3, 54, "Section",ExpressionUUID->"f2047b13-2bc0-4c07-9f29-d3a1640badca",
 Evaluatable->False],
Cell[117625, 2055, 303, 7, 24, "Text",ExpressionUUID->"74e90033-9ad3-4443-87b6-7ba9132b1854",
 Evaluatable->False],
Cell[117931, 2064, 1501, 30, 235, "Input",ExpressionUUID->"177175c9-89ec-406b-9603-c0cf26effe5b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119469, 2099, 190, 4, 54, "Section",ExpressionUUID->"13a563cc-9ccb-4a8d-94c4-8905ca7468b5",
 Evaluatable->False],
Cell[119662, 2105, 2238, 37, 201, "Input",ExpressionUUID->"c23c1001-0828-48db-935f-f2cd6a792019"],
Cell[121903, 2144, 1629, 30, 184, "Input",ExpressionUUID->"e9f58193-654c-4f92-8a2c-0c0bd8095936"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123569, 2179, 153, 3, 54, "Section",ExpressionUUID->"e828e54d-83b4-4eec-9b65-9a304282b9bf",
 Evaluatable->False],
Cell[123725, 2184, 358, 7, 24, "Text",ExpressionUUID->"f141ba92-ffae-45d5-8d00-15d26515a7ef",
 Evaluatable->False],
Cell[124086, 2193, 1891, 37, 252, "Input",ExpressionUUID->"9113889a-20af-485c-be53-acb2e2734784"]
}, Closed]],
Cell[CellGroupData[{
Cell[126014, 2235, 243, 5, 34, "Section",ExpressionUUID->"e04a0304-5016-4e5e-8082-9f5a6046bd21",
 Evaluatable->False],
Cell[126260, 2242, 5953, 86, 337, "Input",ExpressionUUID->"87010605-74fc-48a9-915f-936cc44eff69"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132250, 2333, 213, 4, 54, "Section",ExpressionUUID->"a2a1ed25-3eb1-4bb4-a51c-16e39b7cdbb1",
 Evaluatable->False],
Cell[132466, 2339, 3832, 58, 167, "Input",ExpressionUUID->"2148320c-9341-4d90-84da-6b03cbbe43c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136335, 2402, 273, 5, 54, "Section",ExpressionUUID->"9f4fbd33-34e8-4c18-a846-4d6c516cc774",
 Evaluatable->False],
Cell[136611, 2409, 312, 7, 24, "Text",ExpressionUUID->"547c101f-275c-4514-9faf-65051eb7d800",
 Evaluatable->False],
Cell[136926, 2418, 6330, 140, 257, "Input",ExpressionUUID->"38b94814-3bb7-4c90-8e7f-ddbabc2517b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143293, 2563, 138, 3, 54, "Section",ExpressionUUID->"d15fabc2-96b4-4a55-b25d-8819783997ee",
 Evaluatable->False],
Cell[143434, 2568, 891, 20, 41, "Text",ExpressionUUID->"b91a60b9-8c56-4759-a8a7-0709b316b6a3",
 Evaluatable->False],
Cell[144328, 2590, 1722, 42, 134, "Input",ExpressionUUID->"49ef75ca-1487-4a29-b498-91c185383a97"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146087, 2637, 202, 4, 54, "Section",ExpressionUUID->"fe48622e-8603-4276-9d1f-bfe344babb35",
 Evaluatable->False],
Cell[146292, 2643, 949, 15, 41, "Text",ExpressionUUID->"37c612b7-6e4f-42bb-a3d5-cf02b4880eae",
 Evaluatable->False],
Cell[147244, 2660, 16293, 342, 468, "Input",ExpressionUUID->"6fae57be-63f5-4bed-bd2a-437897e95773"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163574, 3007, 240, 4, 54, "Section",ExpressionUUID->"da6efea5-2765-4b3e-99fc-4997ed78ea2f",
 Evaluatable->False],
Cell[163817, 3013, 583, 12, 41, "Text",ExpressionUUID->"a3592047-feec-4b42-88ad-40a01e8a5b1a",
 Evaluatable->False],
Cell[164403, 3027, 12760, 188, 864, "Input",ExpressionUUID->"9279ef9f-baea-4903-b5a1-eb035aebc7f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177200, 3220, 430, 8, 54, "Section",ExpressionUUID->"86fab811-3e67-43b6-889c-dabd0fb90927",
 Evaluatable->False],
Cell[177633, 3230, 583, 12, 41, "Text",ExpressionUUID->"31fe8877-035f-437e-95c3-29f142885a28",
 Evaluatable->False],
Cell[178219, 3244, 5489, 89, 422, "Input",ExpressionUUID->"7c577dcf-29f6-4104-b3de-12c260e1ee51"],
Cell[183711, 3335, 6500, 101, 507, "Input",ExpressionUUID->"b55ebfdd-804e-4c31-9d32-d62728080c52"]
}, Open  ]],
Cell[CellGroupData[{
Cell[190248, 3441, 214, 4, 54, "Section",ExpressionUUID->"f6c6205a-4abc-4639-8baf-7f06c1cc5fe9",
 Evaluatable->False],
Cell[190465, 3447, 583, 12, 41, "Text",ExpressionUUID->"fe642e10-e03e-4330-b4e7-e37838182556",
 Evaluatable->False],
Cell[191051, 3461, 3633, 63, 490, "Input",ExpressionUUID->"6fdeb01d-bf8b-43e4-ab50-17585b125c3a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[194721, 3529, 182, 4, 54, "Section",ExpressionUUID->"7fe160c3-17a9-4432-abc7-23d9121950e5",
 Evaluatable->False],
Cell[194906, 3535, 265, 6, 24, "Text",ExpressionUUID->"742ac2b3-d67f-4920-b35d-4703457ac75c",
 Evaluatable->False],
Cell[195174, 3543, 130, 3, 48, "Input",ExpressionUUID->"4d7b3697-ab5f-45d8-84ba-8880dfcc4657"],
Cell[195307, 3548, 283, 6, 24, "Text",ExpressionUUID->"f05d35ce-682b-401a-9b5e-b5bc7ed6b5c4",
 Evaluatable->False],
Cell[195593, 3556, 270, 8, 48, "Input",ExpressionUUID->"1459a613-b464-440b-86d3-1b2f0448148b"],
Cell[195866, 3566, 472, 15, 24, "Text",ExpressionUUID->"284281e6-6e4f-4ae1-9e97-69b9d9742e53",
 Evaluatable->False],
Cell[196341, 3583, 130, 3, 48, "Input",ExpressionUUID->"05136f8d-7cda-4537-9b50-de11ac86b179"],
Cell[196474, 3588, 251, 6, 24, "Text",ExpressionUUID->"24c81614-623f-4844-81ed-bc4048b37110"],
Cell[196728, 3596, 582, 11, 46, "Input",ExpressionUUID->"f8fc8852-812b-4696-aca0-0afef93de670"]
}, Open  ]]
}
]
*)

