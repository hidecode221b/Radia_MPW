(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    132882,       2614]
NotebookOptionsPosition[    124660,       2439]
NotebookOutlinePosition[    125861,       2484]
CellTagsIndexPosition[    125818,       2481]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 " ",
 StyleBox["Example # 3 : Generic Hybrid Undulator/Wiggler",
  FontSize->24]
}], "Title",
 Evaluatable->False,
 CellChangeTimes->{{3.8522690276706476`*^9, 3.852269055214794*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"80f95f21-688f-466a-be74-1c788a5280bc"],

Cell["Version 0.7", "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.3999131561401253`*^9, 3.3999131562026253`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"2cf92360-50b0-457e-9c90-a3c2cc5e2c8a"],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"61178415-e883-4c84-ac7e-e8b13f3d9ce8"],

Cell[TextData[{
 StyleBox["This example creates and solves a simple ",
  Evaluatable->False,
  AspectRatioFixed->True],
 StyleBox["multipole wiggler",
  Evaluatable->False,
  AspectRatioFixed->True,
  FontColor->RGBColor[1, 0, 0]],
 StyleBox[" made with rectangular blocks. It is important to execute each \
section in the order of presentation. If not, errors may be reported. Any \
section can be edited and executed several times. To see the change in the \
peak field induced by the variation of the magnet size, edit the \
corresponding parameter in the section entitled \"Create the Geometry\", \
execute this section and re-execute the section \"Solve\". The section \
\"Optimizing Parameters\" provides an example of manual optimization of the \
pole dimensions.",
  Evaluatable->False,
  AspectRatioFixed->True],
 "\n",
 StyleBox["To obtain acceptable precision on the magnetic field, it is \
essential to increase the segmentation. This is done at the expense of memory \
and CPU time. The segmentation in this example has been set to",
  Evaluatable->False,
  AspectRatioFixed->True],
 " np={2,2,5} for the pole and nm={1,3,1} for the magnet. ",
 StyleBox["This corresponds to an absolute error in the peak field of the \
undulator/wiggler of the order of 1%. The user himself should experience \
consequences of   increasing np and nm and see how CPU time and memory \
increase, and how the value of the peak field approaches a limit which is the \
value looked for. To do so, edit the nm or np values in the \"Create the \
Geometry\" section, and re-execute both the \"Create the Geometry\" and \
\"Solve\" sections. Using segmentation which is too large segmentation may \
result in a memory allocation failure. To recover from such situation, the \
section \"Load and Initialize Radia\" should be re-executed. Memory \
allocation failure can be avoided (to some extent) by giving more memory to \
the Radia.exe process (Macintosh). \nIt is a fact that iron pieces need much \
more segmentation than the magnets since the magnetization there is very \
sensitive to the external field.",
  Evaluatable->False,
  AspectRatioFixed->True],
 "\n",
 StyleBox["One can also compute the Field Integral produced by such an \
undulator/wiggler, forces on the magnets and poles, etc. One can build a \
wedge pole undulator by using polyhedrons or extruded polygons instead of \
rectangular blocks... To learn more, read the Radia documentation, make tests \
and develop experience.",
  Evaluatable->False,
  AspectRatioFixed->True]
}], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8513921441309104`*^9, 3.8513922102984095`*^9}, {
  3.8513935551117973`*^9, 3.851393555580782*^9}, {3.8520021545058613`*^9, 
  3.8520022204435062`*^9}, {3.8520023807343063`*^9, 3.8520023832834373`*^9}, {
  3.8520024660891976`*^9, 3.8520024674644113`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"717b5375-299b-4a73-b1c4-5b4c657d9166"]
}, Closed]],

Cell[CellGroupData[{

Cell["Load and Initialize Radia", "Section",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"dcd0e42c-1b7c-44b2-ace2-3d9a57a69efb"],

Cell["\<\
The following instruction loads the Radia package and returns the Radia \
version number. This notebook requires the Radia version 4.097 or later. \
\>", "Text",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"55364a9b-41af-4208-be09-cf8c70609193"],

Cell[TextData[{
 "<<",
 StyleBox["Radia",
  FontColor->RGBColor[1, 0, 0]],
 "`;\n(* if Vector field plot is required *)\n<<",
 StyleBox["VectorFieldPlots",
  FontColor->RGBColor[1, 0, 0]],
 "`;"
}], "Input",
 CellChangeTimes->{{3.849758400450985*^9, 3.8497584006409974`*^9}, {
  3.852002529443336*^9, 3.8520025846595936`*^9}},
 AspectRatioFixed->True,
 CellLabel->"In[1]:=",ExpressionUUID->"0a81d872-9815-47a6-a8ca-b399b670058c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Define Magnetic Material ", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.3999127515151253`*^9, 3.3999127519057503`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"252e519d-81eb-497c-88b0-81b5bad93f75"],

Cell[TextData[{
 StyleBox["The following instructions define a material by means of the \
Magnetization M (in Tesla) vs H (in Amp/m) dependence entered point by point. \
The resulting M(H) curve is plotted for verification. Note that the material \
is defined by calling the function \"",
  Evaluatable->False,
  AspectRatioFixed->True],
 "radMatSatIso",
 StyleBox["\" with the input parameter \"ma\" which contains the values of H \
and M both expressed in Tesla. The conversion between Amp/m and Tesla is done \
by multiplying H by \"",
  Evaluatable->False,
  AspectRatioFixed->True],
 "4*Pi*10^(-7)",
 StyleBox["\" when creating \"ma\". ",
  Evaluatable->False,
  AspectRatioFixed->True]
}], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.851393613332869*^9, 
  3.8513936281796865`*^9}},ExpressionUUID->"e6a5c227-0ba1-40b6-9f43-\
47dbab68bcd6"],

Cell[TextData[{
 "H = {0.8, 1.5, 2.2, 3.6, 5, 6.8, 9.8, 18, 28, 37.5, 42, 55, 71.5, 80, 85, \
88, 92, 100, 120, 150, 200, 300, 400, 600, 800, 1000, 2000, 4000, 6000, \
10000, 25000, 40000};\n\nM = {0.000998995, 0.00199812, 0.00299724, \
0.00499548,0.00699372, 0.00999145, 0.0149877, 0.0299774, 0.0499648, \
0.0799529, 0.0999472, 0.199931, 0.49991, 0.799899, 0.999893, 1.09989, \
1.19988, 1.29987, 1.41985, 1.49981, 1.59975, 1.72962, 1.7995, 1.89925, \
1.96899, 1.99874,  2.09749, 2.19497, 2.24246, 2.27743, 2.28958, 2.28973};\n\n\
ma =  N[Table[{H[[i]]*4*Pi*10^(-7), M[[i]]}, {i, 1, Length[H]}]];\n\n",
 StyleBox["RadPlotOptions",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nListPlot[ma,\nJoined->True,\nAxesLabel->{\"H [Tesla]\",\"Mag \
[Tesla]\"}]\n\nListPlot[ma,\nJoined->True,\nPlotRange->{{0,0.001},{0,2.2}},\n\
AxesLabel->{\"H [Tesla]\",\"Mag [Tesla]\"}]\n\nmp=",
 StyleBox["radMatSatIso",
  FontColor->RGBColor[1, 0, 0]],
 "[ma];"
}], "Input",
 CellChangeTimes->{{3.6700863622205486`*^9, 3.6700863679301586`*^9}, {
   3.6700864088334303`*^9, 3.670086412078236*^9}, {3.8495772906656523`*^9, 
   3.8495773035543327`*^9}, 3.849577391661707*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"dc1242ef-4d98-4bd0-ab04-28bea0ccd1bc"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Functions for ",
 StyleBox["odd",
  FontColor->RGBColor[0, 0, 1]],
 " numbers of pole ",
 StyleBox["(you can choose either ",
  FontColor->RGBColor[1, 0.5, 0.5]],
 StyleBox["odd",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" or ",
  FontColor->RGBColor[1, 0.5, 0.5]],
 StyleBox["even",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox[" poles)",
  FontColor->RGBColor[1, 0.5, 0.5]]
}], "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.8517441074228277`*^9, 3.85174414307524*^9}, {
   3.852269488190855*^9, 3.8522694891287975`*^9}, {3.853540441097062*^9, 
   3.8535404602810397`*^9}, 3.853541270546728*^9, {3.8535432063182297`*^9, 
   3.853543224154854*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"6448deeb-d2ba-43c7-8b1b-7a7791494f61"],

Cell[TextData[StyleBox["The following function builds an array of rectangular \
permanent magnets with their mirror symmetric counterparts, distributes the \
colors, magnetic materials and sets the segmentation. The function is very \
generic and can be used to build almost any hybrid wiggler (without \
optimizing the design of terminations).",
 Evaluatable->False,
 AspectRatioFixed->True]], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8520029100751266`*^9, 3.852002911070096*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"e745422a-8ea8-4e90-9e99-c52555fec598"],

Cell[TextData[{
 "wig[]:=Module[{},\n\n(* A model for odd numbers in main poles *)\n\n",
 StyleBox["(* First Principal Pole *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ny=lp[[2]]/4;\n\
p1={{lp[[1]]/4-chp[[1]]/2,y-chp[[2]]/2,sp[[3]]},{lp[[1]]/2-chp[[1]],lp[[2]]/2-\
chp[[2]]}};\np2={{lp[[1]]/4,y,chp[[3]]+sp[[3]]},{lp[[1]]/2,lp[[2]]/2}};\n\
p3={{lp[[1]]/4,y,lp[[3]]+sp[[3]]},{lp[[1]]/2,lp[[2]]/2}};\npole0=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{p1,p2,p3},zer];\nnpd={np[[2]],np[[2]]/2,np[[1]]};\n\
fullMag[pole0,npd,cp,mp];\n\n",
 StyleBox["(* First side magnet *)",
  FontColor->RGBColor[0, 0, 1]],
 "\nIf[NumPer==0,initsm={-1,0,0},initsm={1,0,0}];\n\
s1={{(lp[[1]]-chp[[1]]+lsm[[1]]-chm[[1]])/2+sp[[1]],y-chp[[2]]/2,sp[[3]]+\
gapoffset},{chp[[1]]+lsm[[1]]-chm[[1]],lsm[[2]]/2-chp[[2]]}};\n\
s2={{(lp[[1]]+lsm[[1]])/2+sp[[1]],y,chm[[3]]+sp[[3]]+gapoffset},{lsm[[1]],lsm[\
[2]]/2}};\n\
s3={{(lp[[1]]+lsm[[1]])/2+sp[[1]],y,lsm[[3]]+sp[[3]]+gapoffset},{lsm[[1]],lsm[\
[2]]/2}};\nside0=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{s1,s2,s3},initsm];\nnpd={np[[1]]/2,np[[2]]/2,np[[2]]};\n\
nmd={nm[[1]]/2,nm[[2]]/2,nm[[2]]};\nfullMag[side0,nmd,csm,mm];\ny+=lp[[2]]/4;\
\n\nFor[i=1,i<=NumPer,i++,(\n",
 StyleBox["(* Periodic Magnet 1 *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ninitm={0,Mod[i,2]-Mod[i+1,2],0};\ny+=lm[[2]]/4+sp[[2]];\n\
m1={{lm[[1]]/4-chm[[1]]/2,y-chm[[2]]/2,sp[[3]]+gapoffset},{lm[[1]]/2-chm[[1]],\
lm[[2]]/2+chm[[2]]}};\n\
m2={{lm[[1]]/4,y,chm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]/2}};\n\
m3={{lm[[1]]/4,y,lm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]/2}};\n\
magnetP1=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{m1,m2,m3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magnetP1,nmd,cm,mm];\n\n",
 StyleBox["(* Periodic Magnet 2 *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ny+=lm[[2]]/2+sp[[2]];\n\
m1={{lm[[1]]/4-chm[[1]]/2,y+chm[[2]]/2,sp[[3]]+gapoffset},{lm[[1]]/2-chm[[1]],\
lm[[2]]/2+chm[[2]]}};\n\
m2={{lm[[1]]/4,y,chm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]/2}};\n\
m3={{lm[[1]]/4,y,lm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]/2}};\n\
magnetP2=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{m1,m2,m3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magnetP2,nmd,cm,mm];\n\n",
 StyleBox["(* Periodic Pole *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ny+=(lm[[2]]/2+lp[[2]])/2+sp[[2]];\n\
p1={{lp[[1]]/4-chp[[1]]/2,y,sp[[3]]},{lp[[1]]/2-chp[[1]],lp[[2]]-2*chp[[2]]}};\
\np2={{lp[[1]]/4,y,chp[[3]]+sp[[3]]},{lp[[1]]/2,lp[[2]]}};\n\
p3={{lp[[1]]/4,y,lp[[3]]+sp[[3]]},{lp[[1]]/2,lp[[2]]}};\npoleP=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{p1,p2,p3},zer];\nnpd={np[[2]],np[[2]],np[[1]]};\n\
fullMag[poleP,npd,cp,mp];\n\n",
 StyleBox["(* Periodic side magnet *)",
  FontColor->RGBColor[0, 0, 1]],
 "\nIf[NumPer==0,initsm={Mod[i,2]-Mod[i+1,2],0,0},initsm={Mod[i+1,2]-Mod[i,2],\
0,0}];\ns1={{(lp[[1]]-chp[[1]]+lsm[[1]]-chm[[1]])/2+sp[[1]],y,sp[[3]]+\
gapoffset},{chp[[1]]+lsm[[1]]-chm[[1]],lsm[[2]]-2*chp[[2]]}};\n\
s2={{(lp[[1]]+lsm[[1]])/2+sp[[1]],y,chm[[3]]+sp[[3]]+gapoffset},{lsm[[1]],lsm[\
[2]]}};\ns3={{(lp[[1]]+lsm[[1]])/2+sp[[1]],y,lsm[[3]]+sp[[3]]+gapoffset},{lsm[\
[1]],lsm[[2]]}};\nsideP=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{s1,s2,s3},initsm];\nnpd={np[[1]]/2,np[[2]],np[[2]]};\n\
nmd={nm[[1]]/2,nm[[2]],nm[[2]]};\nfullMag[sideP,nmd,csm,mm];\ny+=lp[[2]]/2;\n\
\nIf[i==1,magnet1=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{magnetP1,magnetP2}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet1,{magnetP1,magnetP2}]];\nIf[i==1,pole1=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{poleP}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[pole1,{poleP}]];\nIf[i==1,side1=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{sideP}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[side1,{sideP}]];\n(*",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{poleP,mangetP1,magnetP2,sideP}];*)\n)];\n\n",
 StyleBox["(* Magnet before End pole *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ninitm={0,Mod[NumPer+1,2]-Mod[NumPer,2],0};\ny+=lm[[2]]/2+sp[[2]];\n\
m1={{lm[[1]]/4-chm[[1]]/2,y,sp[[3]]+gapoffset},{lm[[1]]/2-chm[[1]],lm[[2]]+2*\
chm[[2]]}};\n\
m2={{lm[[1]]/4,y,chm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]}};\n\
m3={{lm[[1]]/4,y,lm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]}};\nmagnet2=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{m1,m2,m3},initm];\nnmd={nm[[2]],nm[[1]]*2,nm[[2]]};\n\
fullMag[magnet2,nmd,cm,mm];\n\n",
 StyleBox["(* End pole *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ny+=(lm[[2]]+lep[[2]])/2+sp[[2]]+dpm[[1]];\n\
p1={{lep[[1]]/4-chp[[1]]/2,y,sp[[3]]},{lep[[1]]/2-chp[[1]],lep[[2]]-2*chp[[2]]\
}};\np2={{lep[[1]]/4,y,chp[[3]]+sp[[3]]},{lep[[1]]/2,lep[[2]]}};\n\
p3={{lep[[1]]/4,y,lep[[3]]+sp[[3]]},{lep[[1]]/2,lep[[2]]}};\npole2=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{p1,p2,p3},zer];\nnpd={np[[2]],np[[2]]/2,np[[1]]};\n\
fullMag[pole2,npd,cp,mp];\n\n",
 StyleBox["(* End side magnet *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ninitsm={Mod[NumPer,2]-Mod[NumPer+1,2],0,0};\n\
s1={{(lep[[1]]-chp[[1]]+les[[1]]-chm[[1]])/2+sp[[1]],y,sp[[3]]+gapoffset},{\
chp[[1]]+les[[1]]-chm[[1]],les[[2]]-2*chp[[2]]}};\n\
s2={{(lep[[1]]+les[[1]])/2+sp[[1]],y,chm[[3]]+sp[[3]]+gapoffset},{les[[1]],\
les[[2]]}};\n\
s3={{(lep[[1]]+les[[1]])/2+sp[[1]],y,les[[3]]+sp[[3]]+gapoffset},{les[[1]],\
les[[2]]}};\nside2=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{s1,s2,s3},initsm];\nnpd={np[[1]]/2,np[[2]]/2,np[[2]]};\n\
nmd={nm[[1]]/2,nm[[2]]/2,nm[[2]]};\nfullMag[side2,nmd,csm,mm];\n\n",
 StyleBox["(* End magnet for half size and unit model *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ninitm={0,Mod[NumPer,2]-Mod[NumPer+1,2],0};\n\
If[(NumPer==0)||(ending==0),y+=lm[[2]]/4+lep[[2]]/2-lm[[2]]-lep[[2]]-sp[[2]]-\
dpm[[1]],y+=lm[[2]]/4+lep[[2]]/2+sp[[2]]+dpm[[2]]];\n\
m1={{lm[[1]]/4-chm[[1]]/2,y-chm[[2]]/2,sp[[3]]+gapoffset},{lm[[1]]/2-chm[[1]],\
lm[[2]]/2+chm[[2]]}};\n\
m2={{lm[[1]]/4,y,chm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]/2}};\n\
m3={{lm[[1]]/4,y,lm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]/2}};\nmagEnd=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{m1,m2,m3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magEnd,nmd,cm,mm];\n\nIf[NumPer==0,magnet=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{magEnd}],magnet=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{magnet1,magnet2,magEnd}]];\nIf[NumPer==0,pole=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole0}],pole=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole0,pole1,pole2}]];\nIf[NumPer==0,side=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{side0}],side=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{side0,side1,side2}]];\nIf[NumPer==0,und=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole0,side0}],und=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole0,pole1,side0,side1,magnet1}]];\nIf[(NumPer==0)||(ending==0),",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{magEnd}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{magnet2,pole2,side2,magEnd}]];\n\ntr=",
 StyleBox["radTrfTrsl",
  FontColor->RGBColor[1, 0, 0]],
 "[{0,0,gap/2}];\n",
 StyleBox["radTrfOrnt",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet,tr];\n",
 StyleBox["radTrfOrnt",
  FontColor->RGBColor[1, 0, 0]],
 "[pole,tr];\n",
 StyleBox["radTrfOrnt",
  FontColor->RGBColor[1, 0, 0]],
 "[side,tr];\n",
 StyleBox["radTrfOrnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,tr];\n\n(* Mirrors *)\n",
 StyleBox["RadTrfZerPerp",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{0,0,0},{1,0,0}];\nIf[(NumPer==0)&&(ending==0),\"\",",
 StyleBox["RadTrfZerPara",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{0,0,0},{0,0,1}]];\n",
 StyleBox["RadTrfZerPerp",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{0,0,0},{0,1,0}];\n\n",
 StyleBox["RadTrfZerPerp",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet,{0,0,0},{1,0,0}];\n(*If[(NumPer==0),\"\",",
 StyleBox["RadTrfZerPara",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet,{0,0,0},{0,0,1}]];*)\n",
 StyleBox["RadTrfZerPerp",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet,{0,0,0},{0,1,0}];\n\n",
 StyleBox["RadTrfZerPerp",
  FontColor->RGBColor[1, 0, 0]],
 "[pole,{0,0,0},{1,0,0}];\n(*If[(NumPer==0),\"\",",
 StyleBox["RadTrfZerPara",
  FontColor->RGBColor[1, 0, 0]],
 "[pole,{0,0,0},{0,0,1}]];*)\n",
 StyleBox["RadTrfZerPerp",
  FontColor->RGBColor[1, 0, 0]],
 "[pole,{0,0,0},{0,1,0}];\npoleF=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole}];\n",
 StyleBox["RadTrfZerPara",
  FontColor->RGBColor[1, 0, 0]],
 "[poleF,{0,0,0},{0,0,1}];\n\n",
 StyleBox["RadTrfZerPerp",
  FontColor->RGBColor[1, 0, 0]],
 "[side,{0,0,0},{1,0,0}];\n(*If[(NumPer==0),\"\",",
 StyleBox["RadTrfZerPara",
  FontColor->RGBColor[1, 0, 0]],
 "[side,{0,0,0},{0,0,1}]];*)\n",
 StyleBox["RadTrfZerPerp",
  FontColor->RGBColor[1, 0, 0]],
 "[side,{0,0,0},{0,1,0}];\n\nundfrc=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{side,pole,magnet}];\n\n(*undc=",
 StyleBox["radObjCutMag",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{0,0,40},{0,0,1},Frame->Lab][[1]];*)\n(*Print[\"Total length \
(\",NumPer*2+1,\" poles):    \",N[(y+lm[[2]]/4)*2,5],\"  mm\"];*)\n\
totallength=N[(y+lm[[2]]/4)*2,5];\nnumpoles=NumPer*2+1;\nund\n]"
}], "Input",
 CellChangeTimes->{{3.849572053474595*^9, 3.849572128248249*^9}, {
   3.8495721848720493`*^9, 3.8495722281664696`*^9}, 3.849572285281133*^9, {
   3.8495723201835403`*^9, 3.849572382495947*^9}, {3.8495724984617414`*^9, 
   3.8495726459489584`*^9}, {3.8495726931130342`*^9, 
   3.8495728356567016`*^9}, {3.8495729143377485`*^9, 3.849572947541973*^9}, {
   3.849574520430972*^9, 3.849574617407159*^9}, 3.8495749949739966`*^9, 
   3.849575198792453*^9, {3.849575253961528*^9, 3.849575257845567*^9}, {
   3.849575356144841*^9, 3.8495754028819685`*^9}, {3.849575440866559*^9, 
   3.849575441738719*^9}, {3.849575687866083*^9, 3.8495757106214275`*^9}, 
   3.8495765066683154`*^9, 3.8495765549937887`*^9, {3.8495769759598475`*^9, 
   3.8495769966405296`*^9}, {3.8495774603427267`*^9, 3.8495774809366355`*^9}, 
   3.8496496480230937`*^9, {3.8496497572610207`*^9, 3.8496497711510096`*^9}, {
   3.8496498796180425`*^9, 3.8496500161786733`*^9}, {3.8496501412783337`*^9, 
   3.8496501515083246`*^9}, {3.8496502064119053`*^9, 
   3.8496502315046177`*^9}, {3.849650272002843*^9, 3.849650273132842*^9}, 
   3.849650613668476*^9, {3.8496507238757906`*^9, 3.84965074316577*^9}, {
   3.8496507915721097`*^9, 3.8496509208188615`*^9}, 3.8496510498600764`*^9, {
   3.849651279488081*^9, 3.849651487604303*^9}, {3.8496518738166*^9, 
   3.8496520911898065`*^9}, 3.8496521218997993`*^9, {3.8496522562979717`*^9, 
   3.849652278647721*^9}, {3.8496523885892143`*^9, 3.849652510885844*^9}, {
   3.849652543115576*^9, 3.8496525730553303`*^9}, {3.8496526206749496`*^9, 
   3.8496526593390446`*^9}, {3.8496526938089123`*^9, 
   3.8496527410649824`*^9}, {3.849652845797761*^9, 3.8496528562377*^9}, {
   3.849652923538856*^9, 3.849652980596321*^9}, {3.849653012957328*^9, 
   3.849653056181904*^9}, {3.849653751943803*^9, 3.8496539085934997`*^9}, {
   3.849654194491127*^9, 3.849654231579466*^9}, {3.8496543520936613`*^9, 
   3.8496543620036488`*^9}, {3.849654481148229*^9, 3.849654523407072*^9}, {
   3.8496545666467896`*^9, 3.8496548105918903`*^9}, {3.84965499145909*^9, 
   3.84965499145909*^9}, {3.8496550411998053`*^9, 3.8496550547927537`*^9}, {
   3.849655089330888*^9, 3.8496551981755767`*^9}, {3.849655234461477*^9, 
   3.849655244041669*^9}, {3.849655404522587*^9, 3.849655425193003*^9}, {
   3.849655482852952*^9, 3.849655487742996*^9}, {3.8496555832061357`*^9, 
   3.8496555845161467`*^9}, {3.8496556220471354`*^9, 3.849655622617135*^9}, 
   3.84965591666016*^9, {3.8496559530157943`*^9, 3.8496559544757924`*^9}, {
   3.8496560225457516`*^9, 3.8496560416357403`*^9}, {3.8496561806245184`*^9, 
   3.8496563091946115`*^9}, {3.849656452326645*^9, 3.8496565181925516`*^9}, {
   3.8496565756179776`*^9, 3.8496566751473513`*^9}, {3.8496572097148733`*^9, 
   3.849657217110723*^9}, {3.8496572487805567`*^9, 3.8496572505705533`*^9}, {
   3.849658997552963*^9, 3.8496590409819226`*^9}, {3.8496591403549976`*^9, 
   3.849659143774991*^9}, {3.84965922107034*^9, 3.849659420929379*^9}, {
   3.8496594515093565`*^9, 3.8496595912458344`*^9}, {3.8496596525087585`*^9, 
   3.849659671818761*^9}, 3.8496597365267897`*^9, {3.849659774587121*^9, 
   3.8496598094075537`*^9}, {3.849659863057528*^9, 3.8496598670856447`*^9}, {
   3.849660321649008*^9, 3.849660328899002*^9}, {3.8496603958666625`*^9, 
   3.8496603987166376`*^9}, 3.8496606566854277`*^9, {3.849660913895274*^9, 
   3.84966095817277*^9}, {3.8496624456754284`*^9, 3.84966272601681*^9}, 
   3.8496630302098284`*^9, {3.8497499375330257`*^9, 3.849749965094982*^9}, {
   3.849750008097274*^9, 3.849750130160448*^9}, {3.849750162936884*^9, 
   3.8497502444175253`*^9}, {3.8497502763831453`*^9, 3.849750286448638*^9}, {
   3.8497504344525104`*^9, 3.849750440524328*^9}, {3.849750588148366*^9, 
   3.8497506058483562`*^9}, {3.8497506864222775`*^9, 3.849750686608833*^9}, {
   3.8497507634305534`*^9, 3.849750870078232*^9}, {3.8497509215909166`*^9, 
   3.849750961882139*^9}, 3.8497510480660105`*^9, {3.8497510953613367`*^9, 
   3.8497512108838816`*^9}, {3.8497513782035255`*^9, 
   3.8497514182469444`*^9}, {3.8497517570223703`*^9, 
   3.8497517610943174`*^9}, {3.8497522167422757`*^9, 3.849752222752227*^9}, {
   3.8497522535819855`*^9, 3.8497522715158925`*^9}, {3.8497523163636446`*^9, 
   3.849752365257762*^9}, {3.8497524394469676`*^9, 3.8497525467267733`*^9}, {
   3.8497526162460794`*^9, 3.849752730508974*^9}, {3.849752770647138*^9, 
   3.8497528754950533`*^9}, {3.8497529302808847`*^9, 
   3.8497529310368824`*^9}, {3.849752966170538*^9, 3.849752995560673*^9}, 
   3.849753094146408*^9, {3.8497531278702908`*^9, 3.849753173006328*^9}, {
   3.8497532221720777`*^9, 3.84975323998105*^9}, {3.8497532722379503`*^9, 
   3.849753308469886*^9}, {3.8497533675497417`*^9, 3.849753426157132*^9}, {
   3.849753465477519*^9, 3.849753486393488*^9}, {3.849753520149412*^9, 
   3.8497536034092927`*^9}, {3.8497536554952073`*^9, 
   3.8497536990731473`*^9}, {3.8497537605590134`*^9, 
   3.8497539324379373`*^9}, {3.849754188272478*^9, 3.8497542085632753`*^9}, {
   3.849754240222534*^9, 3.849754275428356*^9}, {3.849754319480324*^9, 
   3.849754449686803*^9}, {3.849754484139702*^9, 3.849754528988512*^9}, {
   3.8497546041260996`*^9, 3.849754604879239*^9}, {3.8497547100241218`*^9, 
   3.8497547173961897`*^9}, {3.849754754877966*^9, 3.8497547890419793`*^9}, {
   3.8497550016658645`*^9, 3.849755105812526*^9}, {3.8497551377809114`*^9, 
   3.8497551480577655`*^9}, {3.8497551800267334`*^9, 3.849755325571764*^9}, {
   3.8497553644264603`*^9, 3.8497555219991117`*^9}, {3.8497556159345703`*^9, 
   3.8497556439642153`*^9}, 3.8497556823861065`*^9, {3.8497557283136735`*^9, 
   3.849755732065662*^9}, {3.8497557959392433`*^9, 3.8497557994933662`*^9}, {
   3.8497558325750475`*^9, 3.8497558344500303`*^9}, {3.849755919684507*^9, 
   3.849755920058524*^9}, 3.8497560960695295`*^9, {3.849756178885105*^9, 
   3.8497562391128025`*^9}, {3.8497562954698844`*^9, 
   3.8497564127158794`*^9}, {3.849756443796565*^9, 3.849756462014041*^9}, {
   3.8497565288214016`*^9, 3.849756550793353*^9}, {3.849756587071148*^9, 
   3.8497566234090247`*^9}, {3.8497566535536113`*^9, 3.849756772946063*^9}, {
   3.8497568519001207`*^9, 3.8497568528021135`*^9}, {3.8497569026428585`*^9, 
   3.8497570817031617`*^9}, {3.8497571186533933`*^9, 3.84975721537283*^9}, {
   3.849757372992374*^9, 3.8497574193723087`*^9}, {3.849761942138438*^9, 
   3.8497619599451885`*^9}, {3.8497621620103097`*^9, 3.849762171790825*^9}, {
   3.8497622211559525`*^9, 3.8497622870381527`*^9}, {3.8497624530195274`*^9, 
   3.84976252969528*^9}, {3.849762567982712*^9, 3.8497625684083047`*^9}, {
   3.8497626406974173`*^9, 3.8497626406974173`*^9}, {3.8497626839848347`*^9, 
   3.8497626932761354`*^9}, {3.8497628453613615`*^9, 3.849763020820834*^9}, {
   3.849763051917959*^9, 3.849763056917778*^9}, {3.8497631446337004`*^9, 
   3.8497631743139377`*^9}, {3.849763271597988*^9, 3.8497632770438967`*^9}, {
   3.8503630079120965`*^9, 3.850363017306899*^9}, {3.8503630503472223`*^9, 
   3.850363121442315*^9}, {3.850363564765591*^9, 3.8503636606558075`*^9}, {
   3.8503637130732384`*^9, 3.85036392836654*^9}, {3.8503639641016207`*^9, 
   3.85036416309011*^9}, {3.850364201014919*^9, 3.850364202982326*^9}, {
   3.8503642614712973`*^9, 3.8503643232658005`*^9}, {3.850364427254345*^9, 
   3.8503644619422393`*^9}, {3.8503646484184103`*^9, 3.850364658187863*^9}, {
   3.850364709477672*^9, 3.850364827016487*^9}, {3.850364937036547*^9, 
   3.8503649374111104`*^9}, {3.8504258870470533`*^9, 
   3.8504258896407185`*^9}, {3.8504259684557886`*^9, 3.850426002247655*^9}, {
   3.8504260750277514`*^9, 3.8504263755725374`*^9}, {3.850426528034941*^9, 
   3.850426528038929*^9}, {3.850426950151224*^9, 3.850426950431485*^9}, {
   3.85042702073777*^9, 3.850427052511649*^9}, {3.850427114189725*^9, 
   3.850427120263237*^9}, {3.8504273595421786`*^9, 3.850427526684953*^9}, {
   3.850427560825823*^9, 3.850427588309058*^9}, {3.8504537782380285`*^9, 
   3.8504538010338*^9}, {3.850453839474612*^9, 3.8504538734518423`*^9}, {
   3.8510483894414067`*^9, 3.8510483953752337`*^9}, 3.851048427419779*^9, {
   3.851049164184822*^9, 3.851049166835044*^9}, 3.851049240080081*^9, {
   3.851049276809397*^9, 3.851049279178295*^9}, {3.851049394473662*^9, 
   3.851049424255614*^9}, {3.851049601307565*^9, 3.851049720920559*^9}, {
   3.851049761926608*^9, 3.8510497815549765`*^9}, {3.851049840294496*^9, 
   3.8510498562122307`*^9}, {3.851049897970579*^9, 3.8510499007534127`*^9}, {
   3.851049941107956*^9, 3.8510499811154613`*^9}, {3.851050033425353*^9, 
   3.851050093988776*^9}, {3.8510502137396507`*^9, 3.851050238229588*^9}, {
   3.851050272877201*^9, 3.8510503673418827`*^9}, {3.8510504088300114`*^9, 
   3.8510504565154295`*^9}, {3.851050552487337*^9, 3.851050576693821*^9}, {
   3.8510506411561995`*^9, 3.851050692153689*^9}, {3.85105072979303*^9, 
   3.851050733577072*^9}, {3.8510507665050187`*^9, 3.8510508068693447`*^9}, {
   3.851050854739363*^9, 3.851050906243621*^9}, {3.8510510286303587`*^9, 
   3.8510510800100465`*^9}, {3.851051140169341*^9, 3.851051165968132*^9}, {
   3.8510512413938026`*^9, 3.851051282147688*^9}, {3.8510513772973666`*^9, 
   3.8510514313325386`*^9}, {3.8510514687295017`*^9, 
   3.8510514847506547`*^9}, {3.8510515408764133`*^9, 3.851051564999012*^9}, {
   3.85105159932598*^9, 3.8510517112101*^9}, {3.8510517594729357`*^9, 
   3.8510519107731714`*^9}, {3.8510519567549124`*^9, 3.851051980136232*^9}, {
   3.8510520418612704`*^9, 3.8510520963086176`*^9}, {3.8510521300788937`*^9, 
   3.851052137272685*^9}, {3.8510521747102537`*^9, 3.851052235493968*^9}, {
   3.8510523920230465`*^9, 3.851052503731397*^9}, {3.8510525695586557`*^9, 
   3.8510525844124117`*^9}, {3.851052617540492*^9, 3.8510527667906313`*^9}, {
   3.851052805181423*^9, 3.8510528056613607`*^9}, {3.851052867728486*^9, 
   3.851052907964464*^9}, {3.8510530014228463`*^9, 3.8510530047340755`*^9}, {
   3.8510530665564585`*^9, 3.851053165251396*^9}, {3.8510531990998535`*^9, 
   3.851053208483695*^9}, {3.8510532452758484`*^9, 3.8510532479970207`*^9}, {
   3.851053296807282*^9, 3.8510533405797424`*^9}, {3.851054457497221*^9, 
   3.851054765871666*^9}, {3.8510548115056095`*^9, 3.851054908009046*^9}, {
   3.8510549714868507`*^9, 3.851055136882959*^9}, {3.8510552265367165`*^9, 
   3.8510552265467105`*^9}, {3.85105529645767*^9, 3.851055320437721*^9}, {
   3.8510553661138296`*^9, 3.8510554351923075`*^9}, {3.851055488144758*^9, 
   3.8510554912959037`*^9}, {3.8510555455883837`*^9, 3.851055604350341*^9}, {
   3.8510556803712626`*^9, 3.8510556803712626`*^9}, {3.851055721681344*^9, 
   3.8510557379147873`*^9}, {3.8510557816860743`*^9, 
   3.8510558641333456`*^9}, {3.8510559654753475`*^9, 3.851055978619445*^9}, {
   3.8510560931228685`*^9, 3.8510560958378305`*^9}, {3.8510561473825316`*^9, 
   3.851056149173672*^9}, {3.851056208746412*^9, 3.851056330641049*^9}, {
   3.851056383598468*^9, 3.8510564051306925`*^9}, {3.8510565081446767`*^9, 
   3.851056553788103*^9}, {3.8510570140338616`*^9, 3.8510570140338616`*^9}, {
   3.851059262540867*^9, 3.85105932080949*^9}, {3.8510625947151823`*^9, 
   3.8510626019424734`*^9}, {3.8510627051562243`*^9, 
   3.8510627308137674`*^9}, {3.8510627645574083`*^9, 
   3.8510628626649103`*^9}, {3.8510629117048273`*^9, 
   3.8510629168088336`*^9}, {3.851062966969718*^9, 3.8510629708921957`*^9}, 
   3.851063016944928*^9, {3.8510631165636015`*^9, 3.851063140758713*^9}, 
   3.851063182603561*^9, {3.851063273818302*^9, 3.851063307536127*^9}, {
   3.851063392174817*^9, 3.8510634333194113`*^9}, 3.8510635095043783`*^9, {
   3.8510635515168343`*^9, 3.8510635520956373`*^9}, 3.851064794631616*^9, {
   3.851064913089613*^9, 3.851064913089613*^9}, {3.851065735318034*^9, 
   3.8510658119665937`*^9}, {3.8510658762475014`*^9, 3.851065905983961*^9}, {
   3.851066012309628*^9, 3.8510660334873962`*^9}, {3.8510660646685514`*^9, 
   3.851066065047143*^9}, 3.8510661010584497`*^9, 3.851067673084154*^9, {
   3.8510680390895786`*^9, 3.851068049379323*^9}, 3.851068470741321*^9, 
   3.8510693442287955`*^9, {3.8511427765473843`*^9, 3.851142950111263*^9}, {
   3.8511430658784494`*^9, 3.8511430669294124`*^9}, {3.8511431637527094`*^9, 
   3.8511431715051985`*^9}, {3.8511433478057985`*^9, 3.851143358771974*^9}, {
   3.8511433893554335`*^9, 3.85114339180142*^9}, 3.8511437274506865`*^9, {
   3.8511437726278944`*^9, 3.8511437804957304`*^9}, {3.851145654735467*^9, 
   3.851145750940819*^9}, {3.851465851176131*^9, 3.8514658545985336`*^9}, {
   3.8517420508691826`*^9, 3.851742119903987*^9}, {3.8517421524123755`*^9, 
   3.8517421604196744`*^9}, {3.8517424080547905`*^9, 3.851742527380596*^9}, {
   3.8517425651150713`*^9, 3.851742578958663*^9}, {3.851742617023776*^9, 
   3.851742620691454*^9}, {3.8517426848586483`*^9, 3.851742686512022*^9}, {
   3.8517427593255854`*^9, 3.851742759348347*^9}, {3.8517428755014086`*^9, 
   3.8517428756879587`*^9}, {3.8517429064365*^9, 3.851742907085128*^9}, {
   3.8517450604670887`*^9, 3.8517451417196894`*^9}, 3.851745179979627*^9, {
   3.8517483628221736`*^9, 3.851748364216897*^9}, {3.851748547706809*^9, 
   3.851748580179346*^9}, {3.851748613424239*^9, 3.8517486256017427`*^9}, {
   3.8517486806304865`*^9, 3.8517487017164073`*^9}, {3.8517487604364986`*^9, 
   3.8517487789238997`*^9}, {3.8517488105465655`*^9, 3.8517489770986695`*^9}, 
   3.8522694945385494`*^9, 3.8535404331870284`*^9, {3.8535404878464594`*^9, 
   3.8535406687734327`*^9}, {3.8535409967754416`*^9, 
   3.8535409970631595`*^9}, {3.853542019359277*^9, 3.853542047670882*^9}, {
   3.853542244854247*^9, 3.853542247914228*^9}, {3.8535424593631287`*^9, 
   3.8535425588466263`*^9}, {3.853896349854499*^9, 3.853896370120109*^9}, {
   3.8538964191096315`*^9, 3.8538965022917194`*^9}, 3.853896533041048*^9, {
   3.8538967012253017`*^9, 3.85389671494541*^9}, {3.853896754004856*^9, 
   3.8538967592338057`*^9}, {3.854345700801812*^9, 3.854345700801812*^9}, {
   3.85434578407286*^9, 3.854345791199199*^9}, {3.854427764696726*^9, 
   3.85442778504008*^9}, {3.854427833764927*^9, 3.8544279209561863`*^9}, {
   3.8544285463687105`*^9, 3.8544285480276265`*^9}, {3.8547590167516837`*^9, 
   3.854759043805722*^9}, {3.8547590902166224`*^9, 3.85475916782139*^9}},
 AspectRatioFixed->True,
 Background->RGBColor[0.88, 1, 0.88],
 CellLabel->"In[16]:=",ExpressionUUID->"55d175db-2e2d-4acd-b57c-348bc9f05e56"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Functions for ",
 StyleBox["even",
  FontColor->RGBColor[1, 0, 0]],
 " numbers of pole ",
 StyleBox["(you can choose either ",
  FontColor->RGBColor[1, 0.5, 0.5]],
 StyleBox["odd",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" or ",
  FontColor->RGBColor[1, 0.5, 0.5]],
 StyleBox["even",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox[" poles)",
  FontColor->RGBColor[1, 0.5, 0.5]]
}], "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.851744128405555*^9, 3.851744135206566*^9}, 
   3.8535432776540785`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"299921ee-134d-47aa-b8be-840f476c3a44"],

Cell[TextData[StyleBox["The following function builds an array of rectangular \
permanent magnets with their mirror symmetric counterparts, distributes the \
colors, magnetic materials and sets the segmentation. The function is very \
generic and can be used to build almost any hybrid wiggler (without \
optimizing the design of terminations).",
 Evaluatable->False,
 AspectRatioFixed->True]], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8520029529574227`*^9, 3.852002953874771*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"4e552465-4ec0-4637-a637-47ed123e34e8"],

Cell[TextData[{
 "wig[]:=Module[{},\n\n(* A model for even numbers in main poles *)\ny=0;\n\
For[i=1,i<=NumPer,i++,(\n",
 StyleBox["(* Periodic Magnet 1 *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ninitm={0,Mod[i,2]-Mod[i+1,2],0};\n\
If[i==1,y+=lm[[2]]/4+sp[[2]]/2,y+=lm[[2]]/4+sp[[2]]];\n\
m1={{lm[[1]]/4-chm[[1]]/2,y+chm[[2]]/2,sp[[3]]+gapoffset},{lm[[1]]/2-chm[[1]],\
lm[[2]]/2+chm[[2]]}};\n\
m2={{lm[[1]]/4,y,chm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]/2}};\n\
m3={{lm[[1]]/4,y,lm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]/2}};\n\
magnetP1=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{m1,m2,m3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magnetP1,nmd,cm,mm];\n\n",
 StyleBox["(* Periodic Pole *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ny+=(lm[[2]]/2+lp[[2]])/2+sp[[2]];\n\
p1={{lp[[1]]/4-chp[[1]]/2,y,sp[[3]]+gapoffset},{lp[[1]]/2-chp[[1]],lp[[2]]-2*\
chp[[2]]}};\n\
p2={{lp[[1]]/4,y,chp[[3]]+sp[[3]]+gapoffset},{lp[[1]]/2,lp[[2]]}};\n\
p3={{lp[[1]]/4,y,lp[[3]]+sp[[3]]+gapoffset},{lp[[1]]/2,lp[[2]]}};\npoleP=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{p1,p2,p3},zer];\nnpd={np[[2]],np[[2]],np[[1]]};\n\
fullMag[poleP,npd,cp,mp];\n\n",
 StyleBox["(* Periodic side magnet *)",
  FontColor->RGBColor[0, 0, 1]],
 "\nIf[NumPer==0,initsm={Mod[i,2]-Mod[i+1,2],0,0},initsm={Mod[i+1,2]-Mod[i,2],\
0,0}];\ns1={{(lp[[1]]-chp[[1]]+lsm[[1]]-chm[[1]])/2+sp[[1]],y,sp[[3]]+\
gapoffset},{chp[[1]]+lsm[[1]]-chm[[1]],lsm[[2]]-2*chp[[2]]}};\n\
s2={{(lp[[1]]+lsm[[1]])/2+sp[[1]],y,chm[[3]]+sp[[3]]+gapoffset},{lsm[[1]],lsm[\
[2]]}};\ns3={{(lp[[1]]+lsm[[1]])/2+sp[[1]],y,lsm[[3]]+sp[[3]]+gapoffset},{lsm[\
[1]],lsm[[2]]}};\nsideP=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{s1,s2,s3},initsm];\nnpd={np[[1]]/2,np[[2]],np[[2]]};\n\
nmd={nm[[1]]/2,nm[[2]],nm[[2]]};\nfullMag[sideP,nmd,csm,mm];\n\n",
 StyleBox["(* Periodic Magnet 2 *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ninitm={0,Mod[i+1,2]-Mod[i,2],0};\ny+=(lm[[2]]/2+lp[[2]])/2+sp[[2]];\n\
m1={{lm[[1]]/4-chm[[1]]/2,y-chm[[2]]/2,sp[[3]]+gapoffset},{lm[[1]]/2-chm[[1]],\
lm[[2]]/2+chm[[2]]}};\n\
m2={{lm[[1]]/4,y,chm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]/2}};\n\
m3={{lm[[1]]/4,y,lm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]/2}};\n\
magnetP2=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{m1,m2,m3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magnetP2,nmd,cm,mm];\n\ny+=lm[[2]]/4;\n\nIf[i==1,magnet1=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{magnetP1,magnetP2}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet1,{magnetP1,magnetP2}]];\nIf[i==1,pole1=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{poleP}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[pole1,{poleP}]];\nIf[i==1,side1=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{sideP}],",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[side1,{sideP}]];\n(*",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{poleP,mangetP1,magnetP2,sideP}];*)\n)];\n\n",
 StyleBox["(* Magnet before End pole *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ninitm={0,Mod[NumPer+1,2]-Mod[NumPer,2],0};\ny+=lm[[2]]/4+sp[[2]];\n\
m1={{lm[[1]]/4-chm[[1]]/2,y+chm[[2]]/2,sp[[3]]+gapoffset},{lm[[1]]/2-chm[[1]],\
lm[[2]]/2+chm[[2]]}};\n\
m2={{lm[[1]]/4,y,chm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]/2}};\n\
m3={{lm[[1]]/4,y,lm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]/2}};\nmagnet2=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{m1,m2,m3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magnet2,nmd,cm,mm];\n\n",
 StyleBox["(* End pole *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ny+=(lm[[2]]/2+lep[[2]])/2+sp[[2]]+dpm[[1]];\n\
p1={{lep[[1]]/4-chp[[1]]/2,y,sp[[3]]},{lep[[1]]/2-chp[[1]],lep[[2]]-2*chp[[2]]\
}};\np2={{lep[[1]]/4,y,chp[[3]]+sp[[3]]},{lep[[1]]/2,lep[[2]]}};\n\
p3={{lep[[1]]/4,y,lep[[3]]+sp[[3]]},{lep[[1]]/2,lep[[2]]}};\npole2=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{p1,p2,p3},zer];\nnpd={np[[2]],np[[2]]/2,np[[1]]};\n\
fullMag[pole2,npd,cp,mp];\n\n",
 StyleBox["(* End side magnet *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ninitsm={Mod[NumPer,2]-Mod[NumPer+1,2],0,0};\n\
s1={{(lep[[1]]-chp[[1]]+les[[1]]-chm[[1]])/2+sp[[1]],y,sp[[3]]+gapoffset},{\
chp[[1]]+les[[1]]-chm[[1]],les[[2]]-2*chp[[2]]}};\n\
s2={{(lep[[1]]+les[[1]])/2+sp[[1]],y,chm[[3]]+sp[[3]]+gapoffset},{les[[1]],\
les[[2]]}};\n\
s3={{(lep[[1]]+les[[1]])/2+sp[[1]],y,les[[3]]+sp[[3]]+gapoffset},{les[[1]],\
les[[2]]}};\nside2=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{s1,s2,s3},initsm];\nnpd={np[[1]]/2,np[[2]]/2,np[[2]]};\n\
nmd={nm[[1]]/2,nm[[2]]/2,nm[[2]]};\nfullMag[side2,nmd,csm,mm];\n\n",
 StyleBox["(* End magnet for half size and unit model *)",
  FontColor->RGBColor[0, 0, 1]],
 "\ninitm={0,Mod[NumPer,2]-Mod[NumPer+1,2],0};\n\
y+=lm[[2]]/4+lep[[2]]/2+sp[[2]]+dpm[[2]];\n\
m1={{lm[[1]]/4-chm[[1]]/2,y-chm[[2]]/2,sp[[3]]+gapoffset},{lm[[1]]/2-chm[[1]],\
lm[[2]]/2+chm[[2]]}};\n\
m2={{lm[[1]]/4,y,chm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]/2}};\n\
m3={{lm[[1]]/4,y,lm[[3]]+sp[[3]]+gapoffset},{lm[[1]]/2,lm[[2]]/2}};\nmagEnd=",
 StyleBox["radObjMltExtRtg",
  FontColor->RGBColor[1, 0, 0]],
 "[{m1,m2,m3},initm];\nnmd={nm[[2]],nm[[1]],nm[[2]]};\n\
fullMag[magEnd,nmd,cm,mm];\n\nIf[NumPer==0,magnet=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{magnet2,magEnd}],magnet=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{magnet1,magnet2,magEnd}]];\nIf[NumPer==0,pole=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole2}],pole=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole1,pole2}]];\nIf[NumPer==0,side=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{side2}],side=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{side1,side2}]];\nIf[NumPer==0,und=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole2,side2,magnet2,magEnd}],und=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{pole1,side1,magnet1}]];\nIf[(NumPer>0) && (ending==0),\"\",",
 StyleBox["radObjAddToCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{magnet2,pole2,side2,magEnd}]];\n\ntr=",
 StyleBox["radTrfTrsl",
  FontColor->RGBColor[1, 0, 0]],
 "[{0,0,gap/2}];\n",
 StyleBox["radTrfOrnt",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet,tr];\n",
 StyleBox["radTrfOrnt",
  FontColor->RGBColor[1, 0, 0]],
 "[pole,tr];\n",
 StyleBox["radTrfOrnt",
  FontColor->RGBColor[1, 0, 0]],
 "[side,tr];\n",
 StyleBox["radTrfOrnt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,tr];\n\n(* Mirrors *)\n",
 StyleBox["RadTrfZerPerp",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{0,0,0},{1,0,0}];\nIf[(NumPer==0)&&(ending==0),\"\",",
 StyleBox["RadTrfZerPara",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{0,0,0},{0,0,1}]];\n",
 StyleBox["RadTrfZerPara",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{0,0,0},{0,1,0}];\n\n",
 StyleBox["RadTrfZerPerp",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet,{0,0,0},{1,0,0}];\n(*If[(NumPer==0),\"\",",
 StyleBox["RadTrfZerPara",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet,{0,0,0},{0,0,1}]];*)\n",
 StyleBox["RadTrfZerPara",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet,{0,0,0},{0,1,0}];\n\n",
 StyleBox["RadTrfZerPerp",
  FontColor->RGBColor[1, 0, 0]],
 "[pole,{0,0,0},{1,0,0}];\n(*If[(NumPer==0),\"\",",
 StyleBox["RadTrfZerPara",
  FontColor->RGBColor[1, 0, 0]],
 "[pole,{0,0,0},{0,0,1}]];*)\n",
 StyleBox["RadTrfZerPara",
  FontColor->RGBColor[1, 0, 0]],
 "[pole,{0,0,0},{0,1,0}];\n\n",
 StyleBox["RadTrfZerPerp",
  FontColor->RGBColor[1, 0, 0]],
 "[side,{0,0,0},{1,0,0}];\n(*If[(NumPer==0),\"\",",
 StyleBox["RadTrfZerPara",
  FontColor->RGBColor[1, 0, 0]],
 "[side,{0,0,0},{0,0,1}]];*)\n",
 StyleBox["RadTrfZerPara",
  FontColor->RGBColor[1, 0, 0]],
 "[side,{0,0,0},{0,1,0}];\n\nundfrc=",
 StyleBox["radObjCnt",
  FontColor->RGBColor[1, 0, 0]],
 "[{side,pole,magnet}];\n\n(*undc=",
 StyleBox["radObjCutMag",
  FontColor->RGBColor[1, 0, 0]],
 "[und,{0,0,40},{0,0,1},Frame->Lab][[1]];*)\n(*Print[\"Total length \
(\",NumPer*2,\" poles):    \",N[(y+lm[[2]]/4)*2,5],\"  mm\"];*)\n\
totallength=N[(y+lm[[2]]/4)*2,5];\nnumpoles=NumPer*2;\nund\n]"
}], "Input",
 CellChangeTimes->{{3.849572053474595*^9, 3.849572128248249*^9}, {
   3.8495721848720493`*^9, 3.8495722281664696`*^9}, 3.849572285281133*^9, {
   3.8495723201835403`*^9, 3.849572382495947*^9}, {3.8495724984617414`*^9, 
   3.8495726459489584`*^9}, {3.8495726931130342`*^9, 
   3.8495728356567016`*^9}, {3.8495729143377485`*^9, 3.849572947541973*^9}, {
   3.849574520430972*^9, 3.849574617407159*^9}, 3.8495749949739966`*^9, 
   3.849575198792453*^9, {3.849575253961528*^9, 3.849575257845567*^9}, {
   3.849575356144841*^9, 3.8495754028819685`*^9}, {3.849575440866559*^9, 
   3.849575441738719*^9}, {3.849575687866083*^9, 3.8495757106214275`*^9}, 
   3.8495765066683154`*^9, 3.8495765549937887`*^9, {3.8495769759598475`*^9, 
   3.8495769966405296`*^9}, {3.8495774603427267`*^9, 3.8495774809366355`*^9}, 
   3.8496496480230937`*^9, {3.8496497572610207`*^9, 3.8496497711510096`*^9}, {
   3.8496498796180425`*^9, 3.8496500161786733`*^9}, {3.8496501412783337`*^9, 
   3.8496501515083246`*^9}, {3.8496502064119053`*^9, 
   3.8496502315046177`*^9}, {3.849650272002843*^9, 3.849650273132842*^9}, 
   3.849650613668476*^9, {3.8496507238757906`*^9, 3.84965074316577*^9}, {
   3.8496507915721097`*^9, 3.8496509208188615`*^9}, 3.8496510498600764`*^9, {
   3.849651279488081*^9, 3.849651487604303*^9}, {3.8496518738166*^9, 
   3.8496520911898065`*^9}, 3.8496521218997993`*^9, {3.8496522562979717`*^9, 
   3.849652278647721*^9}, {3.8496523885892143`*^9, 3.849652510885844*^9}, {
   3.849652543115576*^9, 3.8496525730553303`*^9}, {3.8496526206749496`*^9, 
   3.8496526593390446`*^9}, {3.8496526938089123`*^9, 
   3.8496527410649824`*^9}, {3.849652845797761*^9, 3.8496528562377*^9}, {
   3.849652923538856*^9, 3.849652980596321*^9}, {3.849653012957328*^9, 
   3.849653056181904*^9}, {3.849653751943803*^9, 3.8496539085934997`*^9}, {
   3.849654194491127*^9, 3.849654231579466*^9}, {3.8496543520936613`*^9, 
   3.8496543620036488`*^9}, {3.849654481148229*^9, 3.849654523407072*^9}, {
   3.8496545666467896`*^9, 3.8496548105918903`*^9}, {3.84965499145909*^9, 
   3.84965499145909*^9}, {3.8496550411998053`*^9, 3.8496550547927537`*^9}, {
   3.849655089330888*^9, 3.8496551981755767`*^9}, {3.849655234461477*^9, 
   3.849655244041669*^9}, {3.849655404522587*^9, 3.849655425193003*^9}, {
   3.849655482852952*^9, 3.849655487742996*^9}, {3.8496555832061357`*^9, 
   3.8496555845161467`*^9}, {3.8496556220471354`*^9, 3.849655622617135*^9}, 
   3.84965591666016*^9, {3.8496559530157943`*^9, 3.8496559544757924`*^9}, {
   3.8496560225457516`*^9, 3.8496560416357403`*^9}, {3.8496561806245184`*^9, 
   3.8496563091946115`*^9}, {3.849656452326645*^9, 3.8496565181925516`*^9}, {
   3.8496565756179776`*^9, 3.8496566751473513`*^9}, {3.8496572097148733`*^9, 
   3.849657217110723*^9}, {3.8496572487805567`*^9, 3.8496572505705533`*^9}, {
   3.849658997552963*^9, 3.8496590409819226`*^9}, {3.8496591403549976`*^9, 
   3.849659143774991*^9}, {3.84965922107034*^9, 3.849659420929379*^9}, {
   3.8496594515093565`*^9, 3.8496595912458344`*^9}, {3.8496596525087585`*^9, 
   3.849659671818761*^9}, 3.8496597365267897`*^9, {3.849659774587121*^9, 
   3.8496598094075537`*^9}, {3.849659863057528*^9, 3.8496598670856447`*^9}, {
   3.849660321649008*^9, 3.849660328899002*^9}, {3.8496603958666625`*^9, 
   3.8496603987166376`*^9}, 3.8496606566854277`*^9, {3.849660913895274*^9, 
   3.84966095817277*^9}, {3.8496624456754284`*^9, 3.84966272601681*^9}, 
   3.8496630302098284`*^9, {3.8497499375330257`*^9, 3.849749965094982*^9}, {
   3.849750008097274*^9, 3.849750130160448*^9}, {3.849750162936884*^9, 
   3.8497502444175253`*^9}, {3.8497502763831453`*^9, 3.849750286448638*^9}, {
   3.8497504344525104`*^9, 3.849750440524328*^9}, {3.849750588148366*^9, 
   3.8497506058483562`*^9}, {3.8497506864222775`*^9, 3.849750686608833*^9}, {
   3.8497507634305534`*^9, 3.849750870078232*^9}, {3.8497509215909166`*^9, 
   3.849750961882139*^9}, 3.8497510480660105`*^9, {3.8497510953613367`*^9, 
   3.8497512108838816`*^9}, {3.8497513782035255`*^9, 
   3.8497514182469444`*^9}, {3.8497517570223703`*^9, 
   3.8497517610943174`*^9}, {3.8497522167422757`*^9, 3.849752222752227*^9}, {
   3.8497522535819855`*^9, 3.8497522715158925`*^9}, {3.8497523163636446`*^9, 
   3.849752365257762*^9}, {3.8497524394469676`*^9, 3.8497525467267733`*^9}, {
   3.8497526162460794`*^9, 3.849752730508974*^9}, {3.849752770647138*^9, 
   3.8497528754950533`*^9}, {3.8497529302808847`*^9, 
   3.8497529310368824`*^9}, {3.849752966170538*^9, 3.849752995560673*^9}, 
   3.849753094146408*^9, {3.8497531278702908`*^9, 3.849753173006328*^9}, {
   3.8497532221720777`*^9, 3.84975323998105*^9}, {3.8497532722379503`*^9, 
   3.849753308469886*^9}, {3.8497533675497417`*^9, 3.849753426157132*^9}, {
   3.849753465477519*^9, 3.849753486393488*^9}, {3.849753520149412*^9, 
   3.8497536034092927`*^9}, {3.8497536554952073`*^9, 
   3.8497536990731473`*^9}, {3.8497537605590134`*^9, 
   3.8497539324379373`*^9}, {3.849754188272478*^9, 3.8497542085632753`*^9}, {
   3.849754240222534*^9, 3.849754275428356*^9}, {3.849754319480324*^9, 
   3.849754449686803*^9}, {3.849754484139702*^9, 3.849754528988512*^9}, {
   3.8497546041260996`*^9, 3.849754604879239*^9}, {3.8497547100241218`*^9, 
   3.8497547173961897`*^9}, {3.849754754877966*^9, 3.8497547890419793`*^9}, {
   3.8497550016658645`*^9, 3.849755105812526*^9}, {3.8497551377809114`*^9, 
   3.8497551480577655`*^9}, {3.8497551800267334`*^9, 3.849755325571764*^9}, {
   3.8497553644264603`*^9, 3.8497555219991117`*^9}, {3.8497556159345703`*^9, 
   3.8497556439642153`*^9}, 3.8497556823861065`*^9, {3.8497557283136735`*^9, 
   3.849755732065662*^9}, {3.8497557959392433`*^9, 3.8497557994933662`*^9}, {
   3.8497558325750475`*^9, 3.8497558344500303`*^9}, {3.849755919684507*^9, 
   3.849755920058524*^9}, 3.8497560960695295`*^9, {3.849756178885105*^9, 
   3.8497562391128025`*^9}, {3.8497562954698844`*^9, 
   3.8497564127158794`*^9}, {3.849756443796565*^9, 3.849756462014041*^9}, {
   3.8497565288214016`*^9, 3.849756550793353*^9}, {3.849756587071148*^9, 
   3.8497566234090247`*^9}, {3.8497566535536113`*^9, 3.849756772946063*^9}, {
   3.8497568519001207`*^9, 3.8497568528021135`*^9}, {3.8497569026428585`*^9, 
   3.8497570817031617`*^9}, {3.8497571186533933`*^9, 3.84975721537283*^9}, {
   3.849757372992374*^9, 3.8497574193723087`*^9}, {3.849761942138438*^9, 
   3.8497619599451885`*^9}, {3.8497621620103097`*^9, 3.849762171790825*^9}, {
   3.8497622211559525`*^9, 3.8497622870381527`*^9}, {3.8497624530195274`*^9, 
   3.84976252969528*^9}, {3.849762567982712*^9, 3.8497625684083047`*^9}, {
   3.8497626406974173`*^9, 3.8497626406974173`*^9}, {3.8497626839848347`*^9, 
   3.8497626932761354`*^9}, {3.8497628453613615`*^9, 3.849763020820834*^9}, {
   3.849763051917959*^9, 3.849763056917778*^9}, {3.8497631446337004`*^9, 
   3.8497631743139377`*^9}, {3.849763271597988*^9, 3.8497632770438967`*^9}, {
   3.8503630079120965`*^9, 3.850363017306899*^9}, {3.8503630503472223`*^9, 
   3.850363121442315*^9}, {3.850363564765591*^9, 3.8503636606558075`*^9}, {
   3.8503637130732384`*^9, 3.85036392836654*^9}, {3.8503639641016207`*^9, 
   3.85036416309011*^9}, {3.850364201014919*^9, 3.850364202982326*^9}, {
   3.8503642614712973`*^9, 3.8503643232658005`*^9}, {3.850364427254345*^9, 
   3.8503644619422393`*^9}, {3.8503646484184103`*^9, 3.850364658187863*^9}, {
   3.850364709477672*^9, 3.850364827016487*^9}, {3.850364937036547*^9, 
   3.8503649374111104`*^9}, {3.8504258870470533`*^9, 
   3.8504258896407185`*^9}, {3.8504259684557886`*^9, 3.850426002247655*^9}, {
   3.8504260750277514`*^9, 3.8504263755725374`*^9}, {3.850426528034941*^9, 
   3.850426528038929*^9}, {3.850426950151224*^9, 3.850426950431485*^9}, {
   3.85042702073777*^9, 3.850427052511649*^9}, {3.850427114189725*^9, 
   3.850427120263237*^9}, {3.8504273595421786`*^9, 3.850427526684953*^9}, {
   3.850427560825823*^9, 3.850427588309058*^9}, {3.8504537782380285`*^9, 
   3.8504538010338*^9}, {3.850453839474612*^9, 3.8504538734518423`*^9}, {
   3.8510483894414067`*^9, 3.8510483953752337`*^9}, 3.851048427419779*^9, {
   3.851049164184822*^9, 3.851049166835044*^9}, 3.851049240080081*^9, {
   3.851049276809397*^9, 3.851049279178295*^9}, {3.851049394473662*^9, 
   3.851049424255614*^9}, {3.851049601307565*^9, 3.851049720920559*^9}, {
   3.851049761926608*^9, 3.8510497815549765`*^9}, {3.851049840294496*^9, 
   3.8510498562122307`*^9}, {3.851049897970579*^9, 3.8510499007534127`*^9}, {
   3.851049941107956*^9, 3.8510499811154613`*^9}, {3.851050033425353*^9, 
   3.851050093988776*^9}, {3.8510502137396507`*^9, 3.851050238229588*^9}, {
   3.851050272877201*^9, 3.8510503673418827`*^9}, {3.8510504088300114`*^9, 
   3.8510504565154295`*^9}, {3.851050552487337*^9, 3.851050576693821*^9}, {
   3.8510506411561995`*^9, 3.851050692153689*^9}, {3.85105072979303*^9, 
   3.851050733577072*^9}, {3.8510507665050187`*^9, 3.8510508068693447`*^9}, {
   3.851050854739363*^9, 3.851050906243621*^9}, {3.8510510286303587`*^9, 
   3.8510510800100465`*^9}, {3.851051140169341*^9, 3.851051165968132*^9}, {
   3.8510512413938026`*^9, 3.851051282147688*^9}, {3.8510513772973666`*^9, 
   3.8510514313325386`*^9}, {3.8510514687295017`*^9, 
   3.8510514847506547`*^9}, {3.8510515408764133`*^9, 3.851051564999012*^9}, {
   3.85105159932598*^9, 3.8510517112101*^9}, {3.8510517594729357`*^9, 
   3.8510519107731714`*^9}, {3.8510519567549124`*^9, 3.851051980136232*^9}, {
   3.8510520418612704`*^9, 3.8510520963086176`*^9}, {3.8510521300788937`*^9, 
   3.851052137272685*^9}, {3.8510521747102537`*^9, 3.851052235493968*^9}, {
   3.8510523920230465`*^9, 3.851052503731397*^9}, {3.8510525695586557`*^9, 
   3.8510525844124117`*^9}, {3.851052617540492*^9, 3.8510527667906313`*^9}, {
   3.851052805181423*^9, 3.8510528056613607`*^9}, {3.851052867728486*^9, 
   3.851052907964464*^9}, {3.8510530014228463`*^9, 3.8510530047340755`*^9}, {
   3.8510530665564585`*^9, 3.851053165251396*^9}, {3.8510531990998535`*^9, 
   3.851053208483695*^9}, {3.8510532452758484`*^9, 3.8510532479970207`*^9}, {
   3.851053296807282*^9, 3.8510533405797424`*^9}, {3.851054457497221*^9, 
   3.851054765871666*^9}, {3.8510548115056095`*^9, 3.851054908009046*^9}, {
   3.8510549714868507`*^9, 3.851055136882959*^9}, {3.8510552265367165`*^9, 
   3.8510552265467105`*^9}, {3.85105529645767*^9, 3.851055320437721*^9}, {
   3.8510553661138296`*^9, 3.8510554351923075`*^9}, {3.851055488144758*^9, 
   3.8510554912959037`*^9}, {3.8510555455883837`*^9, 3.851055604350341*^9}, {
   3.8510556803712626`*^9, 3.8510556803712626`*^9}, {3.851055721681344*^9, 
   3.8510557379147873`*^9}, {3.8510557816860743`*^9, 
   3.8510558641333456`*^9}, {3.8510559654753475`*^9, 3.851055978619445*^9}, {
   3.8510560931228685`*^9, 3.8510560958378305`*^9}, {3.8510561473825316`*^9, 
   3.851056149173672*^9}, {3.851056208746412*^9, 3.851056330641049*^9}, {
   3.851056383598468*^9, 3.8510564051306925`*^9}, {3.8510565081446767`*^9, 
   3.851056553788103*^9}, {3.8510570140338616`*^9, 3.8510570140338616`*^9}, {
   3.851059262540867*^9, 3.85105932080949*^9}, {3.8510625947151823`*^9, 
   3.8510626019424734`*^9}, {3.8510627051562243`*^9, 
   3.8510627308137674`*^9}, {3.8510627645574083`*^9, 
   3.8510628626649103`*^9}, {3.8510629117048273`*^9, 
   3.8510629168088336`*^9}, {3.851062966969718*^9, 3.8510629708921957`*^9}, 
   3.851063016944928*^9, {3.8510631165636015`*^9, 3.851063140758713*^9}, 
   3.851063182603561*^9, {3.851063273818302*^9, 3.851063307536127*^9}, {
   3.851063392174817*^9, 3.8510634333194113`*^9}, 3.8510635095043783`*^9, {
   3.8510635515168343`*^9, 3.8510635520956373`*^9}, 3.851064794631616*^9, {
   3.851064913089613*^9, 3.851064913089613*^9}, {3.851065735318034*^9, 
   3.8510658119665937`*^9}, {3.8510658762475014`*^9, 3.851065905983961*^9}, {
   3.851066012309628*^9, 3.8510660334873962`*^9}, {3.8510660646685514`*^9, 
   3.851066065047143*^9}, 3.8510661010584497`*^9, 3.851067673084154*^9, {
   3.8510680390895786`*^9, 3.851068049379323*^9}, 3.851068470741321*^9, 
   3.8510693442287955`*^9, {3.8511427765473843`*^9, 3.851142950111263*^9}, {
   3.8511430658784494`*^9, 3.8511430669294124`*^9}, {3.8511431637527094`*^9, 
   3.8511431715051985`*^9}, {3.8511433478057985`*^9, 3.851143358771974*^9}, {
   3.8511433893554335`*^9, 3.85114339180142*^9}, 3.8511437274506865`*^9, {
   3.8511437726278944`*^9, 3.8511437804957304`*^9}, {3.851145654735467*^9, 
   3.851145750940819*^9}, {3.851465851176131*^9, 3.8514658545985336`*^9}, {
   3.8517420508691826`*^9, 3.851742119903987*^9}, {3.8517421524123755`*^9, 
   3.8517421604196744`*^9}, {3.8517424080547905`*^9, 3.851742527380596*^9}, {
   3.8517425651150713`*^9, 3.851742578958663*^9}, {3.851742617023776*^9, 
   3.851742620691454*^9}, {3.8517426848586483`*^9, 3.851742686512022*^9}, {
   3.8517427593255854`*^9, 3.851742759348347*^9}, {3.8517428755014086`*^9, 
   3.8517428756879587`*^9}, {3.8517429064365*^9, 3.851742907085128*^9}, {
   3.8517442380140576`*^9, 3.8517442622490263`*^9}, {3.8517443156629424`*^9, 
   3.8517445019602246`*^9}, {3.8517445741886573`*^9, 3.851744578323807*^9}, {
   3.8517446403399878`*^9, 3.851744702041258*^9}, 3.851744831498459*^9, {
   3.8517449399858174`*^9, 3.85174499125613*^9}, {3.85174521791195*^9, 
   3.8517452293032894`*^9}, 3.8517457233151503`*^9, {3.8517459754856443`*^9, 
   3.851745981984322*^9}, {3.851746017724723*^9, 3.8517460209410563`*^9}, {
   3.851746077007507*^9, 3.8517460787221966`*^9}, {3.851746114756243*^9, 
   3.8517461263897095`*^9}, {3.8517462197633133`*^9, 
   3.8517462228993745`*^9}, {3.8517463151140213`*^9, 
   3.8517463177401857`*^9}, {3.851746366771045*^9, 3.8517463670636206`*^9}, {
   3.851746405337989*^9, 3.8517464069562607`*^9}, {3.85174646691553*^9, 
   3.851746544156163*^9}, 3.851746942740648*^9, 3.851747121925827*^9, {
   3.8517471641554174`*^9, 3.8517471650502853`*^9}, {3.8517472908644876`*^9, 
   3.8517472947823043`*^9}, {3.8517475309386168`*^9, 
   3.8517475578870287`*^9}, {3.85174759081551*^9, 3.8517475909058814`*^9}, 
   3.8517477944921885`*^9, {3.851749004517153*^9, 3.851749016402214*^9}, {
   3.853541282196571*^9, 3.853541297752879*^9}, {3.8535422322576327`*^9, 
   3.853542234657625*^9}, {3.8535425732291393`*^9, 3.8535425829691205`*^9}, {
   3.8544279440762043`*^9, 3.854427958149743*^9}, {3.8547591932100573`*^9, 
   3.854759274181389*^9}},
 AspectRatioFixed->True,
 Background->RGBColor[1, 0.85, 0.85],
 CellLabel->
  "In[317]:=",ExpressionUUID->"c55f66be-e2ff-4d35-b2a5-2eb6f91ef814"]
}, Closed]],

Cell[CellGroupData[{

Cell["Create Geometry", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.3999127557963753`*^9, 3.3999127565620003`*^9}, 
   3.8535413593909225`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"41b9a76f-0607-4676-9b4f-a188723677db"],

Cell[TextData[{
 StyleBox["The following instructions build an undulator with NdFeB magnets \
and poles  made with the material previously defined. One could also use a \
Radia predefined steel by replacing \"",
  Evaluatable->False,
  AspectRatioFixed->True],
 "mp=",
 StyleBox["radMatSatIso",
  FontColor->RGBColor[1, 0, 0]],
 "[ma]",
 StyleBox["\" with \"mp=",
  Evaluatable->False,
  AspectRatioFixed->True],
 "RadMatAFK502[]",
 StyleBox["\" or \"m=",
  Evaluatable->False,
  AspectRatioFixed->True],
 "RadMatXc06[]",
 StyleBox["\" or \"m=",
  Evaluatable->False,
  AspectRatioFixed->True],
 "RadMatSteel42",
 StyleBox["[]\". See the section \"How to get Help\" later on to obtain the \
full specification of any of the material predefined in Radia .  ",
  Evaluatable->False,
  AspectRatioFixed->True]
}], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8513935804253044`*^9, 3.851393596755192*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"5e0d4460-f976-471c-bfde-5c529251cdb7"],

Cell[TextData[{
 StyleBox["radUtiDelAll",
  FontColor->RGBColor[1, 0, 0]],
 "[];\n\n(* General Parameters: gap, # of periods, unit length, offset (not \
used), and ending suppresion on:0/off:1 *)\n\
gap=20;NumPer=2;per=220;gapoffset=0;ending=1;zer={0,0,0};\n\n(* Spacing \
Parameters for exploded view *)\nsp={0,0,0};\n\n(* Pole Parameters, lengths \
in x,y,z, # of subdivision, color, and chamfer *)\n\
lp={70,35,90};np={2,2};cp={1,0,1};chp={9,0,10};\n\n(* Magnet Parameters, \
chamber: x(outer), y(inner), z(depth) *)\n\
lm={120,per/2-lp[[2]],130};nm={2,2};cm={0,1,1};chm={10,0,10};\n\n(* Side \
Magnet Parameters *)\nlsm={(lm[[1]]-lp[[1]])/2,lp[[2]],110};csm={0,0.5,1};\n\n\
(* End Pole Parameters *)\nlep={lp[[1]],20,lp[[3]]};\n\n(* End Side Magnet \
Parameters *)\n(*les={lsm[[1]],lep[[2]],80};*)\nles={lsm[[1]],lep[[2]],34.0};\
\n\n(* Ending gaps: gap to end pole, gap to end mag *)\ndpm={0,0};\n\n(* \
Define Pole Material *)\nmp=",
 StyleBox["RadMatAFK502",
  FontColor->RGBColor[1, 0, 0]],
 "[];\n(*mp=",
 StyleBox["radMatSatIso",
  FontColor->RGBColor[1, 0, 0]],
 "[ma];*)\n\n(* Define NdFeB with 1.2 Tesla Remanent Magnetization *)\nmm=",
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 "[1.2];\n\n(* Define function to assign segmentation, color, material *)\n\
fullMag[u_,x_,y_,z_]:=(",
 StyleBox["radObjDivMag",
  FontColor->RGBColor[1, 0, 0]],
 "[u,x];",
 StyleBox["radObjDrwAtr",
  FontColor->RGBColor[1, 0, 0]],
 "[u,y];",
 StyleBox["radMatApl",
  FontColor->RGBColor[1, 0, 0]],
 "[u,z]);\n\n(* Build the Structure *)\nund=wig[];\n\nPrint[\"Total length \
(\",numpoles,\" poles): \",totallength,\" mm\"];"
}], "Input",
 CellChangeTimes->{{3.8495692848909044`*^9, 3.849569336752112*^9}, 
   3.8495693920961084`*^9, {3.849570158055762*^9, 3.8495703000384903`*^9}, {
   3.849570372951692*^9, 3.8495703988626437`*^9}, {3.849575778774073*^9, 
   3.8495757788673058`*^9}, {3.8495766702841578`*^9, 3.849576680086192*^9}, {
   3.8495768230289803`*^9, 3.8495768327573757`*^9}, {3.84957690404572*^9, 
   3.849576958588648*^9}, {3.8495770422160616`*^9, 3.8495770435256042`*^9}, {
   3.84957737147299*^9, 3.849577381335451*^9}, 3.8495774146560516`*^9, {
   3.8495780525607934`*^9, 3.849578065378665*^9}, {3.849578099416645*^9, 
   3.849578107873892*^9}, {3.849578168782466*^9, 3.849578169299701*^9}, {
   3.8496500276086655`*^9, 3.849650110608214*^9}, {3.849650415393181*^9, 
   3.849650439713094*^9}, {3.8496505499439507`*^9, 3.84965059343355*^9}, {
   3.849651505460634*^9, 3.8496515094006414`*^9}, {3.8496516144490395`*^9, 
   3.8496516150590396`*^9}, {3.8496540321387825`*^9, 3.849654032788781*^9}, {
   3.8496541234826956`*^9, 3.8496541246026955`*^9}, {3.849654158292637*^9, 
   3.8496541811111484`*^9}, {3.8496588380218706`*^9, 3.849658870611829*^9}, {
   3.8496600692970963`*^9, 3.8496600759571037`*^9}, {3.849660247099047*^9, 
   3.8496602562790403`*^9}, 3.849660344108995*^9, {3.8496614569198008`*^9, 
   3.8496614906112375`*^9}, {3.849753056980522*^9, 3.8497530622841077`*^9}, {
   3.849761782410742*^9, 3.849761924334885*^9}, {3.8497621157985525`*^9, 
   3.849762152258139*^9}, 3.8497625788173227`*^9, {3.850362367350247*^9, 
   3.8503623920640783`*^9}, {3.8503625936266017`*^9, 
   3.8503626095242615`*^9}, {3.850362683559995*^9, 3.850362688669467*^9}, {
   3.850363138406599*^9, 3.850363154544655*^9}, {3.8503631916733685`*^9, 
   3.850363195469898*^9}, {3.8503634236267133`*^9, 3.850363429467437*^9}, 
   3.8503634702818503`*^9, {3.850363523062216*^9, 3.850363523578534*^9}, {
   3.8503636890510206`*^9, 3.8503636956032314`*^9}, {3.850364181288765*^9, 
   3.850364181476429*^9}, {3.8503646856669655`*^9, 3.850364689875766*^9}, {
   3.8503648353898892`*^9, 3.850364842039752*^9}, 3.8503652848064833`*^9, 
   3.8503653468962994`*^9, 3.8503654043359585`*^9, 3.8503654581685476`*^9, {
   3.850365556919186*^9, 3.8503655575748777`*^9}, 3.850365660327491*^9, {
   3.8503658116925545`*^9, 3.8503658120650525`*^9}, 3.8503660427306604`*^9, 
   3.8503661979945765`*^9, {3.8503666013516135`*^9, 3.8503666015394783`*^9}, 
   3.8503667170917134`*^9, 3.8503668433438826`*^9, 3.85036696409534*^9, 
   3.850367113803413*^9, {3.8503672199669724`*^9, 3.850367220150963*^9}, {
   3.850425553867792*^9, 3.850425576836104*^9}, {3.8504256284113626`*^9, 
   3.850425648541767*^9}, {3.8504257301192913`*^9, 3.8504257485175104`*^9}, {
   3.8504258047764344`*^9, 3.8504258244629374`*^9}, 3.850425898206072*^9, {
   3.850426007211625*^9, 3.8504260085296154`*^9}, {3.850426469882306*^9, 
   3.8504264825763807`*^9}, {3.850426705166568*^9, 3.850426739924523*^9}, {
   3.8504268204201403`*^9, 3.8504268239949102`*^9}, 3.8504268852079835`*^9, {
   3.8504272414888334`*^9, 3.8504272428949375`*^9}, 3.850427599081679*^9, {
   3.8504277218442917`*^9, 3.8504277225488467`*^9}, {3.8504513066007776`*^9, 
   3.850451315749297*^9}, {3.8504514082860956`*^9, 3.850451408381217*^9}, {
   3.850451514378485*^9, 3.8504515218444176`*^9}, {3.8504515851531115`*^9, 
   3.8504515980144663`*^9}, {3.8504516942208376`*^9, 3.850451730716586*^9}, {
   3.850452019357902*^9, 3.850452025039811*^9}, {3.8504530937143393`*^9, 
   3.850453102008336*^9}, 3.8504531906340127`*^9, {3.8504533153725767`*^9, 
   3.8504533210428843`*^9}, {3.850453404871477*^9, 3.850453410435543*^9}, 
   3.850453625739596*^9, 3.8504539891133165`*^9, {3.8504540591861324`*^9, 
   3.8504540630279026`*^9}, {3.8505364330713835`*^9, 
   3.8505364344826407`*^9}, {3.8505365190936346`*^9, 
   3.8505365207736206`*^9}, {3.8505366152067165`*^9, 
   3.8505366173635783`*^9}, {3.850536876159954*^9, 3.8505368774718957`*^9}, {
   3.8510488421966686`*^9, 3.851048843491663*^9}, {3.851049586100518*^9, 
   3.851049587889352*^9}, {3.8510871421676283`*^9, 3.851087142278759*^9}, {
   3.8511235985408697`*^9, 3.8511235987869263`*^9}, {3.85112587561395*^9, 
   3.8511258764051967`*^9}, {3.8511276386778374`*^9, 
   3.8511276390253725`*^9}, {3.85112988397759*^9, 3.8511298844901314`*^9}, {
   3.8511367700868177`*^9, 3.8511367706093016`*^9}, 3.85113807045614*^9, {
   3.851142743682721*^9, 3.8511427438692875`*^9}, {3.8511439175339055`*^9, 
   3.8511439180137987`*^9}, 3.8511451759181767`*^9, {3.8511453017382345`*^9, 
   3.8511453023968525`*^9}, {3.851145921364147*^9, 3.8511459319114723`*^9}, {
   3.851146040852874*^9, 3.851146040865836*^9}, {3.851146160081445*^9, 
   3.8511461606465135`*^9}, 3.8511463941905026`*^9, {3.851461379591907*^9, 
   3.8514613963733387`*^9}, {3.851461905728488*^9, 3.8514619441626244`*^9}, {
   3.8514619913033524`*^9, 3.851462063936046*^9}, {3.8514657422752295`*^9, 
   3.8514657439588614`*^9}, {3.8514658000365067`*^9, 3.851465802420993*^9}, {
   3.851465906273092*^9, 3.8514659086706533`*^9}, {3.851739749270759*^9, 
   3.8517397514791484`*^9}, 3.8517397820065966`*^9, 3.8517398164524703`*^9, {
   3.851745433611781*^9, 3.851745444147046*^9}, {3.8517455142483916`*^9, 
   3.851745518904194*^9}, {3.851745574933626*^9, 3.851745600632904*^9}, {
   3.851746628543537*^9, 3.851746628681171*^9}, 3.8517467194914446`*^9, 
   3.8517468810213065`*^9, {3.8517474043454227`*^9, 3.8517474074714766`*^9}, 
   3.8517474540222683`*^9, {3.8517476196253166`*^9, 3.8517476269918647`*^9}, {
   3.851747709966254*^9, 3.851747716464946*^9}, {3.8517478459410796`*^9, 
   3.8517478538322725`*^9}, {3.8517526452432575`*^9, 
   3.8517526456576586`*^9}, {3.851752781948519*^9, 3.851752782381775*^9}, {
   3.8520020144938*^9, 3.8520020152537556`*^9}, {3.8520026065281396`*^9, 
   3.852002639483098*^9}, {3.852002763358762*^9, 3.852002791884385*^9}, {
   3.852002872626895*^9, 3.852002892591587*^9}, 3.8534574415274677`*^9, {
   3.853457554225955*^9, 3.8534575543219604`*^9}, {3.8534575943022118`*^9, 
   3.8534575947712803`*^9}, 3.853457637925359*^9, {3.8534576965557065`*^9, 
   3.853457752997728*^9}, {3.853457795303581*^9, 3.853457795727581*^9}, {
   3.853457866001114*^9, 3.8534578667111444`*^9}, {3.853457962003894*^9, 
   3.8534579624273252`*^9}, {3.8534580216772795`*^9, 
   3.8534580220986395`*^9}, {3.8534581100611353`*^9, 3.853458110437186*^9}, {
   3.8534581598645267`*^9, 3.8534581602345347`*^9}, {3.853458213669674*^9, 
   3.8534582143769827`*^9}, {3.853458282604947*^9, 3.853458283026949*^9}, {
   3.8534583321348724`*^9, 3.853458333342902*^9}, {3.853459258798091*^9, 
   3.8534592600691576`*^9}, 3.8534593575593266`*^9, 3.8534594318921795`*^9, {
   3.853459478540307*^9, 3.85345947868386*^9}, {3.8534595342238708`*^9, 
   3.8534595346010885`*^9}, {3.85345957805418*^9, 3.853459578148138*^9}, {
   3.8534596206098022`*^9, 3.853459620799788*^9}, {3.853459658995768*^9, 
   3.8534596590886955`*^9}, 3.8534597023402777`*^9, 3.853459740297572*^9, 
   3.853459779540642*^9, 3.8534598217822504`*^9, {3.85345986415158*^9, 
   3.8534598642913713`*^9}, 3.8534599030909495`*^9, {3.853459945024268*^9, 
   3.8534599451622705`*^9}, {3.853540850333124*^9, 3.853540872264576*^9}, 
   3.853540902359868*^9, {3.8535410353834476`*^9, 3.853541035623848*^9}, {
   3.853542071209032*^9, 3.85354207197538*^9}, {3.8535421914509296`*^9, 
   3.853542201056244*^9}, {3.8535423123497763`*^9, 3.853542334603934*^9}, {
   3.8535423740788813`*^9, 3.8535423991490464`*^9}, {3.8535425947626657`*^9, 
   3.8535426770428963`*^9}, 3.853542771642192*^9, {3.8535430457880116`*^9, 
   3.853543095171542*^9}, {3.8535431275495586`*^9, 3.853543164375802*^9}, {
   3.8535442338694105`*^9, 3.85354423433941*^9}, {3.8535443163113623`*^9, 
   3.8535443169413614`*^9}, {3.853544403701349*^9, 3.8535444041213493`*^9}, 
   3.8535543099649467`*^9, {3.8538887672522497`*^9, 3.8538887673940964`*^9}, {
   3.854344441412094*^9, 3.8543444661308093`*^9}, {3.854346544467913*^9, 
   3.854346554125417*^9}, {3.854346619032477*^9, 3.854346729643385*^9}, {
   3.854346761186941*^9, 3.85434685075185*^9}, {3.854346899232811*^9, 
   3.854346939081559*^9}, {3.8543469716189175`*^9, 3.854346997091382*^9}, {
   3.8544279745146794`*^9, 3.854428063062183*^9}, {3.8544281112206388`*^9, 
   3.8544281143918457`*^9}, {3.8544281559418707`*^9, 
   3.8544281627758684`*^9}, {3.854428328496714*^9, 3.854428334644313*^9}, 
   3.8544284865566473`*^9, {3.8544285774861965`*^9, 3.854428601078596*^9}, {
   3.8544292577767067`*^9, 3.854429261775771*^9}, {3.854429323144385*^9, 
   3.8544293232343254`*^9}, 3.854490583454543*^9, 3.8547592879728785`*^9, {
   3.8547593453973556`*^9, 3.854759370988138*^9}, {3.8547594279060373`*^9, 
   3.854759443402356*^9}, {3.8547595829469233`*^9, 3.8547596014317436`*^9}, {
   3.854759638726978*^9, 3.8547596399168406`*^9}, 3.854759694846144*^9, {
   3.854759955862186*^9, 3.8547599601701474`*^9}, {3.8547602031773186`*^9, 
   3.8547602325005074`*^9}, {3.854762074577223*^9, 3.8547620776212163`*^9}, {
   3.8547622074946623`*^9, 3.8547622121786494`*^9}, {3.8547623073099356`*^9, 
   3.85476230993301*^9}, {3.855623925695157*^9, 3.855623939611549*^9}, {
   3.855624004184059*^9, 3.855624005729573*^9}, {3.855624044928923*^9, 
   3.855624046195738*^9}, {3.8556241231908007`*^9, 3.8556243018071995`*^9}, {
   3.855624357136744*^9, 3.8556244227066803`*^9}, {3.8556244681393547`*^9, 
   3.8556244793302293`*^9}, {3.855624525300475*^9, 3.855624526238421*^9}, 
   3.872803039410325*^9, 3.872803073886324*^9, {3.872803224870792*^9, 
   3.872803233895694*^9}, {3.8728032857217293`*^9, 3.872803285959813*^9}, {
   3.872803367975639*^9, 3.8728033681636677`*^9}, {3.872803404247867*^9, 
   3.8728035680684104`*^9}, {3.8729087316378517`*^9, 
   3.8729087401040945`*^9}, {3.8729088274772687`*^9, 3.872908827697934*^9}, 
   3.8729089215159817`*^9, 3.8729089579228687`*^9, 3.872908998672201*^9, 
   3.872909099720125*^9, 3.8729091535821214`*^9, {3.8729091931121283`*^9, 
   3.872909220380149*^9}, {3.8729093278233347`*^9, 3.872909383290944*^9}, 
   3.8729094144982038`*^9, 3.872909622056717*^9, 3.872911536775921*^9, {
   3.872911568788245*^9, 3.872911595568243*^9}, {3.8729116289445267`*^9, 
   3.872911756266997*^9}, {3.8737731953127193`*^9, 3.873773195502719*^9}, {
   3.8737734195984488`*^9, 3.873773423538967*^9}, 3.8737743472024045`*^9, {
   3.8738356108999033`*^9, 3.8738356531150455`*^9}, 3.8738359018189583`*^9, {
   3.8738379401551237`*^9, 3.873837962062958*^9}, {3.873838227361147*^9, 
   3.8738382305011435`*^9}, {3.8738400569192133`*^9, 3.873840057199222*^9}, 
   3.873840271250455*^9, 3.87384470856783*^9, 3.8738475103928924`*^9, {
   3.873864388180604*^9, 3.873864393999298*^9}, 3.874028075907876*^9, {
   3.874028470606369*^9, 3.874028479892212*^9}, 3.874029627207472*^9, 
   3.874031681700382*^9, {3.874373254160679*^9, 3.87437325869284*^9}, 
   3.874379323632713*^9, {3.874381653106589*^9, 3.8743816577927575`*^9}, 
   3.8743817161647763`*^9, {3.874381916425956*^9, 3.874381919699418*^9}, {
   3.8745338351125765`*^9, 3.874533845459112*^9}, 3.874534126872942*^9, {
   3.8745341625311766`*^9, 3.8745343695234365`*^9}, {3.8745457320987606`*^9, 
   3.8745457320987606`*^9}, {3.8745457710452614`*^9, 3.874545789231279*^9}, {
   3.8745458278707504`*^9, 3.8745458278707504`*^9}, {3.8745458638773203`*^9, 
   3.8745458638773203`*^9}, {3.8745459210829096`*^9, 
   3.8745460547152157`*^9}, {3.874548386023799*^9, 3.874548386203787*^9}, {
   3.8752359805136256`*^9, 3.875236010445729*^9}, 3.875236891116954*^9, {
   3.8752458604306865`*^9, 3.8752458628259554`*^9}},
 AspectRatioFixed->True,
 CellLabel->
  "In[218]:=",ExpressionUUID->"f9610f9d-2237-404b-bdbc-ee8eeedef1ac"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot Geometry", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.3999127615620003`*^9, 3.3999127622651253`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"6a40f96f-68cb-45d3-903a-0cca6a81d7d5"],

Cell["\<\
The following instructions create a set of 3D graphical primitives \
representing the structure in space, and plot it.\
\>", "Text",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"5e3354bb-12e3-478d-8e39-b51d423c832d"],

Cell[TextData[{
 StyleBox["draw=",
  FontColor->GrayLevel[0]],
 StyleBox["radObjDrw",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[und];",
  FontColor->GrayLevel[0]],
 StyleBox["\n\nRadPlot3DOptions",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nShow[Graphics3D[draw]\n,ViewPoint->{5,-1.5,2}\n,PlotRange->All]\n\n\
Export[FileNameJoin[{NotebookDirectory[],\"Mag_p\"<>ToString[NumPer*2+1]<>\"_\
n\"<>ToString[np[[1]]]<>\"_g\"<>ToString[gap]<>\"_3D.vtk\"}], Graphics3D[",
 StyleBox["draw",
  FontColor->GrayLevel[0]],
 "]]"
}], "Input",
 CellChangeTimes->{
  3.3998980155276566`*^9, {3.3999126650776253`*^9, 3.3999126661557503`*^9}, {
   3.6700787688556767`*^9, 3.670078772058878*^9}, {3.849654027638794*^9, 
   3.849654027968789*^9}, {3.8510564806522017`*^9, 3.851056483773333*^9}, {
   3.8510565721155987`*^9, 3.851056597193217*^9}, {3.8510569866200056`*^9, 
   3.851056987152727*^9}, {3.8510593375185065`*^9, 3.851059338732342*^9}, {
   3.851062876417424*^9, 3.8510628771751432`*^9}, 3.8510631499096613`*^9, {
   3.8510660425758533`*^9, 3.851066043538373*^9}, 3.851068343887452*^9, {
   3.8510693562036886`*^9, 3.8510693717988963`*^9}, {3.85113420436419*^9, 
   3.851134207383194*^9}, {3.8511368466404963`*^9, 3.851136847647799*^9}, {
   3.8511381095035934`*^9, 3.8511381098269267`*^9}, {3.851143217672477*^9, 
   3.851143220086031*^9}, {3.851143291526165*^9, 3.8511432956033397`*^9}, {
   3.851143412846573*^9, 3.851143445720421*^9}, {3.851747656656841*^9, 
   3.8517476971852636`*^9}, {3.853540760699243*^9, 3.8535407711310062`*^9}, {
   3.8535410571957884`*^9, 3.8535410718029985`*^9}, {3.853896546528343*^9, 
   3.853896571811363*^9}, {3.853896662946783*^9, 3.8538966699670277`*^9}, 
   3.853896777338599*^9, {3.854428169919366*^9, 3.8544281723117733`*^9}, {
   3.8544912741195087`*^9, 3.8544912746035175`*^9}, {3.854759299049115*^9, 
   3.8547593016975613`*^9}, {3.8547599838227797`*^9, 3.854760017470727*^9}, {
   3.874969408880315*^9, 3.874969472976459*^9}, 3.8749695586022234`*^9, {
   3.8749696304161386`*^9, 3.8749697099541645`*^9}, 3.87497056317663*^9, {
   3.8749713777933464`*^9, 3.8749714041090994`*^9}, {3.874971435152404*^9, 
   3.8749714964802756`*^9}, {3.8749791275597878`*^9, 3.87497914703551*^9}, {
   3.874979230505808*^9, 3.874979271378941*^9}, 3.874983658785466*^9, 
   3.874983841641162*^9, {3.8749843111986*^9, 3.874984331958038*^9}, {
   3.8749843719787507`*^9, 3.8749844277385683`*^9}, {3.87523613924306*^9, 
   3.8752361489039235`*^9}, {3.8752361845796747`*^9, 3.87523633353271*^9}},
 AspectRatioFixed->True,
 CellLabel->
  "In[212]:=",ExpressionUUID->"c7896b99-1018-444a-acab-41eef79736aa"]
}, Closed]],

Cell[CellGroupData[{

Cell["Solve", "Section",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"f2047b13-2bc0-4c07-9f29-d3a1640badca"],

Cell["\<\
The following instructions Solve for the magnetization of each sub-block \
which constitutes the wiggler.\
\>", "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8520030112593613`*^9, 3.8520030122255955`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"74e90033-9ad3-4443-87b6-7ba9132b1854"],

Cell[TextData[{
 "t0=AbsoluteTime[];\nre=",
 StyleBox["RadSolve",
  FontColor->RGBColor[1, 0, 0]],
 "[und,0.0003,1000];\nt1=AbsoluteTime[];\n\nPrint[\"Solved in : \
\",Round[t1-t0],\" seconds\"];\nPrint[\"Number of Iterations : \",re[[4]]];\n\
Print[\"Average Stability of Magnetization at the last iteration : \
\",N[re[[1]],2],\" T\"];\nPrint[\"Maximum Absolute Magnetization at the last \
iteration : \",N[re[[2]],4],\" T\"];\nPrint[\"Maximum H vector at the last \
iteration : \",N[re[[3]],4],\" T\"];\nPrint[\"\"];\nPrint[\"Central (odd) \
Field Bz(0,0,0) : \",N[",
 StyleBox["radFld",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"Bz\",zer],4],\" T\"];\nPrint[\"Even-pole Field Bz(0,\",-per/4,\",0) \
: \",N[",
 StyleBox["radFld",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"Bz\",{0,-per/4,0}],4],\" T\"];"
}], "Input",
 CellChangeTimes->{{3.849659983329946*^9, 3.8496599986770363`*^9}, {
  3.8517479409441953`*^9, 3.8517479946003323`*^9}, {3.85174804863535*^9, 
  3.8517480668304615`*^9}, {3.8517481049917417`*^9, 3.8517482284525623`*^9}, {
  3.8517482640160313`*^9, 3.8517482656009192`*^9}, {3.873838158361765*^9, 
  3.873838214173647*^9}},
 AspectRatioFixed->True,
 CellLabel->
  "In[123]:=",ExpressionUUID->"177175c9-89ec-406b-9603-c0cf26effe5b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot the Magnetic Field", "Section",
 Evaluatable->False,
 CellChangeTimes->{3.8729088539939547`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"13a563cc-9ccb-4a8d-94c4-8905ca7468b5"],

Cell[TextData[{
 StyleBox["RadPlotOptions",
  FontColor->RGBColor[1, 0, 0]],
 "[];\ntrj=Plot[",
 StyleBox["radFld",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"Bz\",{0,y,0}],{y,-(NumPer+1)/1*per,(NumPer+1)/1*per}\n\
,AxesOrigin->{0,0}\n,RotateLabel->True\n,FrameLabel->{\"Y [mm]\",\"Bz \
[T]\",\"X = Z =  0\",\"\"}]\n(*Print[trj[[1,1,1,3,1,2,1]]];*)\n(*t=Table[{y, ",
 StyleBox["radFld",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"Bz\",{0,y,0}]},{y,-(NumPer+1)/1*per,(NumPer+1)/1*per}];*)\n\
t=Table[trj[[1,1,1,3,1,2,1]]];\n\
Export[FileNameJoin[{NotebookDirectory[],\"Field_y_p\"<>ToString[NumPer*2+1]<>\
\"_n\"<>ToString[np[[1]]]<>\"_g\"<>ToString[gap]<>\".dat\"}],t]"
}], "Input",
 CellChangeTimes->{
  3.3999127191557503`*^9, {3.8495763030167513`*^9, 3.8495763573241215`*^9}, {
   3.8495775405648103`*^9, 3.8495775906862516`*^9}, {3.8496601464032965`*^9, 
   3.8496601466895857`*^9}, {3.849761336890487*^9, 3.8497613391008987`*^9}, {
   3.85114069017412*^9, 3.851140729321649*^9}, {3.8511408678675833`*^9, 
   3.8511408725854626`*^9}, {3.87291129806186*^9, 3.872911298531849*^9}, {
   3.872912206662447*^9, 3.8729122115994415`*^9}, {3.872912281301263*^9, 
   3.8729122828452625`*^9}, {3.8731492583236976`*^9, 3.8731492585645647`*^9}, 
   3.873149289407671*^9, {3.8731493426423607`*^9, 3.873149368618701*^9}, 
   3.873149436296256*^9, {3.874538080633662*^9, 3.874538143178136*^9}, {
   3.874539686126153*^9, 3.8745398089580083`*^9}, {3.874539841604335*^9, 
   3.8745398590701466`*^9}, {3.874539956012993*^9, 3.8745400036065426`*^9}, {
   3.8745402211841393`*^9, 3.8745402320610266`*^9}, {3.8745403942783484`*^9, 
   3.874540424227538*^9}, {3.8745404580990314`*^9, 3.8745404603394938`*^9}, {
   3.8745404991387024`*^9, 3.8745405332617636`*^9}, {3.874540600738474*^9, 
   3.874540634496504*^9}, 3.8745406722592926`*^9, {3.874540717270974*^9, 
   3.8745407606565638`*^9}, {3.8745408665589266`*^9, 3.874540926278302*^9}, {
   3.874540997752496*^9, 3.8745409988725123`*^9}, 3.874548446011737*^9, 
   3.8752363735636945`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"c23c1001-0828-48db-935f-f2cd6a792019"],

Cell[TextData[{
 StyleBox["RadPlotOptions",
  FontColor->RGBColor[1, 0, 0]],
 "[];\ntrj=Plot[",
 StyleBox["radFld",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"Bz\",{x,0,0}],{x,-100,100}\n,AxesOrigin->{0,0}\n,RotateLabel->True\n\
,FrameLabel->{\"X [mm]\",\"Bz [T]\",\"Y = Z =  0\",\"\"}]\n(*t=Table[{x, ",
 StyleBox["radFld",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"Bz\",{x,0,0}]},{x,-100,100}];*)\nt=Table[trj[[1,1,1,3,1,2,1]]];\n\
Export[FileNameJoin[{NotebookDirectory[],\"Field_x_p\"<>ToString[NumPer*2+1]<>\
\"_n\"<>ToString[np[[1]]]<>\"_g\"<>ToString[gap]<>\".dat\"}],t]"
}], "Input",
 CellChangeTimes->{
  3.3999127191557503`*^9, {3.8495763030167513`*^9, 3.8495763573241215`*^9}, {
   3.8495775405648103`*^9, 3.8495775906862516`*^9}, {3.8496601464032965`*^9, 
   3.8496601466895857`*^9}, {3.849761336890487*^9, 3.8497613391008987`*^9}, {
   3.85114069017412*^9, 3.851140729321649*^9}, {3.8511408678675833`*^9, 
   3.8511408725854626`*^9}, {3.8535650996013255`*^9, 
   3.8535651407326827`*^9}, {3.8731493042701015`*^9, 3.87314933960233*^9}, 
   3.873149382782696*^9, {3.8731494227907476`*^9, 3.8731494500427456`*^9}, 
   3.8731495400388813`*^9, {3.8745399316897764`*^9, 3.8745399434377656`*^9}, {
   3.874540074426299*^9, 3.874540078966281*^9}, {3.874540139945366*^9, 
   3.8745401491892595`*^9}, {3.8745402144723644`*^9, 3.8745402170681896`*^9}, 
   3.8745484440950155`*^9, 3.8752363787677107`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"e9f58193-654c-4f92-8a2c-0c0bd8095936"]
}, Closed]],

Cell[CellGroupData[{

Cell["Checking the Magnetic Material", "Section",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"e828e54d-83b4-4eec-9b65-9a304282b9bf"],

Cell[TextData[StyleBox["This cell presents a plot of the Magnetization vs \
Field Strength for the materials in use. Note that the NdFeB is anisotropic.",
 Evaluatable->False,
 AspectRatioFixed->True]], "Text",
 Evaluatable->False,
 CellChangeTimes->{3.8513937128169065`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"f141ba92-ffae-45d5-8d00-15d26515a7ef"],

Cell[TextData[{
 StyleBox["RadPlotOptions",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nPlot[",
 StyleBox["radMatMvsH",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["[pole",
  FontColor->GrayLevel[0]],
 ", \"mz\", {0,0,hz}],{hz,-0.01,0.01}\n,FrameLabel->\"Pole Material \"\n\
,AxesLabel->{\"H\",\"M\"}\n]\n\nPlot[\n{",
 StyleBox["radMatMvsH",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet, \"mz\", {0,0,h}]\n,",
 StyleBox["radMatMvsH",
  FontColor->RGBColor[1, 0, 0]],
 "[magnet, \"my\", {0,h,0}]}\n,{h,-1,1}\n,FrameLabel->\"NdFeB\"\n\
,AxesLabel->{\"H\",\"M\"}\n]"
}], "Input",
 CellChangeTimes->{
  3.3999127861088753`*^9, 3.41130367171875*^9, {3.41130375146875*^9, 
   3.411303760375*^9}, {3.411304570453125*^9, 3.411304577265625*^9}, {
   3.8538968038528557`*^9, 3.853896806962809*^9}, {3.8538968398284435`*^9, 
   3.853896842285179*^9}, {3.8538969411677217`*^9, 3.853896973075436*^9}, 
   3.8543431671935835`*^9, {3.8543432915121307`*^9, 3.85434329309089*^9}, 
   3.8543433834582863`*^9, {3.8543434357918067`*^9, 3.8543434415619507`*^9}, {
   3.8543435290028753`*^9, 3.854343536831567*^9}, {3.8543436099691167`*^9, 
   3.854343659507372*^9}, {3.85434561065574*^9, 3.8543456436795692`*^9}, {
   3.873157806238907*^9, 3.873157898190508*^9}, {3.873158177418696*^9, 
   3.8731581776506596`*^9}, {3.873158213922814*^9, 3.8731582309430294`*^9}, {
   3.8731584255192814`*^9, 3.87315845407543*^9}, {3.8731687140379896`*^9, 
   3.873168728313053*^9}, {3.873168761114502*^9, 3.8731688529092445`*^9}, {
   3.8731688898395004`*^9, 3.873168891549518*^9}, {3.8731689713219075`*^9, 
   3.873168980048828*^9}, {3.873769704252731*^9, 3.87376974901378*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"9113889a-20af-485c-be53-acb2e2734784"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot the Beam Trajectory", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.849758921283576*^9, 3.8497589306411304`*^9}, 
   3.8729087986019197`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"e04a0304-5016-4e5e-8082-9f5a6046bd21"],

Cell[TextData[{
 "trj=",
 StyleBox["radFldPtcTrj",
  FontColor->RGBColor[1, 0, 0]],
 "[und,1.2,{0,0,0,0},{-2000,2000},1001];\n(*trjy=Table[x, {x, -2000, 2000, \
4}];*)\ntrjy=trj[[All,1]];\ntrjx=trj[[All,2]];\nt2=Table[{trjy[[z]], \
trjx[[z]]}, {z, 1, 1001}];\n\
Export[FileNameJoin[{NotebookDirectory[],\"Trajectory_x0_p\"<>ToString[NumPer*\
2+1]<>\"_n\"<>ToString[np[[1]]]<>\"_g\"<>ToString[gap]<>\"_esz34.dat\"}],t2]\n\
ListLinePlot[t2,PlotRange->{{-(NumPer+2)*(per*2/3),(NumPer+2)*(per*2/3)}, \
{-0.5,1.2}}\n,Frame->True,FrameLabel->{\"Y [mm]\",\"Trajectory [mm]\",\" Z = \
0 \",\"\"}\n,RotateLabel->True,GridLines->Automatic, \
PlotStyle->{Thickness[0.002]}]\n\ntrja=1000*trj[[All,3]];\n\
t3=Table[{trjy[[z]], trja[[z]]}, {z, 1, 1001}];\n\
Export[FileNameJoin[{NotebookDirectory[],\"Trajectory_x1_p\"<>ToString[NumPer*\
2+1]<>\"_n\"<>ToString[np[[1]]]<>\"_g\"<>ToString[gap]<>\"_esz34.dat\"}],t3]\n\
ListLinePlot[t3,PlotRange->{{-(NumPer+2)*(per*2/3),(NumPer+2)*(per*2/3)},{-20,\
 20}}\n,Frame->True,FrameLabel->{\"Y [mm]\",\"Angle [mrad]\",\" Z = 0 \
\",\"\"}\n,RotateLabel->True,GridLines->Automatic, \
PlotStyle->{Thickness[0.002]}]"
}], "Input",
 CellChangeTimes->{
  3.3999127191557503`*^9, {3.8495763030167513`*^9, 3.8495763573241215`*^9}, {
   3.8495775405648103`*^9, 3.8495775906862516`*^9}, {3.8496601464032965`*^9, 
   3.8496601466895857`*^9}, {3.849758934201888*^9, 3.849758965466861*^9}, {
   3.849758995671694*^9, 3.8497590471613293`*^9}, {3.849759085428671*^9, 
   3.8497590945203657`*^9}, {3.84975914289253*^9, 3.849759163404252*^9}, {
   3.849759205625345*^9, 3.8497593014898973`*^9}, {3.8497596618549557`*^9, 
   3.8497597278699403`*^9}, {3.849759759190307*^9, 3.8497598462145157`*^9}, {
   3.849760235398965*^9, 3.849760282003975*^9}, {3.849760325119749*^9, 
   3.8497603336507263`*^9}, {3.8497604471952887`*^9, 
   3.8497605503955956`*^9}, {3.849760662613845*^9, 3.8497607015724382`*^9}, {
   3.8497609083795815`*^9, 3.8497609550850444`*^9}, {3.849760998170805*^9, 
   3.849761017911478*^9}, {3.8497610816185737`*^9, 3.849761097306507*^9}, {
   3.849761140545887*^9, 3.8497611658474884`*^9}, {3.8497613167874346`*^9, 
   3.8497613183774357`*^9}, {3.849761371098154*^9, 3.8497613853107233`*^9}, {
   3.849761435924719*^9, 3.84976143981538*^9}, {3.8731495883568454`*^9, 
   3.8731496654829445`*^9}, {3.873151645136984*^9, 3.873151733502899*^9}, 
   3.8731518287880735`*^9, {3.8731519632233973`*^9, 3.873151980442554*^9}, {
   3.873152078243929*^9, 3.8731521289921436`*^9}, {3.873152393850757*^9, 
   3.873152401957018*^9}, 3.8731525811169577`*^9, {3.8731526255330863`*^9, 
   3.873152633905614*^9}, {3.8731527095218153`*^9, 3.873152723832174*^9}, {
   3.873152912943234*^9, 3.8731529469072104`*^9}, {3.8731531825829515`*^9, 
   3.873153194229101*^9}, {3.8731532557841825`*^9, 3.8731532617590756`*^9}, {
   3.8731540472438226`*^9, 3.873154051811249*^9}, {3.8731541439892178`*^9, 
   3.873154199015379*^9}, {3.873154268664457*^9, 3.873154288715515*^9}, 
   3.8731543316346245`*^9, {3.8731544911132784`*^9, 3.8731544949616814`*^9}, {
   3.873154631244213*^9, 3.8731546609572897`*^9}, {3.8731547171041956`*^9, 
   3.8731547466900682`*^9}, {3.873154900177001*^9, 3.8731549394262495`*^9}, {
   3.873155060717128*^9, 3.8731550921853657`*^9}, {3.8731551439739046`*^9, 
   3.873155152246679*^9}, {3.873155190102206*^9, 3.8731551931443143`*^9}, {
   3.873155235682529*^9, 3.8731552715605145`*^9}, {3.87315533162784*^9, 
   3.8731553624398537`*^9}, {3.873155645637825*^9, 3.873155660803918*^9}, {
   3.8731556942709036`*^9, 3.873155704555462*^9}, {3.873155786277837*^9, 
   3.8731558194871817`*^9}, {3.8731558728919*^9, 3.8731558995078373`*^9}, {
   3.873155956665845*^9, 3.873155960571486*^9}, {3.8731560091798105`*^9, 
   3.873156012855734*^9}, {3.8731560432317114`*^9, 3.873156058703618*^9}, {
   3.8731562053644533`*^9, 3.8731562169117317`*^9}, {3.873156262205022*^9, 
   3.873156431840908*^9}, 3.873156473775015*^9, {3.873156554510163*^9, 
   3.8731565994932814`*^9}, {3.873156639880785*^9, 3.873156704518467*^9}, {
   3.873156743266735*^9, 3.8731567710766864`*^9}, {3.873156916640628*^9, 
   3.873156988918971*^9}, {3.873772240986657*^9, 3.8737722578070507`*^9}, 
   3.873772296231247*^9, {3.8737724433559613`*^9, 3.8737724442262287`*^9}, 
   3.8737724834514017`*^9, {3.873772586885578*^9, 3.8737725889135513`*^9}, {
   3.8737727020164366`*^9, 3.8737727044097257`*^9}, {3.8737727499687405`*^9, 
   3.8737727584576764`*^9}, {3.873772789034867*^9, 3.8737728413611565`*^9}, {
   3.873772885523624*^9, 3.8737729426578927`*^9}, {3.8737729763101673`*^9, 
   3.8737730482340374`*^9}, 3.8737731670352793`*^9, {3.873773310459447*^9, 
   3.87377331228532*^9}, {3.873773402684389*^9, 3.873773407752008*^9}, 
   3.8737735945940695`*^9, {3.8737738399731383`*^9, 3.873773929911495*^9}, {
   3.8737739802542524`*^9, 3.8737739841946917`*^9}, {3.8737740378927293`*^9, 
   3.8737740434486303`*^9}, {3.873774074448284*^9, 3.8737740802549286`*^9}, {
   3.8737741180472474`*^9, 3.8737741457169504`*^9}, {3.873774179995798*^9, 
   3.8737741816836944`*^9}, {3.8737742263459225`*^9, 3.873774304601469*^9}, {
   3.8737744177504325`*^9, 3.8737744466891375`*^9}, {3.873837802904654*^9, 
   3.8738378985281243`*^9}, {3.8738380358601503`*^9, 
   3.8738380561037683`*^9}, {3.8745340185935273`*^9, 
   3.8745341066531334`*^9}, {3.8745341397264795`*^9, 3.874534143473506*^9}, {
   3.8745341745808*^9, 3.874534331431533*^9}, {3.8745343873127613`*^9, 
   3.8745343985800934`*^9}, {3.874548250578047*^9, 3.8745482579179144`*^9}, {
   3.8752364000749273`*^9, 3.875236406495778*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"87010605-74fc-48a9-915f-936cc44eff69"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot the Field Integrals", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.849759919376339*^9, 3.849759923907228*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"a2a1ed25-3eb1-4bb4-a51c-16e39b7cdbb1"],

Cell[TextData[{
 "int=Plot[",
 StyleBox["radFldInt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"inf\",\"ibz\",{x,-1500,0},{x,1500,0}]",
 StyleBox[",{x,-300,300},",
  FontColor->GrayLevel[0]],
 "\nFrameLabel->{\"X [mm]\",\"IBz [T mm]\",\"Z = 0\",\"\"},\n\
RotateLabel->True]\n(* which means the integral between y = -1500 to 1500 for \
each x ranging from -300 to 300 *)\n(*Print[int[[1,1,1,3,1,2,1]]];*)\n\
t=Table[int[[1,1,1,3,1,2,1]]];\n\
Export[FileNameJoin[{NotebookDirectory[],\"Fieldint_x_p\"<>ToString[NumPer*2+\
1]<>\"_n\"<>ToString[np[[1]]]<>\"_g\"<>ToString[gap]<>\"_esz34.dat\"}],t]"
}], "Input",
 CellChangeTimes->{
  3.3999127191557503`*^9, {3.8495763030167513`*^9, 3.8495763573241215`*^9}, {
   3.8495775405648103`*^9, 3.8495775906862516`*^9}, {3.8496601464032965`*^9, 
   3.8496601466895857`*^9}, {3.8497599323842635`*^9, 3.849759949303007*^9}, {
   3.8497612710557795`*^9, 3.849761273783752*^9}, {3.8503621770710697`*^9, 
   3.8503621775450664`*^9}, {3.850362310944833*^9, 3.8503623453813295`*^9}, 
   3.8503624629955745`*^9, {3.8503625296444254`*^9, 3.850362554205467*^9}, {
   3.8511346117721195`*^9, 3.8511346159356966`*^9}, {3.851739717181954*^9, 
   3.8517397262909775`*^9}, {3.8517399014521427`*^9, 3.851739904336752*^9}, {
   3.8517399876687098`*^9, 3.8517399999438705`*^9}, {3.8517401000230207`*^9, 
   3.8517401322669883`*^9}, {3.85174021449631*^9, 3.851740216074888*^9}, {
   3.8517497462587976`*^9, 3.8517497465026035`*^9}, 3.8520030383119907`*^9, {
   3.853457130484833*^9, 3.8534571471623*^9}, {3.8534572121206446`*^9, 
   3.8534572338930817`*^9}, {3.853457298570691*^9, 3.8534573037304688`*^9}, {
   3.853540254143448*^9, 3.853540288871326*^9}, {3.853542842682109*^9, 
   3.8535428533123746`*^9}, {3.8543458385715113`*^9, 
   3.8543458934140368`*^9}, {3.8543460123843746`*^9, 3.854346069479134*^9}, {
   3.8556253282074385`*^9, 3.8556253316996717`*^9}, {3.855625636580715*^9, 
   3.8556256721702695`*^9}, {3.855628720836735*^9, 3.8556287369275246`*^9}, {
   3.855629152366682*^9, 3.8556291767632065`*^9}, {3.8556292113992558`*^9, 
   3.855629326927168*^9}, {3.8556293734051204`*^9, 3.8556294095644813`*^9}, {
   3.855629691629794*^9, 3.855629732802349*^9}, 3.85562978308834*^9, {
   3.855629823491311*^9, 3.855629850177179*^9}, {3.85563218532474*^9, 
   3.8556322497755637`*^9}, {3.855632328830665*^9, 3.855632335150651*^9}, {
   3.855632495252677*^9, 3.855632496042675*^9}, {3.855808041405472*^9, 
   3.8558080443447013`*^9}, {3.873157202898458*^9, 3.873157245078357*^9}, 
   3.873157276404545*^9, {3.873158505447081*^9, 3.873158505917098*^9}, {
   3.87315857824832*^9, 3.873158618546558*^9}, {3.8731586655095243`*^9, 
   3.8731587472913485`*^9}, {3.873160477096804*^9, 3.8731605330022044`*^9}, {
   3.873160590111107*^9, 3.873160591193328*^9}, 3.8731606616127353`*^9, 
   3.873160703231393*^9, {3.8731607415904818`*^9, 3.8731607784909153`*^9}, {
   3.8731608820441437`*^9, 3.8731610369647026`*^9}, {3.8731610966110163`*^9, 
   3.873161285584781*^9}, {3.873161321364519*^9, 3.8731613935631647`*^9}, {
   3.873161712581431*^9, 3.873161748368446*^9}, {3.873161821084298*^9, 
   3.873161821088298*^9}, {3.874536257360826*^9, 3.8745362651308317`*^9}, {
   3.8745402568189554`*^9, 3.874540264056934*^9}, {3.874545877910248*^9, 
   3.8745458831567583`*^9}, {3.8745459352399416`*^9, 3.874546062574834*^9}, {
   3.8745482371380477`*^9, 3.874548237311759*^9}, 3.8752364169397893`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"2148320c-9341-4d90-84da-6b03cbbe43c4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Magnetization field vector ", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.3999161090463753`*^9, 3.3999161098901253`*^9}, {
  3.8496745837586856`*^9, 3.8496745927688885`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"9f4fbd33-34e8-4c18-a846-4d6c516cc774"],

Cell[TextData[StyleBox["Plot the magnetization in the center of each \
subdivided element of the magnet. ",
 Evaluatable->False,
 AspectRatioFixed->True]], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.849674604328885*^9, 
  3.8496746064188843`*^9}},ExpressionUUID->"547c101f-275c-4514-9faf-\
65051eb7d800"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   StyleBox["RadPlot3DOptions",
    FontColor->RGBColor[1, 0, 0]], "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"fldvec", "=", 
   RowBox[{"ListVectorFieldPlot3D", "[", 
    RowBox[{
     RowBox[{
      StyleBox["radObjM",
       FontColor->RGBColor[1, 0, 0]], "[", "und", "]"}], "\n", ",", 
     RowBox[{"VectorHeads", "->", "True"}], "\n", ",", 
     RowBox[{"ColorFunction", "->", " ", "Hue"}], "\n", ",", 
     RowBox[{"PlotLabel", "->", "\"\<Magnetization in Element # \>\""}], "\n",
      ",", 
     RowBox[{"ViewPoint", "->", 
      RowBox[{"{", 
       RowBox[{"3", ",", "2", ",", " ", "0"}], "}"}]}], "\n", ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{"All", ",", "All", ",", "All"}], "}"}]}], " ", "\n", ",", 
     RowBox[{"ScaleFactor", "->", "15"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Print", "[", 
    RowBox[{"fldvec", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"2", ";;", " ", ";;", " ", "5"}], ",", "1", ",", "1"}], "]"}], 
     "]"}], "]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Print", "[", 
    RowBox[{"fldvec", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"1", ";;", " ", ";;", "5"}]}], "]"}], "]"}], "]"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fldvec", "[", 
          RowBox[{"[", 
           RowBox[{"1", "  ", ",", 
            RowBox[{"2", " ", ";;", " ", ";;", " ", "5"}], ",", " ", "1", ",",
             "1"}], "]"}], "]"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"fldvec", "[", 
          RowBox[{"[", 
           RowBox[{"1", "  ", ",", 
            RowBox[{"2", " ", ";;", " ", ";;", " ", "5"}], ",", " ", "1", ",",
             "2"}], "]"}], "]"}], "}"}], ",", "3"}], "]"}], ",", "1"}], "]"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       StyleBox[
        RowBox[{"\"\<Mag_p\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"NumPer", "*", "2"}], "+", "1"}], "]"}], "<>", 
         "\"\<_n\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"np", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<_g\>\"", "<>", 
         RowBox[{"ToString", "[", "gap", "]"}], "<>", "\"\<_vec.dat\>\""}],
        FontColor->GrayLevel[0]]}], 
      StyleBox["}",
       FontColor->GrayLevel[0]]}], 
     StyleBox["]",
      FontColor->GrayLevel[0]]}], 
    StyleBox[",",
     FontColor->GrayLevel[0]], 
    StyleBox["t",
     FontColor->GrayLevel[0]]}], 
   StyleBox["]",
    FontColor->GrayLevel[0]]}], 
  StyleBox["\[IndentingNewLine]",
   FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox["Export",
   FontColor->GrayLevel[0]], 
  StyleBox["[",
   FontColor->GrayLevel[0]], 
  RowBox[{
   StyleBox[
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       RowBox[{"\"\<Mag_p\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"NumPer", "*", "2"}], "+", "1"}], "]"}], "<>", "\"\<_n\>\"",
         "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"np", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<_g\>\"", "<>", 
        RowBox[{"ToString", "[", "gap", "]"}], "<>", "\"\<_vec.vtk\>\""}]}], 
      "}"}], "]"}],
    FontColor->GrayLevel[0]], 
   StyleBox[",",
    FontColor->GrayLevel[0]], 
   RowBox[{"Graphics3D", "[", "fldvec", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.3999178362963753`*^9, 3.3999185101870003`*^9, {3.849673971733321*^9, 
   3.8496739827637234`*^9}, {3.8496740967892575`*^9, 3.849674131559239*^9}, {
   3.8496742683663273`*^9, 3.849674268667714*^9}, {3.8496743395400047`*^9, 
   3.8496743432800026`*^9}, 3.8511400778628387`*^9, {3.851140642457172*^9, 
   3.8511406749607143`*^9}, {3.851146260392548*^9, 3.8511462719938207`*^9}, {
   3.8731620833011475`*^9, 3.8731621237082624`*^9}, {3.873162220884925*^9, 
   3.8731622291540337`*^9}, {3.8731624374435415`*^9, 
   3.8731624376780205`*^9}, {3.8731705398202667`*^9, 3.873170597189557*^9}, {
   3.873170657578685*^9, 3.8731706820041428`*^9}, {3.873170733186885*^9, 
   3.873170736847183*^9}, {3.873171167803356*^9, 3.8731711713199873`*^9}, {
   3.8731713978458567`*^9, 3.873171399205983*^9}, {3.873171443990018*^9, 
   3.87317145128448*^9}, {3.873235476490508*^9, 3.8732354913910794`*^9}, {
   3.873235919593499*^9, 3.8732360355033617`*^9}, {3.8732361624032393`*^9, 
   3.8732362023907824`*^9}, {3.8738430494207087`*^9, 
   3.8738430782997665`*^9}, {3.8738645381923428`*^9, 
   3.8738645430995865`*^9}, {3.8743737034707108`*^9, 
   3.8743737227804174`*^9}, {3.874373896733656*^9, 3.874373933556782*^9}, {
   3.874374122496338*^9, 3.8743741326116643`*^9}, {3.874374174312461*^9, 
   3.8743741748324614`*^9}, {3.874374530027667*^9, 3.87437453290514*^9}, {
   3.874374859927023*^9, 3.8743748683631544`*^9}, {3.874375018680959*^9, 
   3.8743750241855826`*^9}, {3.8743750760733447`*^9, 3.87437511578864*^9}, {
   3.8743754040169325`*^9, 3.8743755238011265`*^9}, {3.8743756377890844`*^9, 
   3.8743757532638683`*^9}, {3.8743759128239975`*^9, 3.874375962377983*^9}, {
   3.8743759930589485`*^9, 3.8743759961449614`*^9}, {3.874376039383239*^9, 
   3.8743760744754825`*^9}, {3.8743761072517204`*^9, 
   3.8743761126565576`*^9}, {3.8743761982238026`*^9, 3.874376224079115*^9}, {
   3.8743762565387707`*^9, 3.8743762590690784`*^9}, {3.8743762915779266`*^9, 
   3.874376325627499*^9}, {3.874376361767765*^9, 3.874376364104616*^9}, {
   3.8743764957366104`*^9, 3.874376510699926*^9}, {3.87437662047856*^9, 
   3.874376651947129*^9}, {3.874376724047211*^9, 3.8743767264060936`*^9}, {
   3.874376759043358*^9, 3.8743768291404533`*^9}, {3.874376900581311*^9, 
   3.8743769091679487`*^9}, {3.874377285981876*^9, 3.8743772913663745`*^9}, {
   3.8743773540564303`*^9, 3.874377358309749*^9}, {3.874377409919383*^9, 
   3.8743774270110984`*^9}, 3.874377484688851*^9, {3.8743775528656435`*^9, 
   3.8743775633717065`*^9}, {3.8743785062663565`*^9, 3.8743785166111174`*^9}, 
   3.8743793461444187`*^9, 3.8743816810590243`*^9, 3.8743817311037846`*^9, {
   3.8743819526729507`*^9, 3.8743819723438663`*^9}, 3.8745338738947926`*^9, {
   3.874548328093648*^9, 3.874548339503828*^9}, {3.8749715164329185`*^9, 
   3.874971522584694*^9}, 3.87497160355783*^9, {3.875236429635*^9, 
   3.8752364331479197`*^9}},ExpressionUUID->"38b94814-3bb7-4c90-8e7f-\
ddbabc2517b2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Magnetic Force ", "Section",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"d15fabc2-96b4-4a55-b25d-8819783997ee"],

Cell[TextData[{
 StyleBox["One computes the force over the element ",
  Evaluatable->False,
  AspectRatioFixed->True],
 StyleBox["pole",
  Evaluatable->False,
  AspectRatioFixed->True,
  FontColor->RGBColor[1, 0, 0]],
 StyleBox[" induced by the whole structure. One should be cautious that the \
cpu time to compute the force can be very long and one must set the \
segmentation parameter k to the lowest values consistent with sufficient \
precision. Taking into account the symmetry with respect to the x axis \
{1,0,0} would remove the Fx component and double the Fy and Fz components. ",
  Evaluatable->False,
  AspectRatioFixed->True]
}], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.851393648546874*^9, 3.851393657352412*^9}, 
   3.8513937208981*^9, {3.853544499630618*^9, 3.853544500068325*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"b91a60b9-8c56-4759-a8a7-0709b316b6a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "4"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"fr", "=", 
   RowBox[{
    StyleBox["radFldEnrFrc",
     FontColor->RGBColor[1, 0, 0]], "[", 
    RowBox[{"pole", ",", "und", ",", "\"\<\>\"", ",", "k"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<{Fx, Fy, Fz} = \>\"", ",", 
    RowBox[{"N", "[", 
     RowBox[{"fr", ",", "3"}], "]"}], ",", "\"\< Newton\>\""}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", " ", "[", 
   RowBox[{"\"\<cpu time : \>\"", ",", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"t2", "-", "t1"}], ",", "3"}], "]"}], ",", "\"\< seconds\>\""}],
    "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.851048328125846*^9, 3.851048340700386*^9}, {
   3.851048598074871*^9, 3.8510485987790127`*^9}, 3.8510566695405135`*^9, {
   3.851059402479393*^9, 3.8510594066780987`*^9}, {3.8510684298974805`*^9, 
   3.851068433380258*^9}, {3.8510684965444694`*^9, 3.8510684992134743`*^9}, {
   3.8510694108835635`*^9, 3.8510694185248213`*^9}, 3.85112997208502*^9, {
   3.8511340242614408`*^9, 3.8511340256976967`*^9}, {3.851134281246358*^9, 
   3.851134284374837*^9}, {3.8511366993379183`*^9, 3.851136700349275*^9}, 
   3.853544520033885*^9, {3.8538214765601015`*^9, 3.853821525853097*^9}, {
   3.853821571510219*^9, 3.853821579845916*^9}, {3.853821613578614*^9, 
   3.8538216169785976`*^9}},
 CellLabel->
  "In[1496]:=",ExpressionUUID->"49ef75ca-1487-4a29-b498-91c185383a97"]
}, Closed]],

Cell[CellGroupData[{

Cell["Optimizing Parameters in pole and PM dimensions", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.8544920118167677`*^9, 3.8544920507583504`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"da6efea5-2765-4b3e-99fc-4997ed78ea2f"],

Cell[TextData[{
 StyleBox["In this section, some iterations are made on solving and computing \
the peak field of the wiggler as a function of the horizontal width of the \
pole. The segmentation in the pole and magnet has been set to",
  Evaluatable->False,
  AspectRatioFixed->True],
 " {1,1,1} resulting in a quick but inaccurate computation."
}], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8513936674668603`*^9, 3.851393674752615*^9}, {
  3.8535565255182357`*^9, 3.8535565333221936`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"a3592047-feec-4b42-88ad-40a01e8a5b1a"],

Cell[TextData[{
 "gap=20;NumPer=2;per=220;gapoffset=0;ending=1;zer={0,0,0};sp={0,0,0};\n\
(*lsm={(lm[[1]]-lp[[1]])/2,lp[[2]],110};csm={0,0.5,1};\n\
lep={lp[[1]],20,lp[[3]]};\nles={lsm[[1]],lep[[2]],80};\ndpm={0,dpm[[1]]};*)\n\
\nlp={70,35,90};np={2,np[[1]]};cp={1,0,1};chp={9,chp[[1]],10};\n\
lm={180,per/2-lp[[2]],130};nm={2,nm[[1]]};cm={0,1,1};chm={10,chp[[1]],10};\n\n\
(*lp={70,per/2-lm[[2]],90};np={2,2};cp={1,0,1};\n\
lm={120,75,130};nm={2,2};cm={0,1,1};*)\n\n\
(*lp={70,(per*35/2)/110,90};np={2,2};cp={1,0,1};\n\
lm={120,per/2-lp[[2]],130};nm={2,2};cm={0,1,1};*)\n\nF[]:=Module[{},\n",
 StyleBox["radUtiDelAll",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nmm=",
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 "[1.2];\nmp=",
 StyleBox["RadMatAFK502",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nund=wig[];\nre=",
 StyleBox["RadSolve",
  FontColor->RGBColor[1, 0, 0]],
 "[und,0.0003,1000];\nN[",
 StyleBox["radFld",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"Bz\",{0,0,0}],4]\n]\n\nt=Table[{y,(lp[[1]]=y;F[])},{y,10,120,5}];\n\
(*t=Table[{y,(lm[[3]]=y;F[])},{y,50,200,5}];*)\n\
(*t=Table[{y,(per=y;F[])},{y,100,300,20}];*)\n\
(*t=Table[{y,(NumPer=y;F[])},{y,1,5,1}];*)\n\
(*t=Table[{y,(np[[1]]=y;F[])},{y,1,5,1}];*)\n\
(*t=Table[{y,(nm[[1]]=y;F[])},{y,1,5,1}];*)\n\
(*t=Table[{y,(nm[[1]]=y;F[])},{y,1,5,1}];*)\n\
(*t=Table[{y,(chp[[1]]=y;F[])},{y,1,15,1}];*)\n\
Export[FileNameJoin[{NotebookDirectory[],\"maxField_lpx_p\"<>ToString[NumPer*\
2+1]<>\"_n\"<>ToString[np[[1]]]<>\"_g\"<>ToString[gap]<>\"_lmx180.dat\"}],t];\
\nListPlot[t,Joined->True,AxesLabel->{\"NumPer\",\"Peak Field\"}]"
}], "Input",
 CellChangeTimes->{
  3.3999128077182503`*^9, {3.670086569076912*^9, 3.670086570090914*^9}, {
   3.84975796422351*^9, 3.84975796422351*^9}, {3.849758010170967*^9, 
   3.8497580288346553`*^9}, {3.849758096482314*^9, 3.849758096812314*^9}, 
   3.8497581697324505`*^9, {3.8513943592481747`*^9, 3.8513943656779213`*^9}, {
   3.853541546650813*^9, 3.8535415615281825`*^9}, 3.853554333787671*^9, {
   3.853554381902648*^9, 3.8535544156988864`*^9}, {3.8535544756855755`*^9, 
   3.8535545585589266`*^9}, {3.853554749653496*^9, 3.8535547581246333`*^9}, 
   3.8535547975090322`*^9, 3.8535551124473968`*^9, {3.8535552254208317`*^9, 
   3.8535552272888126`*^9}, 3.8535553157323246`*^9, 3.853555345960641*^9, {
   3.8535554326998577`*^9, 3.853555514611102*^9}, {3.8535631852586374`*^9, 
   3.8535631852586374`*^9}, 3.8538233792183914`*^9, {3.854343746160897*^9, 
   3.854343791978351*^9}, {3.854343857213177*^9, 3.8543438714992175`*^9}, {
   3.8543439061641912`*^9, 3.8543439139044003`*^9}, {3.8543439921354294`*^9, 
   3.8543440603325996`*^9}, {3.8543441948287973`*^9, 
   3.8543441977801557`*^9}, {3.854344341109933*^9, 3.854344341109933*^9}, {
   3.8543445474296603`*^9, 3.8543445628416753`*^9}, {3.8543446235584564`*^9, 
   3.8543446235584564`*^9}, 3.8543446569369297`*^9, {3.854344691534068*^9, 
   3.854344726828185*^9}, {3.854344759968051*^9, 3.8543447600965953`*^9}, {
   3.8543447999825697`*^9, 3.8543448129310217`*^9}, 3.854344851731723*^9, {
   3.854344896994212*^9, 3.854344913400282*^9}, {3.8543449533477054`*^9, 
   3.8543449875863295`*^9}, 3.854345214877819*^9, {3.854345433433157*^9, 
   3.8543454434597874`*^9}, {3.854347324579743*^9, 3.854347325121939*^9}, {
   3.8544293852504077`*^9, 3.854429392109395*^9}, {3.854429504572999*^9, 
   3.854429599785128*^9}, {3.8544296368291364`*^9, 3.8544296429240866`*^9}, {
   3.854429694796728*^9, 3.854429694796728*^9}, {3.8544297776203284`*^9, 
   3.854429789892683*^9}, {3.854429820088727*^9, 3.8544298387653513`*^9}, {
   3.8544304080983906`*^9, 3.8544304178784103`*^9}, {3.854430578303263*^9, 
   3.8544306150216155`*^9}, {3.8544306776557875`*^9, 
   3.8544307179310627`*^9}, {3.854430792744999*^9, 3.854430793081359*^9}, {
   3.85443083244681*^9, 3.854430832866598*^9}, {3.854485306324357*^9, 
   3.8544853077643547`*^9}, 3.854485387361941*^9, {3.854485461703277*^9, 
   3.8544854617975674`*^9}, {3.85448567082574*^9, 3.8544856709657526`*^9}, {
   3.8544857277533813`*^9, 3.8544857277533813`*^9}, {3.854485770728446*^9, 
   3.854485770729447*^9}, {3.8544858047098675`*^9, 3.8544858122855444`*^9}, {
   3.854485902317337*^9, 3.8544859380113344`*^9}, {3.8544859823055067`*^9, 
   3.854485988490259*^9}, {3.854486037975329*^9, 3.8544860719230094`*^9}, {
   3.8544861364674296`*^9, 3.8544861812528334`*^9}, 3.8544862738527355`*^9, {
   3.8544864542285767`*^9, 3.854486457464572*^9}, {3.854486662600819*^9, 
   3.8544866717048206`*^9}, {3.854486747041586*^9, 3.854486796982286*^9}, {
   3.854486828158271*^9, 3.8544868519355187`*^9}, {3.8544882124290485`*^9, 
   3.8544882246767454`*^9}, {3.85448830421719*^9, 3.8544883629473605`*^9}, {
   3.854488412273262*^9, 3.8544884489548244`*^9}, {3.854490462214801*^9, 
   3.8544904915727396`*^9}, {3.8544906270884557`*^9, 
   3.8544906617683773`*^9}, {3.854490709198308*^9, 3.854490711910303*^9}, {
   3.8544907483922567`*^9, 3.854490832706109*^9}, {3.854490892276417*^9, 
   3.8544909247100286`*^9}, 3.8544909754108086`*^9, {3.854760260869015*^9, 
   3.85476028127238*^9}, {3.854762052472717*^9, 3.854762053983793*^9}, {
   3.854762089957183*^9, 3.8547620940771713`*^9}, {3.854762272645768*^9, 
   3.8547622741057644`*^9}, 3.8547624255275445`*^9, {3.8556150050713716`*^9, 
   3.85561507531079*^9}, {3.855615231590989*^9, 3.8556153091768985`*^9}, {
   3.8556153592805223`*^9, 3.85561535928452*^9}, {3.855615390111263*^9, 
   3.8556154074365845`*^9}, {3.855615494797606*^9, 3.8556155046786003`*^9}, {
   3.8556155803893304`*^9, 3.855615598516057*^9}, {3.8556157433051915`*^9, 
   3.855615756208087*^9}, {3.855617573192146*^9, 3.8556176124761143`*^9}, {
   3.8556182842193274`*^9, 3.8556182844993415`*^9}, {3.855618369937791*^9, 
   3.8556184066523657`*^9}, {3.8556238158587685`*^9, 
   3.8556238486857967`*^9}, {3.8556239765830727`*^9, 3.855623976820963*^9}, {
   3.855625393266676*^9, 3.8556254073914433`*^9}, {3.8557007604869967`*^9, 
   3.855700815124436*^9}, {3.8558081031433687`*^9, 3.8558081209713583`*^9}, {
   3.87290469376735*^9, 3.872904713879056*^9}, {3.872904797619011*^9, 
   3.872904845047599*^9}, {3.8729049322650795`*^9, 3.8729049551839046`*^9}, {
   3.8729050285489645`*^9, 3.8729050887224216`*^9}, {3.872906678828231*^9, 
   3.8729066878220015`*^9}, {3.872906902877486*^9, 3.872907034954172*^9}, {
   3.8729070795163507`*^9, 3.872907232149472*^9}, {3.8738385971622024`*^9, 
   3.8738386389748955`*^9}, 3.8745484930565534`*^9, 3.8752364975238595`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"9279ef9f-baea-4903-b5a1-eb035aebc7f2"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Field integral upon gap, distance to ending units or end side magnet height\
\>", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.8538212453166027`*^9, 3.853821274373686*^9}, {
  3.8543461346002536`*^9, 3.8543461405326567`*^9}, {3.8543464724552937`*^9, 
  3.8543464866451597`*^9}, {3.8544286203074727`*^9, 3.8544286368511343`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"86fab811-3e67-43b6-889c-dabd0fb90927"],

Cell[TextData[{
 StyleBox["In this section, some iterations are made on solving and computing \
the peak field of the wiggler as a function of the horizontal width of the \
pole. The segmentation in the pole and magnet has been set to",
  Evaluatable->False,
  AspectRatioFixed->True],
 " {1,1,1} resulting in a quick but inaccurate computation."
}], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8513936674668603`*^9, 3.851393674752615*^9}, {
  3.8535565255182357`*^9, 3.8535565333221936`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"31fe8877-035f-437e-95c3-29f142885a28"],

Cell[TextData[{
 "gap=15;NumPer=2;per=220;gapoffset=0;ending=1;zer={0,0,0};sp={0,0,0};\n\
les={lsm[[1]],lep[[2]],80};\ndpm={0,dpm[[1]]};\n\nF[]:=Module[{},\n",
 StyleBox["radUtiDelAll",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nmm=",
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 "[1.29];\nmp=",
 StyleBox["RadMatAFK502",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nund=wig[];\nre=",
 StyleBox["RadSolve",
  FontColor->RGBColor[1, 0, 0]],
 "[und,0.0003,1000];\nN[",
 StyleBox["radFldInt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"inf\",\"ibz\",{0,-2000,0},{0,2000,0}],3]\n]\n\n\
t=Table[{y,(gap=y;F[])},{y,5,100,5}];\n\
(*t=Table[{y,(dpm[[1]]=y;F[])},{y,0,20,1}];*)\n\
(*t=Table[{y,(les[[3]]=y;F[])},{y,60,90,1}];*)\n\
Export[FileNameJoin[{NotebookDirectory[],\"fldint_p\"<>ToString[NumPer*2+1]<>\
\"_n\"<>ToString[np[[1]]]<>\"_gap.dat\"}],t];\n\
ListPlot[t,Joined->True,AxesLabel->{\"lesz\",\"fldint\"}]"
}], "Input",
 CellChangeTimes->{
  3.3999128077182503`*^9, {3.670086569076912*^9, 3.670086570090914*^9}, {
   3.84975796422351*^9, 3.84975796422351*^9}, {3.849758010170967*^9, 
   3.8497580288346553`*^9}, {3.849758096482314*^9, 3.849758096812314*^9}, 
   3.8497581697324505`*^9, {3.8513943592481747`*^9, 3.8513943656779213`*^9}, {
   3.853541546650813*^9, 3.8535415615281825`*^9}, 3.853554333787671*^9, {
   3.853554381902648*^9, 3.8535544156988864`*^9}, {3.8535544756855755`*^9, 
   3.8535545585589266`*^9}, {3.853554749653496*^9, 3.8535547581246333`*^9}, 
   3.8535547975090322`*^9, 3.8535551124473968`*^9, {3.8535552254208317`*^9, 
   3.8535552272888126`*^9}, 3.8535553157323246`*^9, 3.853555345960641*^9, {
   3.8535554326998577`*^9, 3.853555514611102*^9}, {3.8535631852586374`*^9, 
   3.8535631852586374`*^9}, {3.853820946709757*^9, 3.853820992352663*^9}, {
   3.8538210292635975`*^9, 3.8538212276462193`*^9}, {3.8538216637963285`*^9, 
   3.853821666890695*^9}, 3.8538218313777018`*^9, {3.8538232976423197`*^9, 
   3.85382329810847*^9}, {3.8538233533517017`*^9, 3.8538233545211697`*^9}, {
   3.8538237173941116`*^9, 3.853823761539635*^9}, {3.8538240342069263`*^9, 
   3.853824091753352*^9}, {3.8538241448056087`*^9, 3.8538241590681543`*^9}, {
   3.85382420145013*^9, 3.853824202015748*^9}, {3.8538888483406324`*^9, 
   3.853888848478819*^9}, {3.854346160389157*^9, 3.854346187154301*^9}, {
   3.8543462549338913`*^9, 3.8543462638154173`*^9}, {3.8543463138876066`*^9, 
   3.8543464028979945`*^9}, {3.8543464381715064`*^9, 
   3.8543464678866777`*^9}, {3.8543470348465805`*^9, 3.854347066860038*^9}, {
   3.854347119135144*^9, 3.8543471201762667`*^9}, {3.854347193381149*^9, 
   3.8543471955584908`*^9}, {3.8543473366444464`*^9, 
   3.8543473506880245`*^9}, {3.8543474482180796`*^9, 3.8543474592167273`*^9}, 
   3.854347505657852*^9, {3.8543475518530116`*^9, 3.8543475532967196`*^9}, {
   3.8544286773810825`*^9, 3.854428893735918*^9}, {3.85442892412844*^9, 
   3.854429008746972*^9}, {3.8544291119482393`*^9, 3.854429188040766*^9}, {
   3.8544294088394475`*^9, 3.8544294099040003`*^9}, {3.8544300074940295`*^9, 
   3.8544300134461827`*^9}, {3.8544302831384735`*^9, 
   3.8544303305425987`*^9}, {3.8544303701891837`*^9, 3.854430397015108*^9}, 
   3.8544304819554763`*^9, {3.854430534358094*^9, 3.8544305462678037`*^9}, {
   3.854430846161438*^9, 3.85443085704523*^9}, {3.8544868914664583`*^9, 
   3.8544868914664583`*^9}, {3.8544869216864653`*^9, 3.85448692648246*^9}, {
   3.854487016340131*^9, 3.854487037868116*^9}, {3.8544870878680935`*^9, 
   3.8544871296060658`*^9}, {3.854487219350472*^9, 3.854487219642736*^9}, {
   3.85448738813402*^9, 3.8544873988639293`*^9}, {3.8544882171249332`*^9, 
   3.8544882878889604`*^9}, {3.8544886056503916`*^9, 3.854488605988163*^9}, {
   3.854490291263158*^9, 3.8544902912671695`*^9}, {3.854490326975089*^9, 
   3.854490337491234*^9}, {3.85562546232686*^9, 3.8556254678469653`*^9}, {
   3.855699415984618*^9, 3.855699438489831*^9}, {3.8558081369772787`*^9, 
   3.8558081509932923`*^9}, {3.8752365719491477`*^9, 3.8752365795427213`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"7c577dcf-29f6-4104-b3de-12c260e1ee51"],

Cell[TextData[{
 "(* Plot field integral in x axis upon gap, lpx, lesz *)\n\
gap=15;NumPer=2;per=220;gapoffset=0;ending=1;zer={0,0,0};sp={0,0,0};\n\
lp={70,35,90};np={2,2};cp={1,0,1};\n\
lm={120,per/2-lp[[2]],130};nm={2,2};cm={0,1,1};\nles={lsm[[1]],lep[[2]],80};\n\
dpm={0,dpm[[1]]};\n\nF[]:=Module[{},\n",
 StyleBox["radUtiDelAll",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nmm=",
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 "[1.29];\nmp=",
 StyleBox["RadMatAFK502",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nund=wig[];\nre=",
 StyleBox["RadSolve",
  FontColor->RGBColor[1, 0, 0]],
 "[und,0.0003,1000];\nN[",
 StyleBox["radFldInt",
  FontColor->RGBColor[1, 0, 0]],
 "[und,\"inf\",\"ibz\",{x,-2000,0},{x,2000,0}],3]\n]\n\n\
t=Table[{y,(x=y;F[])},{y,-20,20,2}];\n\
Export[FileNameJoin[{NotebookDirectory[],\"fldint_x_lesz80_gap\"<>ToString[\
gap]<>\".dat\"}],t];\n\
ListPlot[t,Joined->True,AxesLabel->{\"lesz\",\"fldint\"}]"
}], "Input",
 CellChangeTimes->{
  3.3999128077182503`*^9, {3.670086569076912*^9, 3.670086570090914*^9}, {
   3.84975796422351*^9, 3.84975796422351*^9}, {3.849758010170967*^9, 
   3.8497580288346553`*^9}, {3.849758096482314*^9, 3.849758096812314*^9}, 
   3.8497581697324505`*^9, {3.8513943592481747`*^9, 3.8513943656779213`*^9}, {
   3.853541546650813*^9, 3.8535415615281825`*^9}, 3.853554333787671*^9, {
   3.853554381902648*^9, 3.8535544156988864`*^9}, {3.8535544756855755`*^9, 
   3.8535545585589266`*^9}, {3.853554749653496*^9, 3.8535547581246333`*^9}, 
   3.8535547975090322`*^9, 3.8535551124473968`*^9, {3.8535552254208317`*^9, 
   3.8535552272888126`*^9}, 3.8535553157323246`*^9, 3.853555345960641*^9, {
   3.8535554326998577`*^9, 3.853555514611102*^9}, {3.8535631852586374`*^9, 
   3.8535631852586374`*^9}, {3.853820946709757*^9, 3.853820992352663*^9}, {
   3.8538210292635975`*^9, 3.8538212276462193`*^9}, {3.8538216637963285`*^9, 
   3.853821666890695*^9}, 3.8538218313777018`*^9, {3.8538232976423197`*^9, 
   3.85382329810847*^9}, {3.8538233533517017`*^9, 3.8538233545211697`*^9}, {
   3.8538237173941116`*^9, 3.853823761539635*^9}, {3.8538240342069263`*^9, 
   3.853824091753352*^9}, {3.8538241448056087`*^9, 3.8538241590681543`*^9}, {
   3.85382420145013*^9, 3.853824202015748*^9}, {3.8538888483406324`*^9, 
   3.853888848478819*^9}, {3.854346160389157*^9, 3.854346187154301*^9}, {
   3.8543462549338913`*^9, 3.8543462638154173`*^9}, {3.8543463138876066`*^9, 
   3.8543464028979945`*^9}, {3.8543464381715064`*^9, 
   3.8543464678866777`*^9}, {3.8543470348465805`*^9, 3.854347066860038*^9}, {
   3.854347119135144*^9, 3.8543471201762667`*^9}, {3.854347193381149*^9, 
   3.8543471955584908`*^9}, {3.8543473366444464`*^9, 
   3.8543473506880245`*^9}, {3.8543474482180796`*^9, 3.8543474592167273`*^9}, 
   3.854347505657852*^9, {3.8543475518530116`*^9, 3.8543475532967196`*^9}, {
   3.8544286773810825`*^9, 3.854428893735918*^9}, {3.85442892412844*^9, 
   3.854429008746972*^9}, {3.8544291119482393`*^9, 3.854429188040766*^9}, {
   3.8544294088394475`*^9, 3.8544294099040003`*^9}, {3.8544300074940295`*^9, 
   3.8544300134461827`*^9}, {3.8544302831384735`*^9, 
   3.8544303305425987`*^9}, {3.8544303701891837`*^9, 3.854430397015108*^9}, 
   3.8544304819554763`*^9, {3.854430534358094*^9, 3.8544305462678037`*^9}, {
   3.854430846161438*^9, 3.85443085704523*^9}, {3.8544868914664583`*^9, 
   3.8544868914664583`*^9}, {3.8544869216864653`*^9, 3.85448692648246*^9}, {
   3.854487016340131*^9, 3.854487037868116*^9}, {3.8544870878680935`*^9, 
   3.8544871296060658`*^9}, {3.854487219350472*^9, 3.854487219642736*^9}, {
   3.85448738813402*^9, 3.8544873988639293`*^9}, {3.8544882171249332`*^9, 
   3.8544882878889604`*^9}, {3.8544886056503916`*^9, 3.854488605988163*^9}, {
   3.854490291263158*^9, 3.8544902912671695`*^9}, {3.854490326975089*^9, 
   3.854490337491234*^9}, {3.85562546232686*^9, 3.8556254678469653`*^9}, {
   3.85563255979209*^9, 3.8556326486889505`*^9}, {3.8556327035304103`*^9, 
   3.855632706890368*^9}, {3.8556327499561634`*^9, 3.8556329007407417`*^9}, {
   3.8556342940461283`*^9, 3.8556345783075795`*^9}, {3.8556346331231422`*^9, 
   3.855634652514516*^9}, {3.8556346854643583`*^9, 3.855634916098587*^9}, {
   3.875236594808142*^9, 3.875236600192322*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"b55ebfdd-804e-4c31-9d32-d62728080c52"]
}, Closed]],

Cell[CellGroupData[{

Cell["Magnetic force upon gap", "Section",
 Evaluatable->False,
 CellChangeTimes->{{3.8538212453166027`*^9, 3.853821274373686*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"f6c6205a-4abc-4639-8baf-7f06c1cc5fe9"],

Cell[TextData[{
 StyleBox["In this section, some iterations are made on solving and computing \
the peak field of the wiggler as a function of the horizontal width of the \
pole. The segmentation in the pole and magnet has been set to",
  Evaluatable->False,
  AspectRatioFixed->True],
 " {1,1,1} resulting in a quick but inaccurate computation."
}], "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.8513936674668603`*^9, 3.851393674752615*^9}, {
  3.8535565255182357`*^9, 3.8535565333221936`*^9}},
 AspectRatioFixed->
  True,ExpressionUUID->"fe642e10-e03e-4330-b4e7-e37838182556"],

Cell[TextData[{
 "gap=20;NumPer=2;per=220;gapoffset=0;\nlp={70,35,90};np={2,2};cp={1,0,1};\n\
lm={120,per/2-lp[[2]],130};nm={2,2};cm={0,1,1};\n\nF[]:=Module[{},\n",
 StyleBox["radUtiDelAll",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nmm=",
 StyleBox["RadMatNdFeB",
  FontColor->RGBColor[1, 0, 0]],
 "[1.29];\nmp=",
 StyleBox["RadMatAFK502",
  FontColor->RGBColor[1, 0, 0]],
 "[];\nund=wig[];\nre=",
 StyleBox["RadSolve",
  FontColor->RGBColor[1, 0, 0]],
 "[und,0.0003,1000];\nN[",
 StyleBox["radFldEnrFrc",
  FontColor->RGBColor[1, 0, 0]],
 "[pole,und,\"\",{1,1,4}][[3]],3]\n]\n\nt=Table[{y,(gap=y;F[])},{y,5,200,5}];\
\nExport[FileNameJoin[{NotebookDirectory[],\"force_gap.dat\"}],t];\n\
ListPlot[t,Joined->True,AxesLabel->{\"Gap\",\"Force\"}]\n\n\
(*t=Table[{y,(NumPer=y;F[])},{y,1,5,1}];\n\
Export[FileNameJoin[{NotebookDirectory[],\"force_pole_odd.dat\"}],t];\n\
ListPlot[t,Joined->True,AxesLabel->{\"Pole\",\"Force\"}]*)"
}], "Input",
 CellChangeTimes->{
  3.3999128077182503`*^9, {3.670086569076912*^9, 3.670086570090914*^9}, {
   3.84975796422351*^9, 3.84975796422351*^9}, {3.849758010170967*^9, 
   3.8497580288346553`*^9}, {3.849758096482314*^9, 3.849758096812314*^9}, 
   3.8497581697324505`*^9, {3.8513943592481747`*^9, 3.8513943656779213`*^9}, {
   3.853541546650813*^9, 3.8535415615281825`*^9}, 3.853554333787671*^9, {
   3.853554381902648*^9, 3.8535544156988864`*^9}, {3.8535544756855755`*^9, 
   3.8535545585589266`*^9}, {3.853554749653496*^9, 3.8535547581246333`*^9}, 
   3.8535547975090322`*^9, 3.8535551124473968`*^9, {3.8535552254208317`*^9, 
   3.8535552272888126`*^9}, 3.8535553157323246`*^9, 3.853555345960641*^9, {
   3.8535554326998577`*^9, 3.853555514611102*^9}, {3.8535631852586374`*^9, 
   3.8535631852586374`*^9}, {3.853820946709757*^9, 3.853820992352663*^9}, {
   3.8538210292635975`*^9, 3.8538212276462193`*^9}, {3.8538216637963285`*^9, 
   3.853821666890695*^9}, 3.8538218313777018`*^9, {3.8538232976423197`*^9, 
   3.85382329810847*^9}, {3.8538233533517017`*^9, 3.8538233545211697`*^9}, {
   3.8538237173941116`*^9, 3.853823761539635*^9}, {3.8538240342069263`*^9, 
   3.853824091753352*^9}, {3.8538241448056087`*^9, 3.8538241590681543`*^9}, {
   3.85382420145013*^9, 3.853824202015748*^9}, {3.8538888483406324`*^9, 
   3.853888848478819*^9}, {3.85434741628821*^9, 3.8543474179116735`*^9}, {
   3.8544885474948807`*^9, 3.854488547638878*^9}, {3.8556139694926414`*^9, 
   3.8556139859248996`*^9}, {3.8556141110789113`*^9, 3.855614148334099*^9}, {
   3.8556147237558565`*^9, 3.8556147246937966`*^9}, {3.855614810108515*^9, 
   3.855614810494492*^9}, {3.8556149010349216`*^9, 3.8556149010349216`*^9}, {
   3.872909863022334*^9, 3.8729098631643353`*^9}},
 AspectRatioFixed->True,
 CellLabel->
  "In[1502]:=",ExpressionUUID->"6fdeb01d-bf8b-43e4-ab50-17585b125c3a"]
}, Closed]],

Cell[CellGroupData[{

Cell["How to Get Help", "Section",
 Evaluatable->False,
 CellChangeTimes->{3.8545092456532536`*^9},
 AspectRatioFixed->
  True,ExpressionUUID->"7fe160c3-17a9-4432-abc7-23d9121950e5"],

Cell[TextData[StyleBox["The following command lists all the functions defined \
in the Radia.exe  file.",
 Evaluatable->False,
 AspectRatioFixed->True]], "Text",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"742ac2b3-d67f-4920-b35d-4703457ac75c"],

Cell["?rad*", "Input",
 AspectRatioFixed->True,
 CellLabel->
  "In[112]:=",ExpressionUUID->"4d7b3697-ab5f-45d8-84ba-8880dfcc4657"],

Cell[TextData[StyleBox["The following command gives the template and the \
description of the function  \"radObjArcCur\".",
 Evaluatable->False,
 AspectRatioFixed->True]], "Text",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"f05d35ce-682b-401a-9b5e-b5bc7ed6b5c4"],

Cell[TextData[{
 "?",
 StyleBox["RadPlot3DOptions",
  FontColor->RGBColor[1, 0, 0]]
}], "Input",
 CellChangeTimes->{3.8495756290006084`*^9, 3.849575828548298*^9},
 AspectRatioFixed->True,
 CellLabel->
  "In[127]:=",ExpressionUUID->"1459a613-b464-440b-86d3-1b2f0448148b"],

Cell[TextData[{
 StyleBox["The following command lists all the functions defined in the \
Init.m file. These functions are fully written in ",
  Evaluatable->False,
  AspectRatioFixed->True],
 StyleBox["Mathematica",
  Evaluatable->False,
  AspectRatioFixed->True,
  FontSlant->"Italic"],
 StyleBox[" code ",
  Evaluatable->False,
  AspectRatioFixed->True]
}], "Text",
 Evaluatable->False,
 AspectRatioFixed->
  True,ExpressionUUID->"284281e6-6e4f-4ae1-9e97-69b9d9742e53"],

Cell["?Rad*", "Input",
 AspectRatioFixed->True,
 CellLabel->
  "In[125]:=",ExpressionUUID->"05136f8d-7cda-4537-9b50-de11ac86b179"],

Cell[TextData[{
 "The following command gives the full mathematica definition of the function \
\"RadMatAFK502\" as defined in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 ". "
}], "Text",ExpressionUUID->"24c81614-623f-4844-81ed-bc4048b37110"],

Cell[BoxData[
 RowBox[{"??", 
  StyleBox[
   ButtonBox["RadMatXc06",
    BaseStyle->"InformationLink",
    ButtonData:>{"Info3670072199-3171275", {"RadMatXc06", "Global`"}},
    ButtonNote->"Global`"],
   FontColor->RGBColor[1, 0, 0]]}]], "Input",
 CellChangeTimes->{
  3.8495758510074816`*^9, 3.8495759120888677`*^9, {3.8495760884780216`*^9, 
   3.849576104682849*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"f8fc8852-812b-4696-aca0-0afef93de670"]
}, Closed]]
},
PrintingStyleEnvironment->"Working",
WindowToolbars->"EditBar",
CellGrouping->Manual,
WindowSize->{1068., 599.25},
WindowMargins->{{-1145.25, Automatic}, {Automatic, 6}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PageHeaders->{{
   Cell[
    TextData[{
      CounterBox["Page"]}], "PageNumber"], Inherited, 
   Cell[
    TextData[{
      ValueBox["FileName"]}], "Header"]}, {
   Cell[
    TextData[{
      ValueBox["FileName"]}], "Header"], Inherited, 
   Cell[
    TextData[{
      CounterBox["Page"]}], "PageNumber"]}},
PrintingOptions->{"FacingPages"->True,
"FirstPageHeader"->False,
"PrintCellBrackets"->False,
"PrintMultipleHorizontalPages"->False,
"PrintRegistrationMarks"->False,
"PrintingMargins"->{{54, 54}, {72, 72}}},
ShowSelection->True,
TaggingRules-><|"TryRealOnly" -> False|>,
ShowCellLabel->False,
ShowCellTags->False,
Magnification->1,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Classroom.nb",
ExpressionUUID->"55bb2c64-5e59-4d9b-9431-f29df8b29385"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 282, 8, 55, "Title",ExpressionUUID->"80f95f21-688f-466a-be74-1c788a5280bc",
 Evaluatable->False],
Cell[830, 30, 201, 4, 24, "Text",ExpressionUUID->"2cf92360-50b0-457e-9c90-a3c2cc5e2c8a",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[1056, 38, 135, 3, 54, "Section",ExpressionUUID->"61178415-e883-4c84-ac7e-e8b13f3d9ce8",
 Evaluatable->False],
Cell[1194, 43, 2927, 55, 230, "Text",ExpressionUUID->"717b5375-299b-4a73-b1c4-5b4c657d9166",
 Evaluatable->False]
}, Closed]],
Cell[CellGroupData[{
Cell[4158, 103, 148, 3, 34, "Section",ExpressionUUID->"dcd0e42c-1b7c-44b2-ace2-3d9a57a69efb",
 Evaluatable->False],
Cell[4309, 108, 275, 6, 24, "Text",ExpressionUUID->"55364a9b-41af-4208-be09-cf8c70609193",
 Evaluatable->False],
Cell[4587, 116, 429, 12, 82, "Input",ExpressionUUID->"0a81d872-9815-47a6-a8ca-b399b670058c"]
}, Closed]],
Cell[CellGroupData[{
Cell[5053, 133, 218, 4, 34, "Section",ExpressionUUID->"252e519d-81eb-497c-88b0-81b5bad93f75",
 Evaluatable->False],
Cell[5274, 139, 852, 21, 58, "Text",ExpressionUUID->"e6a5c227-0ba1-40b6-9f43-47dbab68bcd6",
 Evaluatable->False],
Cell[6129, 162, 1222, 21, 320, "Input",ExpressionUUID->"dc1242ef-4d98-4bd0-ab04-28bea0ccd1bc"]
}, Closed]],
Cell[CellGroupData[{
Cell[7388, 188, 757, 22, 34, "Section",ExpressionUUID->"6448deeb-d2ba-43c7-8b1b-7a7791494f61",
 Evaluatable->False],
Cell[8148, 212, 574, 10, 41, "Text",ExpressionUUID->"e745422a-8ea8-4e90-9e99-c52555fec598",
 Evaluatable->False],
Cell[8725, 224, 23802, 430, 2547, "Input",ExpressionUUID->"55d175db-2e2d-4acd-b57c-348bc9f05e56"]
}, Closed]],
Cell[CellGroupData[{
Cell[32564, 659, 607, 20, 34, "Section",ExpressionUUID->"299921ee-134d-47aa-b8be-840f476c3a44",
 Evaluatable->False],
Cell[33174, 681, 574, 10, 41, "Text",ExpressionUUID->"4e552465-4ec0-4637-a637-47ed123e34e8",
 Evaluatable->False],
Cell[33751, 693, 22605, 402, 2207, "Input",ExpressionUUID->"c55f66be-e2ff-4d35-b2a5-2eb6f91ef814"]
}, Closed]],
Cell[CellGroupData[{
Cell[56393, 1100, 236, 5, 34, "Section",ExpressionUUID->"41b9a76f-0607-4676-9b4f-a188723677db",
 Evaluatable->False],
Cell[56632, 1107, 990, 30, 41, "Text",ExpressionUUID->"5e0d4460-f976-471c-bfde-5c529251cdb7",
 Evaluatable->False],
Cell[57625, 1139, 13280, 195, 728, "Input",ExpressionUUID->"f9610f9d-2237-404b-bdbc-ee8eeedef1ac"]
}, Closed]],
Cell[CellGroupData[{
Cell[70942, 1339, 206, 4, 34, "Section",ExpressionUUID->"6a40f96f-68cb-45d3-903a-0cca6a81d7d5",
 Evaluatable->False],
Cell[71151, 1345, 246, 6, 24, "Text",ExpressionUUID->"5e3354bb-12e3-478d-8e39-b51d423c832d",
 Evaluatable->False],
Cell[71400, 1353, 2615, 45, 167, "Input",ExpressionUUID->"c7896b99-1018-444a-acab-41eef79736aa"]
}, Closed]],
Cell[CellGroupData[{
Cell[74052, 1403, 128, 3, 34, "Section",ExpressionUUID->"f2047b13-2bc0-4c07-9f29-d3a1640badca",
 Evaluatable->False],
Cell[74183, 1408, 303, 7, 24, "Text",ExpressionUUID->"74e90033-9ad3-4443-87b6-7ba9132b1854",
 Evaluatable->False],
Cell[74489, 1417, 1250, 26, 235, "Input",ExpressionUUID->"177175c9-89ec-406b-9603-c0cf26effe5b"]
}, Closed]],
Cell[CellGroupData[{
Cell[75776, 1448, 190, 4, 34, "Section",ExpressionUUID->"13a563cc-9ccb-4a8d-94c4-8905ca7468b5",
 Evaluatable->False],
Cell[75969, 1454, 2102, 36, 184, "Input",ExpressionUUID->"c23c1001-0828-48db-935f-f2cd6a792019"],
Cell[78074, 1492, 1488, 27, 167, "Input",ExpressionUUID->"e9f58193-654c-4f92-8a2c-0c0bd8095936"]
}, Closed]],
Cell[CellGroupData[{
Cell[79599, 1524, 153, 3, 34, "Section",ExpressionUUID->"e828e54d-83b4-4eec-9b65-9a304282b9bf",
 Evaluatable->False],
Cell[79755, 1529, 358, 7, 24, "Text",ExpressionUUID->"f141ba92-ffae-45d5-8d00-15d26515a7ef",
 Evaluatable->False],
Cell[80116, 1538, 1718, 34, 252, "Input",ExpressionUUID->"9113889a-20af-485c-be53-acb2e2734784"]
}, Closed]],
Cell[CellGroupData[{
Cell[81871, 1577, 243, 5, 34, "Section",ExpressionUUID->"e04a0304-5016-4e5e-8082-9f5a6046bd21",
 Evaluatable->False],
Cell[82117, 1584, 5645, 82, 303, "Input",ExpressionUUID->"87010605-74fc-48a9-915f-936cc44eff69"]
}, Closed]],
Cell[CellGroupData[{
Cell[87799, 1671, 213, 4, 34, "Section",ExpressionUUID->"a2a1ed25-3eb1-4bb4-a51c-16e39b7cdbb1",
 Evaluatable->False],
Cell[88015, 1677, 3488, 53, 150, "Input",ExpressionUUID->"2148320c-9341-4d90-84da-6b03cbbe43c4"]
}, Closed]],
Cell[CellGroupData[{
Cell[91540, 1735, 273, 5, 34, "Section",ExpressionUUID->"9f4fbd33-34e8-4c18-a846-4d6c516cc774",
 Evaluatable->False],
Cell[91816, 1742, 312, 7, 24, "Text",ExpressionUUID->"547c101f-275c-4514-9faf-65051eb7d800",
 Evaluatable->False],
Cell[92131, 1751, 6776, 153, 292, "Input",ExpressionUUID->"38b94814-3bb7-4c90-8e7f-ddbabc2517b2"]
}, Closed]],
Cell[CellGroupData[{
Cell[98944, 1909, 138, 3, 34, "Section",ExpressionUUID->"d15fabc2-96b4-4a55-b25d-8819783997ee",
 Evaluatable->False],
Cell[99085, 1914, 891, 20, 41, "Text",ExpressionUUID->"b91a60b9-8c56-4759-a8a7-0709b316b6a3",
 Evaluatable->False],
Cell[99979, 1936, 1698, 42, 134, "Input",ExpressionUUID->"49ef75ca-1487-4a29-b498-91c185383a97"]
}, Closed]],
Cell[CellGroupData[{
Cell[101714, 1983, 240, 4, 34, "Section",ExpressionUUID->"da6efea5-2765-4b3e-99fc-4997ed78ea2f",
 Evaluatable->False],
Cell[101957, 1989, 583, 12, 41, "Text",ExpressionUUID->"a3592047-feec-4b42-88ad-40a01e8a5b1a",
 Evaluatable->False],
Cell[102543, 2003, 6544, 103, 609, "Input",ExpressionUUID->"9279ef9f-baea-4903-b5a1-eb035aebc7f2"]
}, Closed]],
Cell[CellGroupData[{
Cell[109124, 2111, 430, 8, 34, "Section",ExpressionUUID->"86fab811-3e67-43b6-889c-dabd0fb90927",
 Evaluatable->False],
Cell[109557, 2121, 583, 12, 41, "Text",ExpressionUUID->"31fe8877-035f-437e-95c3-29f142885a28",
 Evaluatable->False],
Cell[110143, 2135, 4075, 68, 337, "Input",ExpressionUUID->"7c577dcf-29f6-4104-b3de-12c260e1ee51"],
Cell[114221, 2205, 4299, 72, 354, "Input",ExpressionUUID->"b55ebfdd-804e-4c31-9d32-d62728080c52"]
}, Closed]],
Cell[CellGroupData[{
Cell[118557, 2282, 214, 4, 34, "Section",ExpressionUUID->"f6c6205a-4abc-4639-8baf-7f06c1cc5fe9",
 Evaluatable->False],
Cell[118774, 2288, 583, 12, 41, "Text",ExpressionUUID->"fe642e10-e03e-4330-b4e7-e37838182556",
 Evaluatable->False],
Cell[119360, 2302, 2787, 50, 371, "Input",ExpressionUUID->"6fdeb01d-bf8b-43e4-ab50-17585b125c3a"]
}, Closed]],
Cell[CellGroupData[{
Cell[122184, 2357, 182, 4, 34, "Section",ExpressionUUID->"7fe160c3-17a9-4432-abc7-23d9121950e5",
 Evaluatable->False],
Cell[122369, 2363, 265, 6, 24, "Text",ExpressionUUID->"742ac2b3-d67f-4920-b35d-4703457ac75c",
 Evaluatable->False],
Cell[122637, 2371, 130, 3, 48, "Input",ExpressionUUID->"4d7b3697-ab5f-45d8-84ba-8880dfcc4657"],
Cell[122770, 2376, 283, 6, 24, "Text",ExpressionUUID->"f05d35ce-682b-401a-9b5e-b5bc7ed6b5c4",
 Evaluatable->False],
Cell[123056, 2384, 270, 8, 48, "Input",ExpressionUUID->"1459a613-b464-440b-86d3-1b2f0448148b"],
Cell[123329, 2394, 472, 15, 24, "Text",ExpressionUUID->"284281e6-6e4f-4ae1-9e97-69b9d9742e53",
 Evaluatable->False],
Cell[123804, 2411, 130, 3, 48, "Input",ExpressionUUID->"05136f8d-7cda-4537-9b50-de11ac86b179"],
Cell[123937, 2416, 251, 6, 23, "Text",ExpressionUUID->"24c81614-623f-4844-81ed-bc4048b37110"],
Cell[124191, 2424, 453, 12, 50, "Input",ExpressionUUID->"f8fc8852-812b-4696-aca0-0afef93de670"]
}, Closed]]
}
]
*)

